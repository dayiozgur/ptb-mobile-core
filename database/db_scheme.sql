-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.activities (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL DEFAULT nextval('activity_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   date timestamp with time zone,
                                   note character varying,
                                   customer uuid,
                                   deal uuid,
                                   staff uuid,
                                   tenant_id uuid,
                                   CONSTRAINT activities_pkey PRIMARY KEY (id),
                                   CONSTRAINT fkennv09bbl8dnwgo4vfcbr4pa1 FOREIGN KEY (deal) REFERENCES public.deals(id),
                                   CONSTRAINT fkl2g5aobdu0knx0cefntiyx2uk FOREIGN KEY (staff) REFERENCES public.staffs(id),
                                   CONSTRAINT fkt2w8l59xb9arkajm8q7pop9nb FOREIGN KEY (customer) REFERENCES public.customers(id),
                                   CONSTRAINT activities_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.ai_knowledge_bases (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           category character varying NOT NULL,
                                           question text NOT NULL,
                                           answer text NOT NULL,
                                           keywords ARRAY,
                                           priority integer DEFAULT 1,
                                           is_active boolean DEFAULT true,
                                           created_at timestamp with time zone DEFAULT now(),
                                           updated_at timestamp with time zone DEFAULT now(),
                                           CONSTRAINT ai_knowledge_bases_pkey PRIMARY KEY (id)
);
CREATE TABLE public.alarm_analytics_sessions (
                                                 id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                 session_name character varying NOT NULL,
                                                 analysis_type character varying NOT NULL,
                                                 status character varying DEFAULT 'pending'::character varying,
                                                 start_time timestamp with time zone DEFAULT now(),
                                                 end_time timestamp with time zone,
                                                 data_range_start timestamp with time zone,
                                                 data_range_end timestamp with time zone,
                                                 total_records_analyzed integer,
                                                 python_service_version character varying,
                                                 model_parameters jsonb,
                                                 results_summary jsonb,
                                                 created_by uuid,
                                                 created_at timestamp with time zone DEFAULT now(),
                                                 tenant_id uuid,
                                                 CONSTRAINT alarm_analytics_sessions_pkey PRIMARY KEY (id),
                                                 CONSTRAINT alarm_analytics_sessions_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.alarm_anomalies (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        session_id uuid,
                                        alarm_history_id uuid,
                                        anomaly_type character varying NOT NULL,
                                        anomaly_score double precision,
                                        deviation_magnitude double precision,
                                        is_critical boolean DEFAULT false,
                                        description text,
                                        root_cause_analysis jsonb,
                                        recommended_actions ARRAY,
                                        ml_confidence double precision,
                                        detected_at timestamp with time zone DEFAULT now(),
                                        CONSTRAINT alarm_anomalies_pkey PRIMARY KEY (id),
                                        CONSTRAINT alarm_anomalies_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.alarm_analytics_sessions(id),
                                        CONSTRAINT alarm_anomalies_alarm_history_id_fkey FOREIGN KEY (alarm_history_id) REFERENCES public.alarm_histories(id)
);
CREATE TABLE public.alarm_correlations (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           session_id uuid,
                                           primary_variable_id uuid,
                                           secondary_variable_id uuid,
                                           correlation_type character varying,
                                           correlation_strength double precision,
                                           lag_minutes integer,
                                           confidence_level double precision,
                                           sample_size integer,
                                           statistical_significance double precision,
                                           business_impact_score double precision,
                                           discovered_at timestamp with time zone DEFAULT now(),
                                           CONSTRAINT alarm_correlations_pkey PRIMARY KEY (id),
                                           CONSTRAINT alarm_correlations_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.alarm_analytics_sessions(id)
);
CREATE TABLE public.alarm_histories (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('alarm_history_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        alarm_operation_method_to_actions text,
                                        archive_group character varying,
                                        arrival_end_time timestamp with time zone,
                                        arrival_start_time timestamp with time zone,
                                        category integer,
                                        code character varying,
                                        delete_action_time timestamp with time zone,
                                        delete_action_user character varying,
                                        description character varying,
                                        end_time timestamp with time zone,
                                        inhibit_time timestamp with time zone,
                                        inhibited boolean,
                                        is_archive boolean,
                                        is_logic boolean,
                                        last_update timestamp with time zone,
                                        local_acknowledge_time timestamp with time zone,
                                        local_acknowledge_user character varying,
                                        name character varying,
                                        remote_acknowledge_time timestamp with time zone,
                                        remote_acknowledge_user character varying,
                                        reset_time timestamp with time zone,
                                        reset_user character varying,
                                        start_time timestamp with time zone,
                                        txn_group_id character varying,
                                        canceled_controller_id uuid,
                                        organization_id uuid,
                                        controller_id uuid,
                                        contractor_id uuid,
                                        tenant_id uuid,
                                        provider_id uuid,
                                        realtime_id uuid,
                                        site_id uuid,
                                        txn_id uuid,
                                        variable_id uuid,
                                        priority_id uuid,
                                        CONSTRAINT alarm_histories_pkey PRIMARY KEY (id),
                                        CONSTRAINT fka02kqqqyb3omseey9kiyyus6j FOREIGN KEY (canceled_controller_id) REFERENCES public.controllers(id),
                                        CONSTRAINT fkdrsfmvp5eqr6d38l5pvvq59f7 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                        CONSTRAINT fkmqo0plyx4vla71jcutyl1ah9s FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                                        CONSTRAINT fkgd4e0bilsc96l8yo9i22e1bqu FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                        CONSTRAINT fk5x9gddnywdk3ksewy7abqpu9o FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                        CONSTRAINT fkfrfuiy5mcpoj0311ak7269eip FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                                        CONSTRAINT fknajgmvbh6r0g29oi7q2rrlk0c FOREIGN KEY (realtime_id) REFERENCES public.realtimes(id),
                                        CONSTRAINT fkrnlvby4c9txbyqpjlfo5nt5i6 FOREIGN KEY (site_id) REFERENCES public.sites(id),
                                        CONSTRAINT fk8adlopp8q87uggu42lo11hobt FOREIGN KEY (txn_id) REFERENCES public.txns(id),
                                        CONSTRAINT fk8n1ic9d3nd2n6mgucdgkhep02 FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                                        CONSTRAINT fkrxu5j33im564klue1wmiwmnk3 FOREIGN KEY (priority_id) REFERENCES public.priorities(id)
);
CREATE TABLE public.alarm_operation_actions (
                                                id uuid NOT NULL,
                                                active boolean,
                                                created_by uuid,
                                                created_at timestamp with time zone,
                                                row_id integer NOT NULL DEFAULT nextval('alarm_operation_action_row_id_seq'::regclass),
                                                updated_by uuid,
                                                updated_at timestamp with time zone,
                                                process_time timestamp with time zone,
                                                alarm_id uuid,
                                                operation_action_id uuid,
                                                CONSTRAINT alarm_operation_actions_pkey PRIMARY KEY (id),
                                                CONSTRAINT fk3ekf41o3rp98t34cgasc2v3xb FOREIGN KEY (operation_action_id) REFERENCES public.operation_actions(id),
                                                CONSTRAINT fkcxvkb5h2srwis0drmlth1miq7 FOREIGN KEY (alarm_id) REFERENCES public.alarms(id)
);
CREATE TABLE public.alarm_patterns (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       session_id uuid,
                                       pattern_type character varying NOT NULL,
                                       pattern_name character varying,
                                       pattern_description text,
                                       confidence_score double precision,
                                       frequency_score double precision,
                                       severity_impact character varying,
                                       affected_controllers ARRAY,
                                       affected_variables ARRAY,
                                       time_window jsonb,
                                       statistical_data jsonb,
                                       ml_features jsonb,
                                       created_at timestamp with time zone DEFAULT now(),
                                       CONSTRAINT alarm_patterns_pkey PRIMARY KEY (id),
                                       CONSTRAINT alarm_patterns_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.alarm_analytics_sessions(id)
);
CREATE TABLE public.alarm_predictions (
                                          id uuid NOT NULL DEFAULT gen_random_uuid(),
                                          session_id uuid,
                                          controller_id uuid,
                                          variable_id uuid,
                                          predicted_alarm_time timestamp with time zone,
                                          prediction_confidence double precision,
                                          prediction_type character varying,
                                          risk_level character varying,
                                          predicted_duration_hours double precision,
                                          prevention_window_hours double precision,
                                          maintenance_recommendation jsonb,
                                          model_version character varying,
                                          feature_importance jsonb,
                                          created_at timestamp with time zone DEFAULT now(),
                                          CONSTRAINT alarm_predictions_pkey PRIMARY KEY (id),
                                          CONSTRAINT alarm_predictions_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.alarm_analytics_sessions(id)
);
CREATE TABLE public.alarm_statistics (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         date_key date NOT NULL,
                                         hour_key integer,
                                         controller_id uuid,
                                         variable_id uuid,
                                         total_alarms integer DEFAULT 0,
                                         avg_duration_minutes double precision,
                                         min_duration_minutes double precision,
                                         max_duration_minutes double precision,
                                         unique_alarm_types integer,
                                         critical_alarms integer DEFAULT 0,
                                         resolved_alarms integer DEFAULT 0,
                                         mttr_minutes double precision,
                                         mtbf_hours double precision,
                                         performance_score double precision,
                                         calculated_at timestamp with time zone DEFAULT now(),
                                         tenant_id uuid,
                                         CONSTRAINT alarm_statistics_pkey PRIMARY KEY (id),
                                         CONSTRAINT alarm_statistics_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.alarms (
                               id uuid NOT NULL,
                               active boolean,
                               created_by uuid,
                               created_at timestamp with time zone,
                               row_id integer NOT NULL DEFAULT nextval('alarm_row_id_seq'::regclass),
                               updated_by uuid,
                               updated_at timestamp with time zone,
                               arrival_endtime timestamp with time zone,
                               arrival_start_time timestamp with time zone,
                               category integer,
                               code character varying,
                               description character varying,
                               end_time timestamp with time zone,
                               inhibit_time timestamp with time zone,
                               inhibited boolean,
                               is_logic boolean,
                               last_update timestamp with time zone,
                               local_acknowledge_time timestamp with time zone,
                               local_acknowledge_user character varying,
                               local_delete_time timestamp with time zone,
                               local_delete_user character varying,
                               name character varying,
                               remote_acknowledge_time timestamp with time zone,
                               remote_acknowledge_user uuid,
                               reset_time timestamp with time zone,
                               reset_user character varying,
                               start_time timestamp with time zone,
                               status character varying,
                               controller_id uuid,
                               priority_id uuid,
                               realtime_id uuid UNIQUE,
                               txn_id uuid,
                               variable_id uuid,
                               organization_id uuid,
                               site_id uuid,
                               tenant_id uuid,
                               contractor_id uuid,
                               provider_id uuid,
                               canceled_controller_id uuid,
                               CONSTRAINT alarms_pkey PRIMARY KEY (id),
                               CONSTRAINT fk5yajwi1dotiov0qmkqbikinah FOREIGN KEY (priority_id) REFERENCES public.priorities(id),
                               CONSTRAINT fk7f4nop2h2lhke1r6ahn2a3g5l FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                               CONSTRAINT fkdqmjyqbisqia8arghwf42sm5g FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                               CONSTRAINT fkif6ab2lutds1b0ot234q9taft FOREIGN KEY (realtime_id) REFERENCES public.realtimes(id),
                               CONSTRAINT fkiw6611eycdi0yebh3hgmi8c06 FOREIGN KEY (txn_id) REFERENCES public.txns(id)
);
CREATE TABLE public.areas (
                              id uuid NOT NULL,
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('area_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              code character varying,
                              color character varying,
                              description character varying,
                              image_path character varying,
                              address character varying,
                              city character varying,
                              country character varying,
                              latitude double precision,
                              longitude double precision,
                              town character varying,
                              zoom integer,
                              name character varying,
                              contractor_id uuid,
                              tenant_id uuid,
                              CONSTRAINT areas_pkey PRIMARY KEY (id),
                              CONSTRAINT fkm3jy4pd56nkti94uag7loqtcw FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                              CONSTRAINT areas_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.attachments (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    filename character varying NOT NULL,
                                    original_filename character varying NOT NULL,
                                    file_size bigint NOT NULL,
                                    mime_type character varying NOT NULL,
                                    file_path text NOT NULL,
                                    work_request_id uuid,
                                    comment_id uuid,
                                    created_at timestamp with time zone DEFAULT now(),
                                    created_by uuid,
                                    tenant_id uuid,
                                    CONSTRAINT attachments_pkey PRIMARY KEY (id),
                                    CONSTRAINT attachment_work_request_id_fkey FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
                                    CONSTRAINT attachment_comment_id_fkey FOREIGN KEY (comment_id) REFERENCES public.comments(id),
                                    CONSTRAINT attachments_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.audit_logs (
                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                   tenant_id uuid,
                                   user_id uuid,
                                   entity_type character varying NOT NULL,
                                   entity_id uuid NOT NULL,
                                   action character varying NOT NULL CHECK (action::text = ANY (ARRAY['create'::character varying, 'read'::character varying, 'update'::character varying, 'delete'::character varying, 'login'::character varying, 'logout'::character varying, 'export'::character varying, 'import'::character varying, 'enable'::character varying, 'disable'::character varying]::text[])),
  old_values jsonb,
  new_values jsonb,
  ip_address inet,
  user_agent text,
  request_id character varying,
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT audit_logs_pkey PRIMARY KEY (id),
  CONSTRAINT audit_logs_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT audit_logs_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT audit_logs_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.blueprints (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL,
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   barcode character varying,
                                   code character varying,
                                   description character varying,
                                   name character varying,
                                   row_number integer,
                                   tenant_id uuid,
                                   brand_id uuid,
                                   catalog_id uuid,
                                   location_id uuid UNIQUE,
                                   unit_id uuid UNIQUE,
                                   vendor_id uuid,
                                   CONSTRAINT blueprints_pkey PRIMARY KEY (id),
                                   CONSTRAINT blueprint_ptb_clone_catalog_id_fkey FOREIGN KEY (catalog_id) REFERENCES public.catalogs(id),
                                   CONSTRAINT blueprint_ptb_clone_brand_id_fkey FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                   CONSTRAINT blueprint_ptb_clone_vendor_id_fkey FOREIGN KEY (vendor_id) REFERENCES public.vendors(id),
                                   CONSTRAINT blueprint_ptb_clone_location_id_fkey FOREIGN KEY (location_id) REFERENCES public.locations(id),
                                   CONSTRAINT blueprint_ptb_clone_unit_id_fkey FOREIGN KEY (unit_id) REFERENCES public.units(id),
                                   CONSTRAINT blueprint_ptb_clone_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.boss_event_codes (
                                         id uuid NOT NULL,
                                         bunch character varying,
                                         code character varying,
                                         description character varying,
                                         sub_code character varying,
                                         language_id uuid,
                                         CONSTRAINT boss_event_codes_pkey PRIMARY KEY (id),
                                         CONSTRAINT fkbs30v791ut432qlkmr02tvwsv FOREIGN KEY (language_id) REFERENCES public.languages(id)
);
CREATE TABLE public.boss_events (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('boss_event_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    category_code character varying,
                                    date timestamp with time zone,
                                    description character varying,
                                    event_id integer,
                                    message_code character varying,
                                    parameters text,
                                    type character varying CHECK (type::text = ANY (ARRAY['ERROR'::character varying, 'WARNING'::character varying, 'INFO'::character varying, 'SUCCESS'::character varying]::text[])),
  user_event character varying,
  provider_id uuid,
  txn_id uuid,
  tenant_id uuid,
  CONSTRAINT boss_events_pkey PRIMARY KEY (id),
  CONSTRAINT fkng0409nn2twqasrl2fcm7d647 FOREIGN KEY (provider_id) REFERENCES public.providers(id),
  CONSTRAINT fk3wjllngj8t3n0n4ooimg6of6s FOREIGN KEY (txn_id) REFERENCES public.txns(id),
  CONSTRAINT boss_events_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.brands (
                               id uuid NOT NULL,
                               active boolean,
                               created_by uuid,
                               created_at timestamp with time zone,
                               row_id integer NOT NULL DEFAULT nextval('brand_row_id_seq'::regclass),
                               updated_by uuid,
                               updated_at timestamp with time zone,
                               code character varying,
                               description character varying,
                               name character varying,
                               image_path character varying,
                               CONSTRAINT brands_pkey PRIMARY KEY (id)
);
CREATE TABLE public.business_flow_maps (
                                           id uuid NOT NULL,
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('business_flow_map_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           business_interaction_id uuid,
                                           next_flow_id uuid,
                                           previous_flow_id uuid,
                                           CONSTRAINT business_flow_maps_pkey PRIMARY KEY (id),
                                           CONSTRAINT fk46rye35eo0fepq44520n2uwyw FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id),
                                           CONSTRAINT fk4eb0omvmtrkri1enarj1q69ws FOREIGN KEY (previous_flow_id) REFERENCES public.business_flows(id),
                                           CONSTRAINT fk6b8wr6mmyk55cla7uwcjajaxy FOREIGN KEY (next_flow_id) REFERENCES public.business_flows(id)
);
CREATE TABLE public.business_flows (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('business_flow_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       code character varying,
                                       description character varying,
                                       is_next_async boolean,
                                       name character varying,
                                       business_interaction_id uuid,
                                       CONSTRAINT business_flows_pkey PRIMARY KEY (id),
                                       CONSTRAINT fk9m5g8t8n9j81fwif5naorlhs7 FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id)
);
CREATE TABLE public.business_interactions (
                                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                                              active boolean,
                                              created_by uuid,
                                              created_at timestamp with time zone,
                                              row_id integer NOT NULL DEFAULT nextval('business_interaction_row_id_seq'::regclass),
                                              updated_by uuid,
                                              updated_at timestamp with time zone,
                                              code character varying,
                                              description character varying,
                                              input_type character varying CHECK (input_type::text = ANY (ARRAY['BOOLEAN'::character varying::text, 'TEXT'::character varying::text, 'JSON'::character varying::text, 'NONE'::character varying::text])),
  name character varying,
  output_type character varying CHECK (output_type::text = ANY (ARRAY['BOOLEAN'::character varying::text, 'TEXT'::character varying::text, 'JSON'::character varying::text, 'NONE'::character varying::text])),
  sector_id uuid,
  tenant_id uuid,
  CONSTRAINT business_interactions_pkey PRIMARY KEY (id),
  CONSTRAINT fkbywd58lelxmfrm8il37jjg1jg FOREIGN KEY (sector_id) REFERENCES public.sectors(id),
  CONSTRAINT fktg42krjfrp8oeh4o9roa38xg6 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.business_step_maps (
                                           id uuid NOT NULL,
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('business_step_map_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           first_step_id uuid,
                                           next_step_id uuid,
                                           CONSTRAINT business_step_maps_pkey PRIMARY KEY (id),
                                           CONSTRAINT fk30yffv9e8uf2lfr14gi6f4td FOREIGN KEY (first_step_id) REFERENCES public.business_steps(id),
                                           CONSTRAINT fkejprqqg4osmmy0drj7c4m0yra FOREIGN KEY (next_step_id) REFERENCES public.business_steps(id)
);
CREATE TABLE public.business_step_types (
                                            id uuid NOT NULL,
                                            active boolean,
                                            created_by uuid,
                                            created_at timestamp with time zone,
                                            row_id integer NOT NULL DEFAULT nextval('business_step_type_row_id_seq'::regclass),
                                            updated_by uuid,
                                            updated_at timestamp with time zone,
                                            code character varying,
                                            description character varying,
                                            name character varying,
                                            absolute_path character varying,
                                            input_type character varying CHECK (input_type::text = ANY (ARRAY['BOOLEAN'::character varying::text, 'TEXT'::character varying::text, 'JSON'::character varying::text, 'NONE'::character varying::text])),
  output_type character varying CHECK (output_type::text = ANY (ARRAY['BOOLEAN'::character varying::text, 'TEXT'::character varying::text, 'JSON'::character varying::text, 'NONE'::character varying::text])),
  CONSTRAINT business_step_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.business_steps (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('business_step_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       button_name character varying,
                                       code character varying,
                                       description character varying,
                                       is_next_async boolean,
                                       name character varying,
                                       business_flow_id uuid,
                                       business_step_type_id uuid,
                                       CONSTRAINT business_steps_pkey PRIMARY KEY (id),
                                       CONSTRAINT fk8cl4j3h020ykklg6urlsrbr3 FOREIGN KEY (business_flow_id) REFERENCES public.business_flows(id),
                                       CONSTRAINT fkonf973samx7qcn6tg9tqlxm10 FOREIGN KEY (business_step_type_id) REFERENCES public.business_step_types(id)
);
CREATE TABLE public.calendar_event_audit_logs (
                                                  id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                  event_id uuid NOT NULL,
                                                  operation character varying NOT NULL CHECK (operation::text = ANY (ARRAY['INSERT'::character varying, 'UPDATE'::character varying, 'DELETE'::character varying]::text[])),
  old_data jsonb,
  new_data jsonb,
  changed_fields ARRAY,
  tenant_id uuid NOT NULL,
  changed_by character varying NOT NULL,
  changed_at timestamp with time zone DEFAULT now(),
  ip_address inet,
  user_agent text,
  CONSTRAINT calendar_event_audit_logs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.calendar_events (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        title character varying NOT NULL,
                                        description text,
                                        location character varying,
                                        event_type character varying NOT NULL CHECK (event_type::text = ANY (ARRAY['MEETING'::character varying, 'REMINDER'::character varying, 'DEADLINE'::character varying, 'PERSONAL'::character varying, 'OTHER'::character varying]::text[])),
  start_time timestamp with time zone NOT NULL,
  end_time timestamp with time zone NOT NULL,
  all_day boolean DEFAULT false,
  is_recurring boolean DEFAULT false,
  recurrence_pattern jsonb,
  parent_event_id uuid,
  recurrence_exception_dates ARRAY,
  tenant_id uuid NOT NULL,
  created_by uuid NOT NULL,
  linked_todo_id uuid,
  status character varying DEFAULT 'SCHEDULED'::character varying CHECK (status::text = ANY (ARRAY['SCHEDULED'::character varying, 'COMPLETED'::character varying, 'CANCELLED'::character varying]::text[])),
  active boolean DEFAULT true,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  updated_by uuid,
  row_id integer NOT NULL DEFAULT nextval('calendar_event_row_id_seq'::regclass),
  CONSTRAINT calendar_events_pkey PRIMARY KEY (id),
  CONSTRAINT calendar_event_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT calendar_event_parent_fkey FOREIGN KEY (parent_event_id) REFERENCES public.calendar_events(id),
  CONSTRAINT calendar_event_linked_todo_fkey FOREIGN KEY (linked_todo_id) REFERENCES public.todo_items(id)
);
CREATE TABLE public.cancelled_controllers (
                                              id uuid NOT NULL,
                                              active boolean,
                                              created_by uuid,
                                              created_at timestamp with time zone,
                                              row_id integer NOT NULL DEFAULT nextval('cancelled_controller_row_id_seq'::regclass),
                                              updated_by uuid,
                                              updated_at timestamp with time zone,
                                              background_path character varying,
                                              cfaddress integer,
                                              cfcode character varying,
                                              cfdescription character varying,
                                              code character varying,
                                              ftp_client_password character varying,
                                              ftp_client_username character varying,
                                              ftp_password character varying,
                                              ftp_username character varying,
                                              http_password character varying,
                                              http_username character varying,
                                              description character varying,
                                              global_index integer,
                                              has_alarm boolean,
                                              id_group integer,
                                              image_path character varying,
                                              insert_time timestamp with time zone,
                                              ip character varying,
                                              ip_code character varying,
                                              is_enabled boolean,
                                              is_logic boolean,
                                              last_update_time timestamp with time zone,
                                              life_test boolean,
                                              line character varying,
                                              line_address character varying,
                                              little_endian boolean,
                                              address character varying,
                                              city character varying,
                                              country character varying,
                                              latitude double precision,
                                              longitude double precision,
                                              town character varying,
                                              zoom integer,
                                              mac character varying,
                                              model_code character varying,
                                              name character varying,
                                              peripheral character varying,
                                              proxy_prefix character varying,
                                              serial character varying,
                                              area_id uuid,
                                              brand_id uuid NOT NULL,
                                              contractor_id uuid,
                                              device_model_id uuid NOT NULL,
                                              ftpuser_id uuid,
                                              language_id uuid,
                                              marker_id uuid,
                                              device_id uuid,
                                              protocoltype_id uuid,
                                              provider_id uuid,
                                              site_id uuid NOT NULL,
                                              supervisor_type_id uuid,
                                              tenant_id uuid,
                                              CONSTRAINT cancelled_controllers_pkey PRIMARY KEY (id),
                                              CONSTRAINT fk2tq8qrl0e0pveyragox8wivg5 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                              CONSTRAINT fk49xu83njalrtileetski1vqj8 FOREIGN KEY (area_id) REFERENCES public.areas(id),
                                              CONSTRAINT fk4s2uff2jb1cbmo8117o6rrsh5 FOREIGN KEY (marker_id) REFERENCES public.markers(id),
                                              CONSTRAINT fk60f76b14dktqj2jkc5ki56fap FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                                              CONSTRAINT fk64dffn1r0goq2dsc0habhy2rr FOREIGN KEY (protocoltype_id) REFERENCES public.protocol_types(id),
                                              CONSTRAINT fkaw5uqot1k0mwanneplm12g8hr FOREIGN KEY (site_id) REFERENCES public.sites(id),
                                              CONSTRAINT fkd3nk6kckrtxmie1r05aqk59iv FOREIGN KEY (device_id) REFERENCES public.devices(id),
                                              CONSTRAINT fkhd7kf2dexxrooe8xw6md80369 FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                              CONSTRAINT fkjmn4miutq3v0vxvc6c3du37mi FOREIGN KEY (language_id) REFERENCES public.languages(id),
                                              CONSTRAINT fklgdnuoycqxe81clj899mrsxe0 FOREIGN KEY (supervisor_type_id) REFERENCES public.supervisor_types(id),
                                              CONSTRAINT fkn289f2xcni1f6gdshxxu0fpdb FOREIGN KEY (ftpuser_id) REFERENCES public.ftp_users(id),
                                              CONSTRAINT fks40sc9g5tqh8dhueqgvr6wmc2 FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                                              CONSTRAINT cancelled_controllers_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.carbon_emissions (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('carbon_emissions_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         source_type character varying NOT NULL CHECK (source_type::text = ANY (ARRAY['ELECTRICITY'::character varying, 'NATURAL_GAS'::character varying, 'HEATING_OIL'::character varying, 'DIESEL'::character varying, 'GASOLINE'::character varying, 'BIOMASS'::character varying, 'COAL'::character varying, 'PROPANE'::character varying, 'REFRIGERATION'::character varying, 'TRANSPORTATION'::character varying, 'WASTE'::character varying, 'WATER'::character varying]::text[])),
  timestamp timestamp with time zone NOT NULL,
  value double precision NOT NULL,
  tenant_id uuid DEFAULT gen_random_uuid(),
  emission_factor_id uuid DEFAULT gen_random_uuid(),
  energy_consumption_id uuid DEFAULT gen_random_uuid(),
  fixed_asset_id uuid NOT NULL DEFAULT gen_random_uuid(),
  CONSTRAINT carbon_emissions_pkey PRIMARY KEY (id),
  CONSTRAINT fkj2fc27502ga6301vn72eehy1u FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fklpbc02612bmrm631up6f8fcpa FOREIGN KEY (emission_factor_id) REFERENCES public.emission_factors(id),
  CONSTRAINT fkjx0eab4csr0ibnw9kxu8snqeb FOREIGN KEY (energy_consumption_id) REFERENCES public.energy_consumptions(id),
  CONSTRAINT fkp6c72218o2seyuui5k93cb9yl FOREIGN KEY (fixed_asset_id) REFERENCES public.items(id)
);
CREATE TABLE public.catalogs (
                                 id uuid NOT NULL,
                                 active boolean,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('catalog_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 code character varying,
                                 description character varying,
                                 name character varying,
                                 tenant_id uuid,
                                 CONSTRAINT catalogs_pkey PRIMARY KEY (id),
                                 CONSTRAINT fk2bxca6tr0kcfi3sfv3eyxdw46 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.categories (
                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                   category_type character varying NOT NULL,
                                   code character varying NOT NULL,
                                   name character varying NOT NULL,
                                   description text,
                                   parent_category_id uuid,
                                   hierarchy_level integer DEFAULT 1,
                                   metadata jsonb DEFAULT '{}'::jsonb,
                                   display_order integer DEFAULT 0,
                                   is_system boolean DEFAULT false,
                                   is_customizable boolean DEFAULT true,
                                   tenant_id uuid,
                                   active boolean DEFAULT true,
                                   created_at timestamp with time zone DEFAULT now(),
                                   updated_at timestamp with time zone DEFAULT now(),
                                   created_by uuid,
                                   updated_by uuid,
                                   row_id integer NOT NULL DEFAULT nextval('categories_row_id_seq'::regclass),
                                   CONSTRAINT categories_pkey PRIMARY KEY (id),
                                   CONSTRAINT categories_parent_category_id_fkey FOREIGN KEY (parent_category_id) REFERENCES public.categories(id),
                                   CONSTRAINT categories_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.characteristic_values (
                                              id uuid NOT NULL,
                                              active boolean,
                                              created_by uuid,
                                              created_at timestamp with time zone,
                                              row_id integer NOT NULL DEFAULT nextval('characteristic_value_row_id_seq'::regclass),
                                              updated_by uuid,
                                              updated_at timestamp with time zone,
                                              entity_id uuid,
                                              entity_type character varying CHECK (entity_type::text = ANY (ARRAY['INVOICE'::character varying::text, 'PRODUCTION'::character varying::text, 'PRODUCT'::character varying::text, 'BLUEPRINT'::character varying::text, 'PRODUCTION_ORDER'::character varying::text])),
  value character varying,
  tenant_id uuid,
  characteristic_id uuid,
  CONSTRAINT characteristic_values_pkey PRIMARY KEY (id),
  CONSTRAINT fkawifrnrmw1ms5bxiqskltb6iq FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
  CONSTRAINT fkgv8s8pay8k4xvn4qcwlf1mxdn FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.characteristics (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('characteristic_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        check_digit character varying,
                                        code character varying,
                                        default_value character varying,
                                        description character varying,
                                        fixed_length boolean,
                                        format character varying,
                                        list_category character varying,
                                        name character varying,
                                        qualifiers character varying,
                                        regex character varying,
                                        row_number integer,
                                        shortcode character varying,
                                        value_group character varying,
                                        value_type character varying CHECK (value_type::text = ANY (ARRAY['STRING'::character varying::text, 'INTEGER'::character varying::text, 'DOUBLE'::character varying::text, 'BOOLEAN'::character varying::text, 'DATE'::character varying::text, 'TIME'::character varying::text, 'DATETIME'::character varying::text, 'ENUM'::character varying::text, 'ENTITY'::character varying::text, 'LIST'::character varying::text, 'LINK'::character varying::text])),
  tenant_id uuid,
  CONSTRAINT characteristics_pkey PRIMARY KEY (id),
  CONSTRAINT characteristics_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.chat_analytics (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       session_id uuid,
                                       user_id character varying NOT NULL,
                                       message_count integer DEFAULT 0,
                                       session_duration integer DEFAULT 0,
                                       satisfaction_rating integer CHECK (satisfaction_rating >= 1 AND satisfaction_rating <= 5),
                                       feedback text,
                                       created_at timestamp with time zone DEFAULT now(),
                                       CONSTRAINT chat_analytics_pkey PRIMARY KEY (id),
                                       CONSTRAINT chat_analytics_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.chat_sessions(id)
);
CREATE TABLE public.chat_messages (
                                      id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      session_id uuid NOT NULL,
                                      content text NOT NULL,
                                      is_user boolean NOT NULL DEFAULT false,
                                      message_type character varying DEFAULT 'text'::character varying,
                                      metadata jsonb DEFAULT '{}'::jsonb,
                                      created_at timestamp with time zone DEFAULT now(),
                                      updated_at timestamp with time zone DEFAULT now(),
                                      CONSTRAINT chat_messages_pkey PRIMARY KEY (id),
                                      CONSTRAINT chat_messages_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.chat_sessions(id)
);
CREATE TABLE public.chat_sessions (
                                      id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      user_id character varying NOT NULL,
                                      title character varying DEFAULT 'Yeni Sohbet'::character varying,
                                      created_at timestamp with time zone DEFAULT now(),
                                      updated_at timestamp with time zone DEFAULT now(),
                                      is_active boolean DEFAULT true,
                                      metadata jsonb DEFAULT '{}'::jsonb,
                                      tenant_id uuid,
                                      CONSTRAINT chat_sessions_pkey PRIMARY KEY (id),
                                      CONSTRAINT chat_sessions_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.cities (
                               id integer NOT NULL DEFAULT nextval('cities_id_seq'::regclass),
                               name character varying NOT NULL,
                               code character varying,
                               country_code character varying DEFAULT 'TR'::character varying,
                               latitude numeric,
                               longitude numeric,
                               active boolean DEFAULT true,
                               created_at timestamp with time zone DEFAULT now(),
                               updated_at timestamp with time zone DEFAULT now(),
                               country_id character varying,
                               state_id integer,
                               CONSTRAINT cities_pkey PRIMARY KEY (id),
                               CONSTRAINT cities_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id),
                               CONSTRAINT cities_state_id_fkey FOREIGN KEY (state_id) REFERENCES public.states(id)
);
CREATE TABLE public.comments (
                                 id uuid NOT NULL DEFAULT gen_random_uuid(),
                                 content text NOT NULL,
                                 work_request_id uuid NOT NULL,
                                 parent_comment_id uuid,
                                 created_at timestamp with time zone DEFAULT now(),
                                 updated_at timestamp with time zone DEFAULT now(),
                                 created_by uuid,
                                 updated_by uuid,
                                 tenant_id uuid,
                                 CONSTRAINT comments_pkey PRIMARY KEY (id),
                                 CONSTRAINT comment_work_request_id_fkey FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
                                 CONSTRAINT comment_parent_comment_id_fkey FOREIGN KEY (parent_comment_id) REFERENCES public.comments(id),
                                 CONSTRAINT comments_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.compressor_group_controllers (
                                                     id uuid NOT NULL,
                                                     active boolean,
                                                     created_by uuid,
                                                     created_at timestamp with time zone,
                                                     row_id integer NOT NULL DEFAULT nextval('compressor_group_controller_row_id_seq'::regclass),
                                                     updated_by uuid,
                                                     updated_at timestamp with time zone,
                                                     compressor_group_id uuid,
                                                     compressor_measurement_id uuid,
                                                     controller_id uuid,
                                                     CONSTRAINT compressor_group_controllers_pkey PRIMARY KEY (id),
                                                     CONSTRAINT fkk8067hqhrbtyky0q4sa5hjtkr FOREIGN KEY (compressor_group_id) REFERENCES public.compressor_groups(id),
                                                     CONSTRAINT fklkqt8t17gngjgdjr32cptbceb FOREIGN KEY (compressor_measurement_id) REFERENCES public.compressor_measurements(id),
                                                     CONSTRAINT fkprbd9r8xiwd8r9y7y4cdynq4y FOREIGN KEY (controller_id) REFERENCES public.controllers(id)
);
CREATE TABLE public.compressor_group_templates (
                                                   id uuid NOT NULL,
                                                   active boolean,
                                                   created_by uuid,
                                                   created_at timestamp with time zone,
                                                   row_id integer NOT NULL DEFAULT nextval('compressor_group_template_row_id_seq'::regclass),
                                                   updated_by uuid,
                                                   updated_at timestamp with time zone,
                                                   compressor_group_id uuid,
                                                   compressor_template_id uuid,
                                                   CONSTRAINT compressor_group_templates_pkey PRIMARY KEY (id),
                                                   CONSTRAINT fk9vx9a2vfdqvjec7iw7owjrl9n FOREIGN KEY (compressor_group_id) REFERENCES public.compressor_groups(id),
                                                   CONSTRAINT fkgioxr73ntm9iq86p4ql0a2ibi FOREIGN KEY (compressor_template_id) REFERENCES public.compressor_templates(id)
);
CREATE TABLE public.compressor_groups (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('compressor_group_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          code character varying,
                                          description character varying,
                                          name character varying,
                                          reference_entity character varying,
                                          reference_id character varying,
                                          organization_id uuid,
                                          device_model_id uuid,
                                          provider_id uuid,
                                          CONSTRAINT compressor_groups_pkey PRIMARY KEY (id),
                                          CONSTRAINT fk9ht0w9b815epodgebxmg8kx8w FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                                          CONSTRAINT fkka47havupa4xfl5w37wy4tnor FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                                          CONSTRAINT fkqdojqouixln1g15s39hl4iih4 FOREIGN KEY (organization_id) REFERENCES public.organizations(id)
);
CREATE TABLE public.compressor_measurements (
                                                id uuid NOT NULL,
                                                active boolean,
                                                created_by uuid,
                                                created_at timestamp with time zone,
                                                row_id integer NOT NULL DEFAULT nextval('compressor_measurement_row_id_seq'::regclass),
                                                updated_by uuid,
                                                updated_at timestamp with time zone,
                                                code character varying,
                                                description character varying,
                                                name character varying,
                                                reference_entity character varying,
                                                reference_id character varying,
                                                organization_id uuid,
                                                devicemodel_id uuid,
                                                provider_id uuid,
                                                CONSTRAINT compressor_measurements_pkey PRIMARY KEY (id),
                                                CONSTRAINT fk17m91b0di9lupl69v2lw4v6h4 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                                CONSTRAINT fkig6sm3gsdxb9bj119thocdtgu FOREIGN KEY (devicemodel_id) REFERENCES public.device_models(id),
                                                CONSTRAINT fkqrfac3tf4310fc1ayubks721m FOREIGN KEY (provider_id) REFERENCES public.providers(id)
);
CREATE TABLE public.compressor_templates (
                                             id uuid NOT NULL,
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('compressor_template_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             code character varying,
                                             description character varying,
                                             frequency character varying,
                                             is_all_group boolean,
                                             name character varying,
                                             period character varying,
                                             reference_entity character varying,
                                             reference_id character varying,
                                             CONSTRAINT compressor_templates_pkey PRIMARY KEY (id)
);
CREATE TABLE public.compressor_variables (
                                             id uuid NOT NULL,
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('compressor_variable_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             code character varying,
                                             description character varying,
                                             name character varying,
                                             compressor_measurement_id uuid,
                                             variable_id uuid,
                                             CONSTRAINT compressor_variables_pkey PRIMARY KEY (id),
                                             CONSTRAINT fk8v8l5o892ceq4q3ug1fw02892 FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                                             CONSTRAINT fkhrf9uwrdl7cab5350i04vs2vd FOREIGN KEY (compressor_measurement_id) REFERENCES public.compressor_measurements(id)
);
CREATE TABLE public.confirmation_step_maps (
                                               id uuid NOT NULL,
                                               active boolean,
                                               created_by uuid,
                                               created_at timestamp with time zone,
                                               row_id integer NOT NULL DEFAULT nextval('confirmation_step_map_row_id_seq'::regclass),
                                               updated_by uuid,
                                               updated_at timestamp with time zone,
                                               first_step_id uuid,
                                               next_step_id uuid,
                                               CONSTRAINT confirmation_step_maps_pkey PRIMARY KEY (id),
                                               CONSTRAINT fkhqbbjjeaq3httyuyhejs6pwf FOREIGN KEY (first_step_id) REFERENCES public.confirmation_steps(id),
                                               CONSTRAINT fkm9f0tdcvklqqty5bybfhr6l62 FOREIGN KEY (next_step_id) REFERENCES public.confirmation_steps(id)
);
CREATE TABLE public.confirmation_steps (
                                           id uuid NOT NULL,
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('confirmation_step_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           ignore_date timestamp with time zone,
                                           reject_date timestamp with time zone,
                                           sign_date timestamp with time zone,
                                           tenant_id uuid,
                                           confirmation_id uuid,
                                           organization_id uuid,
                                           contractor_id uuid,
                                           staff_id uuid,
                                           sub_contractor_id uuid,
                                           team_id uuid,
                                           CONSTRAINT confirmation_steps_pkey PRIMARY KEY (id),
                                           CONSTRAINT fk3uvyndo91ulglj0k6mudn8vfj FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
                                           CONSTRAINT fk9thjugjo53d0il6d1mom5fyvw FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                           CONSTRAINT fkehf586juhqcct1hm9ca8m9bq6 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                           CONSTRAINT fkhugr28xaqetseslpuv4r77le6 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                           CONSTRAINT fkkdclfo2p9pyxytstxu085gpnh FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                           CONSTRAINT fkl12vv8mqf4io2s4bk0g4skscn FOREIGN KEY (confirmation_id) REFERENCES public.confirmations(id),
                                           CONSTRAINT fkrt8ii1m1l6s1oyku701umxtu7 FOREIGN KEY (staff_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.confirmation_types (
                                           id uuid NOT NULL,
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('confirmation_type_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           code character varying,
                                           description character varying,
                                           name character varying,
                                           CONSTRAINT confirmation_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.confirmations (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('confirmation_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      description character varying,
                                      done boolean,
                                      signed_at timestamp with time zone,
                                      status character varying CHECK (status::text = ANY (ARRAY['SIGNED'::character varying::text, 'NOT_SIGNED'::character varying::text, 'IN_PROGRESS'::character varying::text, 'INQUIRY'::character varying::text, 'INFORMATION'::character varying::text])),
  tenant_id uuid,
  confirmation_type_id uuid,
  payment_id uuid,
  project_work_request_id uuid,
  signed_by_staff_id uuid,
  task_work_request_id uuid,
  workflow_work_request_id uuid,
  confirmation_type uuid DEFAULT gen_random_uuid(),
  signed_by uuid DEFAULT gen_random_uuid(),
  CONSTRAINT confirmations_pkey PRIMARY KEY (id),
  CONSTRAINT fk213vfcrq7wr4b1fn9hx3t6g7i FOREIGN KEY (payment_id) REFERENCES public.payments(id),
  CONSTRAINT fk69a098ap8am0nn2yp1t9214xw FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
  CONSTRAINT fkbkh09tp3awrhgwhy4yvn22gh4 FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
  CONSTRAINT fkdrksunlo65q51own71wdot6xm FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fklhwu8w4yt7hywjy9h70c79b7w FOREIGN KEY (task_work_request_id) REFERENCES public.tasks(work_request_id),
  CONSTRAINT fkltfjgdb9588dl2047vwb6935f FOREIGN KEY (confirmation_type_id) REFERENCES public.confirmation_types(id),
  CONSTRAINT fkmqnyr9xh4o9kg79ypyuly8w3 FOREIGN KEY (signed_by_staff_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.contractor_organizations (
                                                 contractor_id uuid NOT NULL,
                                                 organizations_id uuid NOT NULL,
                                                 CONSTRAINT contractor_organizations_pkey PRIMARY KEY (contractor_id, organizations_id),
                                                 CONSTRAINT fkjl1qvsakx89fo8hdbvrinh1tu FOREIGN KEY (organizations_id) REFERENCES public.organizations(id),
                                                 CONSTRAINT fkrxvh6t29xbsk6jq9f0pw90apq FOREIGN KEY (contractor_id) REFERENCES public.contractors(id)
);
CREATE TABLE public.contractor_subcontractors (
                                                  id uuid NOT NULL,
                                                  active boolean,
                                                  created_by uuid,
                                                  created_at timestamp with time zone,
                                                  row_id integer NOT NULL DEFAULT nextval('contractor_subcontractor_row_id_seq'::regclass),
                                                  updated_by uuid,
                                                  updated_at timestamp with time zone,
                                                  contractor_id uuid,
                                                  sub_contractor_id uuid,
                                                  CONSTRAINT contractor_subcontractors_pkey PRIMARY KEY (id),
                                                  CONSTRAINT fk3j13jqtq1udgk02wwiqppp8xn FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
                                                  CONSTRAINT fkauhdypk6ogdene026oolyvqc8 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id)
);
CREATE TABLE public.contractor_teams (
                                         contractor_id uuid NOT NULL,
                                         team_id uuid NOT NULL,
                                         CONSTRAINT contractor_teams_pkey PRIMARY KEY (contractor_id, team_id),
                                         CONSTRAINT fkhhegl9sqoti7uohcmrb360u6e FOREIGN KEY (contractor_id) REFERENCES public.teams(id),
                                         CONSTRAINT fkmbc763h4emdcgaorhhlvl4rs4 FOREIGN KEY (team_id) REFERENCES public.contractors(id),
                                         CONSTRAINT fkhbq9dmkjkbm9w6q0gcatq7vf0 FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                         CONSTRAINT fksi15koy0tggmmytpqwqs31ry9 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id)
);
CREATE TABLE public.contractors (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('contractor_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    name character varying,
                                    client character varying,
                                    color character varying,
                                    email character varying NOT NULL,
                                    image_path character varying,
                                    phone character varying NOT NULL,
                                    avatar_code character varying,
                                    foundation_date character varying,
                                    financial_id uuid UNIQUE,
                                    location_id uuid UNIQUE,
                                    marker_id uuid,
                                    rating_id uuid UNIQUE,
                                    tenant_id uuid,
                                    CONSTRAINT contractors_pkey PRIMARY KEY (id),
                                    CONSTRAINT fkcmy28i73spjiiw7m4ftqwgmhc FOREIGN KEY (location_id) REFERENCES public.locations(id),
                                    CONSTRAINT fkgcv24anikj0obstm0tqnky3dw FOREIGN KEY (financial_id) REFERENCES public.financials(id),
                                    CONSTRAINT fkh1nyxe502nxq18cxgb5wdvl9h FOREIGN KEY (marker_id) REFERENCES public.markers(id),
                                    CONSTRAINT fkqckoy9k7p3osll9aid809ibye FOREIGN KEY (rating_id) REFERENCES public.ratings(id),
                                    CONSTRAINT contractors_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.controller_device_models (
                                                 id uuid NOT NULL,
                                                 active boolean,
                                                 created_by uuid,
                                                 created_at timestamp with time zone,
                                                 row_id integer NOT NULL DEFAULT nextval('controller_device_model_row_id_seq'::regclass),
                                                 updated_by uuid,
                                                 updated_at timestamp with time zone,
                                                 controller_id uuid,
                                                 device_model_id uuid,
                                                 CONSTRAINT controller_device_models_pkey PRIMARY KEY (id),
                                                 CONSTRAINT fkkut2b1gxda0uoumokkj3pf587 FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                                                 CONSTRAINT fkmfufof9vmchdvlsaeck15ych0 FOREIGN KEY (controller_id) REFERENCES public.controllers(id)
);
CREATE TABLE public.controllers (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('controller_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    background_path character varying,
                                    cf_address integer,
                                    cf_code character varying,
                                    cf_description character varying,
                                    code character varying,
                                    color character varying,
                                    ftp_client_password character varying,
                                    ftp_client_username character varying,
                                    ftp_password character varying,
                                    ftp_username character varying,
                                    http_password character varying,
                                    http_username character varying,
                                    description character varying,
                                    first_communication_time timestamp with time zone,
                                    first_connection_time timestamp with time zone,
                                    first_data_alignment_time timestamp with time zone,
                                    first_synchronization_time timestamp with time zone,
                                    global_index integer,
                                    has_alarm boolean,
                                    id_group integer,
                                    image_path character varying,
                                    insert_time timestamp with time zone,
                                    ip character varying,
                                    ip_code character varying,
                                    is_canceled boolean NOT NULL DEFAULT false,
                                    is_enabled boolean,
                                    is_logic boolean,
                                    last_communication_time timestamp with time zone,
                                    last_connection_time timestamp with time zone,
                                    last_data_alignment_time timestamp with time zone,
                                    last_synchronization_time timestamp with time zone,
                                    last_update_time timestamp with time zone,
                                    life_test boolean,
                                    line character varying,
                                    line_address character varying,
                                    little_endian boolean,
                                    address character varying,
                                    city character varying,
                                    country character varying,
                                    latitude double precision,
                                    longitude double precision,
                                    town character varying,
                                    zoom integer,
                                    mac character varying,
                                    model_code character varying,
                                    name character varying,
                                    peripheral character varying,
                                    proxy_prefix character varying,
                                    serial character varying,
                                    tenant_id uuid,
                                    area_id uuid,
                                    brand_id uuid NOT NULL,
                                    contractor_id uuid,
                                    device_id uuid,
                                    device_model_id uuid,
                                    ftp_user_id uuid,
                                    language_id uuid,
                                    marker_id uuid,
                                    protocol_type_id uuid,
                                    provider_id uuid,
                                    site_id uuid NOT NULL,
                                    supervisor_type_id uuid,
                                    unit_id uuid,
                                    device_item_id uuid,
                                    inventory_item_id uuid UNIQUE,
                                    organization_id uuid,
                                    CONSTRAINT controllers_pkey PRIMARY KEY (id),
                                    CONSTRAINT fk3dhr5xokf88n0hlt48yfal9oy FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                                    CONSTRAINT fk5m475r2ty00p484ff6ws7xr09 FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                    CONSTRAINT fk7p5ffrg2cfg7uv7sv027wtnna FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                                    CONSTRAINT fk90m7cg2iyvjf1ye2a9bdmy2ti FOREIGN KEY (device_id) REFERENCES public.devices(id),
                                    CONSTRAINT fkalkksua9wh0965f56clvm7c04 FOREIGN KEY (ftp_user_id) REFERENCES public.ftp_users(id),
                                    CONSTRAINT fkbf4jnycunxd27iu4l5m5nja3n FOREIGN KEY (language_id) REFERENCES public.languages(id),
                                    CONSTRAINT fkey09r3tqfoejbi2pd3rfbm8kp FOREIGN KEY (area_id) REFERENCES public.areas(id),
                                    CONSTRAINT fkf1ayaeny0e8hcm06dcrtsowe7 FOREIGN KEY (protocol_type_id) REFERENCES public.protocol_types(id),
                                    CONSTRAINT fkg8x9ic0fnplci3gypquy4s687 FOREIGN KEY (site_id) REFERENCES public.sites(id),
                                    CONSTRAINT fkh18fqqee0rsclowmhs4un6pcg FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                    CONSTRAINT fkq0huw7vug8cfp7ykrl0eh7naq FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                    CONSTRAINT fkqjk85y8lqf9lyytg9r3h2786j FOREIGN KEY (supervisor_type_id) REFERENCES public.supervisor_types(id),
                                    CONSTRAINT fkr9xv8mdrnn3y2houkhwnojnyd FOREIGN KEY (marker_id) REFERENCES public.markers(id),
                                    CONSTRAINT fkmvlun8yqfbg9t53m7m56rcnnm FOREIGN KEY (unit_id) REFERENCES public.units(id),
                                    CONSTRAINT fkpoffefvod4knavn3xvxy923ea FOREIGN KEY (device_item_id) REFERENCES public.items(id),
                                    CONSTRAINT fkc06wxbl6xh7akwjitugb75e5h FOREIGN KEY (inventory_item_id) REFERENCES public.inventory_items(id),
                                    CONSTRAINT controllers_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES public.organizations(id)
);
CREATE TABLE public.countries (
                                  id character varying NOT NULL,
                                  iso_code_2 character varying NOT NULL UNIQUE,
                                  iso_numeric character varying,
                                  name character varying NOT NULL,
                                  official_name character varying,
                                  capital_city character varying,
                                  continent character varying,
                                  currency_code character varying,
                                  phone_prefix character varying,
                                  timezone character varying,
                                  active boolean DEFAULT true,
                                  created_at timestamp with time zone DEFAULT now(),
                                  updated_at timestamp with time zone DEFAULT now(),
                                  CONSTRAINT countries_pkey PRIMARY KEY (id)
);
CREATE TABLE public.credit_packages (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        package_code character varying NOT NULL UNIQUE,
                                        package_name character varying NOT NULL,
                                        description text,
                                        credit_amount integer NOT NULL CHECK (credit_amount > 0),
                                        price numeric NOT NULL CHECK (price >= 0::numeric),
  currency character varying DEFAULT 'TRY'::character varying,
  bonus_credits integer DEFAULT 0 CHECK (bonus_credits >= 0),
  total_credits integer DEFAULT (credit_amount + bonus_credits),
  active boolean DEFAULT true,
  is_featured boolean DEFAULT false,
  display_order integer DEFAULT 0,
  badge_text character varying,
  badge_color character varying,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  CONSTRAINT credit_packages_pkey PRIMARY KEY (id),
  CONSTRAINT credit_packages_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT credit_packages_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.credit_quota_costs (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           quota_key character varying NOT NULL,
                                           quota_display_name character varying NOT NULL,
                                           increment_amount integer NOT NULL CHECK (increment_amount > 0),
                                           increment_unit character varying,
                                           credit_cost integer NOT NULL CHECK (credit_cost > 0),
                                           is_recommended boolean DEFAULT false,
                                           active boolean DEFAULT true,
                                           display_order integer DEFAULT 0,
                                           description text,
                                           created_at timestamp with time zone DEFAULT now(),
                                           updated_at timestamp with time zone DEFAULT now(),
                                           created_by uuid,
                                           updated_by uuid,
                                           CONSTRAINT credit_quota_costs_pkey PRIMARY KEY (id),
                                           CONSTRAINT credit_quota_costs_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                           CONSTRAINT credit_quota_costs_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.customers (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('customer_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  is_potential boolean NOT NULL,
                                  note character varying,
                                  value double precision,
                                  assigned_to_staff_id uuid,
                                  staff_organization_id uuid,
                                  person_id uuid,
                                  tenant_id uuid,
                                  CONSTRAINT customers_pkey PRIMARY KEY (id),
                                  CONSTRAINT fk8kcbpihop64qdomtnul929ox5 FOREIGN KEY (staff_organization_id) REFERENCES public.staff_organizations(id),
                                  CONSTRAINT fkcrfov9cr8ijkbif378tutmhwq FOREIGN KEY (assigned_to_staff_id) REFERENCES public.staffs(id),
                                  CONSTRAINT fkihbint30ismdy1hy7or8yx221 FOREIGN KEY (person_id) REFERENCES public.persons(id),
                                  CONSTRAINT customer_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.data_sync_logs (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       sync_date timestamp with time zone DEFAULT now(),
                                       sync_type character varying CHECK (sync_type::text = ANY (ARRAY['manual'::character varying, 'automatic'::character varying, 'scheduled'::character varying]::text[])),
  sync_status character varying CHECK (sync_status::text = ANY (ARRAY['started'::character varying, 'completed'::character varying, 'failed'::character varying, 'partial'::character varying]::text[])),
  records_processed integer DEFAULT 0,
  records_inserted integer DEFAULT 0,
  records_updated integer DEFAULT 0,
  records_failed integer DEFAULT 0,
  error_message text,
  error_details jsonb,
  started_at timestamp with time zone,
  completed_at timestamp with time zone,
  duration_seconds integer,
  retail_chain_id uuid,
  tenant_id uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT data_sync_logs_pkey PRIMARY KEY (id),
  CONSTRAINT data_sync_logs_retail_chain_id_fkey FOREIGN KEY (retail_chain_id) REFERENCES public.retail_chains(id),
  CONSTRAINT data_sync_logs_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.deals (
                              id uuid NOT NULL,
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('deal_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              name character varying,
                              note character varying,
                              type smallint CHECK (type >= 0 AND type <= 35),
                              value double precision,
                              status character varying CHECK (status::text = ANY (ARRAY['DRAFT'::character varying::text, 'PENDING'::character varying::text, 'APPROVED'::character varying::text, 'REJECTED'::character varying::text, 'CANCELLED'::character varying::text, 'COMPLETED'::character varying::text])),
  assigned_to_staff_id uuid,
  customer_id uuid,
  tenant_id uuid,
  CONSTRAINT deals_pkey PRIMARY KEY (id),
  CONSTRAINT fkkk074op6nno47iy9tmh74x6wa FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fkra4pswv5ghcfvs8o2764mye6x FOREIGN KEY (customer_id) REFERENCES public.customers(id),
  CONSTRAINT fkt5ab0gbu074swk1qcktmtaito FOREIGN KEY (assigned_to_staff_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.departments (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('department_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    name character varying,
                                    tenant_id uuid,
                                    CONSTRAINT departments_pkey PRIMARY KEY (id),
                                    CONSTRAINT departments_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.device_models (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('device_model_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      code character varying,
                                      description character varying,
                                      name character varying,
                                      image_path character varying,
                                      protocol character varying,
                                      version character varying,
                                      brand_id uuid,
                                      organization_id uuid,
                                      device_type_id uuid,
                                      language_id uuid,
                                      CONSTRAINT device_models_pkey PRIMARY KEY (id),
                                      CONSTRAINT fk11rmot76wljw54kx3c8pnpwfu FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                      CONSTRAINT fkeo3aha3gvbcxw0q0lanf47quq FOREIGN KEY (device_type_id) REFERENCES public.device_types(id),
                                      CONSTRAINT fki9q3mv41ghs3m740lw3h5q7cx FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                      CONSTRAINT fkiku4k57ctv8gu7susgu9hu03c FOREIGN KEY (language_id) REFERENCES public.languages(id)
);
CREATE TABLE public.device_properties (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('device_property_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          device_model_id uuid,
                                          kpi_report_id uuid,
                                          report_template_id uuid,
                                          CONSTRAINT device_properties_pkey PRIMARY KEY (id),
                                          CONSTRAINT fk89yrlxeiql8baus2eqwwpt1g2 FOREIGN KEY (report_template_id) REFERENCES public.report_templates(id),
                                          CONSTRAINT fk9sd8ogegajireapw0sktd7975 FOREIGN KEY (kpi_report_id) REFERENCES public.kpi_reports(id),
                                          CONSTRAINT fkknndc4r014kfyb8vjk8k25q6v FOREIGN KEY (device_model_id) REFERENCES public.device_models(id)
);
CREATE TABLE public.device_types (
                                     id uuid NOT NULL,
                                     active boolean,
                                     created_by uuid,
                                     created_at timestamp with time zone,
                                     row_id integer NOT NULL DEFAULT nextval('device_type_row_id_seq'::regclass),
                                     updated_by uuid,
                                     updated_at timestamp with time zone,
                                     code character varying,
                                     description character varying,
                                     icon character varying,
                                     image character varying,
                                     name character varying,
                                     category character varying,
                                     measurement_unit character varying,
                                     is_energy_meter boolean DEFAULT false,
                                     is_controllable boolean DEFAULT false,
                                     communication_protocols ARRAY,
                                     typical_parameters jsonb,
                                     installation_type character varying,
                                     certification_standards ARRAY,
                                     power_consumption character varying,
                                     operating_temperature character varying,
                                     dimensions jsonb,
                                     weight character varying,
                                     manufacturer_codes ARRAY,
                                     related_device_types ARRAY,
                                     monitoring_capabilities ARRAY,
                                     control_capabilities ARRAY,
                                     typical_applications ARRAY,
                                     display_order integer DEFAULT 0,
                                     is_system_type boolean DEFAULT false,
                                     parent_type_id uuid,
                                     metadata jsonb,
                                     CONSTRAINT device_types_pkey PRIMARY KEY (id),
                                     CONSTRAINT device_type_parent_type_id_fkey FOREIGN KEY (parent_type_id) REFERENCES public.device_types(id)
);
CREATE TABLE public.device_variables (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('device_variable_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         device_property_id uuid,
                                         report_field_id uuid,
                                         variable_id uuid,
                                         CONSTRAINT device_variables_pkey PRIMARY KEY (id),
                                         CONSTRAINT fkis9d1c1t7isbyo2o2qno2erov FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                                         CONSTRAINT fkjs5msc85ro4edv0qk0rd1yutb FOREIGN KEY (report_field_id) REFERENCES public.report_fields(id),
                                         CONSTRAINT fkojch40o0a0q0xap33g040eq5e FOREIGN KEY (device_property_id) REFERENCES public.device_properties(id)
);
CREATE TABLE public.devices (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('device_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                code character varying,
                                description character varying,
                                address character varying,
                                city character varying,
                                country character varying,
                                latitude double precision,
                                longitude double precision,
                                town character varying,
                                zoom integer,
                                name character varying,
                                brand_id uuid NOT NULL,
                                device_model_id uuid,
                                device_type_id uuid,
                                tenant_id uuid,
                                CONSTRAINT devices_pkey PRIMARY KEY (id),
                                CONSTRAINT fk44jyff85yjwhv24kcxsquyt9e FOREIGN KEY (device_type_id) REFERENCES public.device_types(id),
                                CONSTRAINT fka0e4k727f99o7p0hdp263js14 FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                                CONSTRAINT fkd2qw7tamed77e04qq45su4ycx FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                CONSTRAINT devices_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.districts (
                                  id integer NOT NULL DEFAULT nextval('districts_id_seq'::regclass),
                                  name character varying NOT NULL,
                                  code character varying,
                                  city_id integer,
                                  latitude numeric,
                                  longitude numeric,
                                  active boolean DEFAULT true,
                                  created_at timestamp with time zone DEFAULT now(),
                                  updated_at timestamp with time zone DEFAULT now(),
                                  state_id integer,
                                  CONSTRAINT districts_pkey PRIMARY KEY (id),
                                  CONSTRAINT districts_city_id_fkey FOREIGN KEY (city_id) REFERENCES public.cities(id),
                                  CONSTRAINT districts_state_id_fkey FOREIGN KEY (state_id) REFERENCES public.states(id)
);
CREATE TABLE public.emission_factors (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('emission_factors_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         description text,
                                         source_type character varying NOT NULL CHECK (source_type::text = ANY (ARRAY['ELECTRICITY'::character varying, 'NATURAL_GAS'::character varying, 'HEATING_OIL'::character varying, 'DIESEL'::character varying, 'GASOLINE'::character varying, 'BIOMASS'::character varying, 'COAL'::character varying, 'PROPANE'::character varying, 'REFRIGERATION'::character varying, 'TRANSPORTATION'::character varying, 'WASTE'::character varying, 'WATER'::character varying]::text[])),
  unit character varying NOT NULL,
  value double precision NOT NULL,
  year integer NOT NULL,
  tenant_id uuid DEFAULT gen_random_uuid(),
  area_id uuid NOT NULL DEFAULT gen_random_uuid(),
  CONSTRAINT emission_factors_pkey PRIMARY KEY (id),
  CONSTRAINT fkhyhdnucs4kvsr65g3whngnxo1 FOREIGN KEY (area_id) REFERENCES public.areas(id),
  CONSTRAINT fkacyofikmgbi7xl4jmfrdcj682 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.emission_reports (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('emission_reports_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         period_end date NOT NULL,
                                         period_start date NOT NULL,
                                         period_type character varying NOT NULL CHECK (period_type::text = ANY (ARRAY['DAILY'::character varying, 'WEEKLY'::character varying, 'MONTHLY'::character varying, 'QUARTERLY'::character varying, 'YEARLY'::character varying, 'CUSTOM'::character varying]::text[])),
  status character varying NOT NULL CHECK (status::text = ANY (ARRAY['ACTIVE'::character varying, 'INACTIVE'::character varying, 'PENDING'::character varying, 'COMPLETED'::character varying, 'CANCELLED'::character varying, 'DRAFT'::character varying]::text[])),
  target_emissions double precision,
  total_emissions double precision NOT NULL,
  variance_percentage double precision,
  tenant_id uuid DEFAULT gen_random_uuid(),
  unit_id uuid NOT NULL DEFAULT gen_random_uuid(),
  weather_data_id uuid DEFAULT gen_random_uuid(),
  CONSTRAINT emission_reports_pkey PRIMARY KEY (id),
  CONSTRAINT fkqw9maacgx7muc7c7apawp5emx FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fkdqmq6xi3oec6ne8ve2up6fxry FOREIGN KEY (unit_id) REFERENCES public.units(id),
  CONSTRAINT fkmwkmnph6f58seqd4geeo3ol5e FOREIGN KEY (weather_data_id) REFERENCES public.weather_datas(id)
);
CREATE TABLE public.emission_targets (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('emission_targets_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         baseline_emissions double precision NOT NULL,
                                         description text,
                                         end_date date NOT NULL,
                                         start_date date NOT NULL,
                                         status character varying NOT NULL CHECK (status::text = ANY (ARRAY['ACTIVE'::character varying, 'INACTIVE'::character varying, 'PENDING'::character varying, 'COMPLETED'::character varying, 'CANCELLED'::character varying, 'DRAFT'::character varying]::text[])),
  target_emissions double precision NOT NULL,
  target_reduction_percentage double precision NOT NULL,
  year integer NOT NULL,
  tenant_id uuid DEFAULT gen_random_uuid(),
  unit_id uuid NOT NULL DEFAULT gen_random_uuid(),
  CONSTRAINT emission_targets_pkey PRIMARY KEY (id),
  CONSTRAINT fkiui8y0m0pv8d1eqa7vmvs3k3t FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fkjfvjmbs8m6yntyhg7c1ix23kd FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.energy_configurations (
                                              id uuid NOT NULL,
                                              active boolean,
                                              created_by uuid,
                                              created_at timestamp with time zone,
                                              row_id integer NOT NULL DEFAULT nextval('energy_configuration_row_id_seq'::regclass),
                                              updated_by uuid,
                                              updated_at timestamp with time zone,
                                              co2kwh double precision,
                                              code character varying,
                                              cost double precision,
                                              currency character varying,
                                              description character varying,
                                              name character varying,
                                              CONSTRAINT energy_configurations_pkey PRIMARY KEY (id)
);
CREATE TABLE public.energy_consumptions (
                                            id uuid NOT NULL DEFAULT gen_random_uuid(),
                                            active boolean,
                                            created_by uuid,
                                            created_at timestamp with time zone,
                                            row_id integer NOT NULL DEFAULT nextval('energy_consumption_row_id_seq'::regclass),
                                            updated_by uuid,
                                            updated_at timestamp with time zone,
                                            consumption_unit character varying NOT NULL,
                                            consumption_value double precision NOT NULL,
                                            description text,
                                            measurement_period character varying,
                                            timestamp timestamp with time zone NOT NULL,
                                            tenant_id uuid DEFAULT gen_random_uuid(),
                                            fixed_asset_id uuid DEFAULT gen_random_uuid(),
                                            weather_data_id uuid DEFAULT gen_random_uuid(),
                                            CONSTRAINT energy_consumptions_pkey PRIMARY KEY (id),
                                            CONSTRAINT fk96fhsa17eepanc8o3k3ducu3i FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                            CONSTRAINT fkoob70hwm2c612at1b7f39j8my FOREIGN KEY (weather_data_id) REFERENCES public.weather_datas(id),
                                            CONSTRAINT fkmydwsub1wy8y5jthtna6sexuo FOREIGN KEY (fixed_asset_id) REFERENCES public.items(id)
);
CREATE TABLE public.energy_group_controllers (
                                                 id uuid NOT NULL,
                                                 active boolean,
                                                 created_by uuid,
                                                 created_at timestamp with time zone,
                                                 row_id integer NOT NULL DEFAULT nextval('energy_group_controller_row_id_seq'::regclass),
                                                 updated_by uuid,
                                                 updated_at timestamp with time zone,
                                                 controller_id uuid,
                                                 energy_group_id uuid,
                                                 measurement_id uuid,
                                                 CONSTRAINT energy_group_controllers_pkey PRIMARY KEY (id),
                                                 CONSTRAINT fk12n8loofm5kaf0v6mjxc29wc4 FOREIGN KEY (measurement_id) REFERENCES public.measurements(id),
                                                 CONSTRAINT fkllb5v81wvenjy7no4xvsouotg FOREIGN KEY (energy_group_id) REFERENCES public.energy_groups(id),
                                                 CONSTRAINT fkt44bi1d0220jhvend1jeb8cvm FOREIGN KEY (controller_id) REFERENCES public.controllers(id)
);
CREATE TABLE public.energy_group_templates (
                                               id uuid NOT NULL,
                                               active boolean,
                                               created_by uuid,
                                               created_at timestamp with time zone,
                                               row_id integer NOT NULL DEFAULT nextval('energy_group_template_row_id_seq'::regclass),
                                               updated_by uuid,
                                               updated_at timestamp with time zone,
                                               energy_group_id uuid,
                                               energy_report_template_id uuid,
                                               CONSTRAINT energy_group_templates_pkey PRIMARY KEY (id),
                                               CONSTRAINT fknbwxrko5r2yib4bg147k12n78 FOREIGN KEY (energy_report_template_id) REFERENCES public.energy_report_templates(id),
                                               CONSTRAINT fkne1lnmaxkrt8i1ccqr6w9lqn8 FOREIGN KEY (energy_group_id) REFERENCES public.energy_groups(id)
);
CREATE TABLE public.energy_groups (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('energy_group_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      code character varying,
                                      description character varying,
                                      is_enable boolean NOT NULL,
                                      name character varying,
                                      reference_entity character varying,
                                      reference_id character varying,
                                      CONSTRAINT energy_groups_pkey PRIMARY KEY (id)
);
CREATE TABLE public.energy_report_templates (
                                                id uuid NOT NULL,
                                                active boolean,
                                                created_by uuid,
                                                created_at timestamp with time zone,
                                                row_id integer NOT NULL DEFAULT nextval('energy_report_template_row_id_seq'::regclass),
                                                updated_by uuid,
                                                updated_at timestamp with time zone,
                                                code character varying,
                                                description character varying,
                                                frequency character varying,
                                                is_all_group boolean NOT NULL,
                                                is_kw boolean NOT NULL,
                                                is_kw_hour boolean NOT NULL,
                                                name character varying,
                                                period character varying,
                                                reference_entity character varying,
                                                reference_id character varying,
                                                CONSTRAINT energy_report_templates_pkey PRIMARY KEY (id)
);
CREATE TABLE public.energy_variables (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('energy_variable_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         code character varying,
                                         description character varying,
                                         name character varying,
                                         measurement_id uuid,
                                         variable_id uuid,
                                         CONSTRAINT energy_variables_pkey PRIMARY KEY (id),
                                         CONSTRAINT fkn31c78i6ro6swy4kk8b0hxvd0 FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                                         CONSTRAINT fkpm37wxxhsjn5iketqpja11tbv FOREIGN KEY (measurement_id) REFERENCES public.measurements(id)
);
CREATE TABLE public.event_attendees (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        event_id uuid NOT NULL,
                                        attendee_id uuid NOT NULL,
                                        rsvp_status character varying DEFAULT 'PENDING'::character varying CHECK (rsvp_status::text = ANY (ARRAY['PENDING'::character varying, 'ACCEPTED'::character varying, 'DECLINED'::character varying, 'TENTATIVE'::character varying]::text[])),
                                        rsvp_at timestamp with time zone,
                                        is_organizer boolean DEFAULT false,
                                        is_required boolean DEFAULT true,
                                        invited_at timestamp with time zone DEFAULT now(),
                                        invited_by character varying NOT NULL,
                                        CONSTRAINT event_attendees_pkey PRIMARY KEY (id),
                                        CONSTRAINT event_attendee_event_fkey FOREIGN KEY (event_id) REFERENCES public.calendar_events(id),
                                        CONSTRAINT event_attendee_attendee_fkey FOREIGN KEY (attendee_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.financials (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL DEFAULT nextval('financial_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   code character varying,
                                   description character varying,
                                   name character varying,
                                   account_name character varying,
                                   account_number character varying,
                                   account_type character varying,
                                   bank_address character varying,
                                   bank_city character varying,
                                   bank_country character varying,
                                   bank_name character varying,
                                   bank_state character varying,
                                   iban character varying,
                                   swift character varying,
                                   tax_number character varying,
                                   tax_office character varying,
                                   tenant_id uuid,
                                   CONSTRAINT financials_pkey PRIMARY KEY (id),
                                   CONSTRAINT fkj9bx9b4xtdeyxcywd4pifhirv FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.ftp_users (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('ftp_user_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  download_rate integer,
                                  enable_flag boolean,
                                  home_directory character varying,
                                  idle_time integer,
                                  max_login_number integer,
                                  max_login_per_ip integer,
                                  upload_rate integer,
                                  user_id character varying,
                                  user_password character varying,
                                  write_permission boolean,
                                  tenant_id uuid,
                                  CONSTRAINT ftp_users_pkey PRIMARY KEY (id),
                                  CONSTRAINT fk69rvyqcxojtrkw910jhiey0av FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.http_logs (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('http_log_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  ipaddress character varying,
                                  error_code character varying,
                                  execution_time numeric,
                                  request_body text,
                                  request_headers text,
                                  request_method character varying,
                                  request_time timestamp with time zone,
                                  request_url character varying,
                                  response_body text,
                                  response_headers text,
                                  response_time timestamp with time zone,
                                  tid uuid,
                                  url character varying,
                                  user_agent character varying,
                                  user_channel character varying,
                                  user_id uuid,
                                  CONSTRAINT http_logs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.inventories (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('inventory_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    name character varying,
                                    organization_id uuid,
                                    contractor_id uuid,
                                    project_work_request_id uuid,
                                    staff_id uuid,
                                    sub_contractor uuid,
                                    task_work_request_id uuid,
                                    team_id uuid,
                                    tenant_id uuid,
                                    inventory_type_id uuid,
                                    unit_id uuid,
                                    workflow_work_request_id uuid,
                                    CONSTRAINT inventories_pkey PRIMARY KEY (id),
                                    CONSTRAINT fk1vol9m45l4ydghg8atjhvfdwj FOREIGN KEY (task_work_request_id) REFERENCES public.tasks(work_request_id),
                                    CONSTRAINT fk2qpdin20lb4itgacqr0wgmba1 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                    CONSTRAINT fk4o35m1stq7mpg526auseuljor FOREIGN KEY (sub_contractor) REFERENCES public.sub_contractors(id),
                                    CONSTRAINT fk5a4s9hmfue05pgevueh7egb01 FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
                                    CONSTRAINT fk6w64sqhl11qsov1036xgei83t FOREIGN KEY (unit_id) REFERENCES public.units(id),
                                    CONSTRAINT fkd9ecdh6d1eq8cy9312neaf5fa FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
                                    CONSTRAINT fkgvs85v3mliropxr7hrhvtfv68 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                    CONSTRAINT fkia8uwj0gy2gcgm6g11f155vn2 FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
                                    CONSTRAINT fkj3xgh61u5yuo4h8ytrp0racoq FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                    CONSTRAINT fkn955m0muj7tup93f5jnusuuab FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                    CONSTRAINT fks1ypraegjm1bsn0kwjus3y69m FOREIGN KEY (inventory_type_id) REFERENCES public.inventory_types(id)
);
CREATE TABLE public.inventory_item_movements (
                                                 id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                 active boolean,
                                                 created_by uuid,
                                                 created_at timestamp with time zone,
                                                 row_id integer NOT NULL DEFAULT nextval('inventory_item_movement_row_id_seq'::regclass),
                                                 updated_by uuid,
                                                 updated_at timestamp with time zone,
                                                 approval_at timestamp with time zone,
                                                 approval_status character varying CHECK (approval_status::text = ANY (ARRAY['PENDING'::character varying, 'APPROVED'::character varying, 'REJECTED'::character varying, 'CANCELLED'::character varying, 'DRAFT'::character varying]::text[])),
  currency character varying,
  movement_at timestamp with time zone NOT NULL,
  movement_type character varying NOT NULL CHECK (movement_type::text = ANY (ARRAY['IN'::character varying, 'OUT'::character varying, 'TRANSFER'::character varying, 'ADJUSTMENT'::character varying, 'RETURN'::character varying, 'SCRAP'::character varying, 'FOUND'::character varying, 'LOST'::character varying, 'RESERVE'::character varying, 'UNRESERVE'::character varying, 'CONSUME'::character varying, 'PRODUCTION'::character varying]::text[])),
  notes text,
  quantity double precision NOT NULL,
  reference_id uuid,
  reference_no character varying,
  reference_type character varying,
  total_cost double precision,
  unit_cost double precision,
  tenant_id uuid DEFAULT gen_random_uuid(),
  approved_by_id uuid DEFAULT gen_random_uuid(),
  from_inventory_id uuid DEFAULT gen_random_uuid(),
  from_location_id uuid DEFAULT gen_random_uuid(),
  item_id uuid DEFAULT gen_random_uuid(),
  staff_id uuid DEFAULT gen_random_uuid(),
  to_inventory_id uuid DEFAULT gen_random_uuid(),
  to_location_id uuid DEFAULT gen_random_uuid(),
  unit_id uuid DEFAULT gen_random_uuid(),
  CONSTRAINT inventory_item_movements_pkey PRIMARY KEY (id),
  CONSTRAINT fklshnxkgaekhy8ecadko9ej2ca FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fk6evg25n2xewte3d7kenwe8ex5 FOREIGN KEY (approved_by_id) REFERENCES public.staffs(id),
  CONSTRAINT fkce55xxwjjsrhpndhn4ygdkmb5 FOREIGN KEY (from_inventory_id) REFERENCES public.inventories(id),
  CONSTRAINT fk8e0jtuxg758luv9hmsgqq7y0p FOREIGN KEY (from_location_id) REFERENCES public.locations(id),
  CONSTRAINT fk7g6779aswv5anoi9de0i682ub FOREIGN KEY (item_id) REFERENCES public.items(id),
  CONSTRAINT fk6lnw39hcc4fqk34nxlb0tq6u2 FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
  CONSTRAINT fkd8hp1myol2o5hpe2l5oc3lian FOREIGN KEY (to_inventory_id) REFERENCES public.inventories(id),
  CONSTRAINT fkptg0wlxgxdl56edo2o2fxutdr FOREIGN KEY (to_location_id) REFERENCES public.locations(id),
  CONSTRAINT fk1lgh99p5msvu63yeer6ws3uod FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.inventory_items (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('inventory_item_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        barcode character varying,
                                        qrcode character varying,
                                        quantity double precision,
                                        serial character varying,
                                        inventory_id uuid,
                                        production_id uuid,
                                        reserved_quantity double precision,
                                        stock_status character varying CHECK (stock_status::text = ANY (ARRAY['IN_STOCK'::character varying, 'OUT_OF_STOCK'::character varying, 'LOW_STOCK'::character varying, 'RESERVED'::character varying, 'ON_ORDER'::character varying, 'DISCONTINUED'::character varying, 'DAMAGED'::character varying, 'UNDER_MAINTENANCE'::character varying]::text[])),
  item_id uuid,
  CONSTRAINT inventory_items_pkey PRIMARY KEY (id),
  CONSTRAINT fk41ldo24h8fk36usx7n5605y6d FOREIGN KEY (inventory_id) REFERENCES public.inventories(id),
  CONSTRAINT fkaqpv734wq96wa83f0vni6u94j FOREIGN KEY (production_id) REFERENCES public.productions(id),
  CONSTRAINT fkd1g8wrnylpjywj6l32f0wukig FOREIGN KEY (item_id) REFERENCES public.items(id)
);
CREATE TABLE public.inventory_types (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('inventory_type_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        code character varying,
                                        description character varying,
                                        name character varying,
                                        tenant_id uuid,
                                        CONSTRAINT inventory_types_pkey PRIMARY KEY (id),
                                        CONSTRAINT fkgn0yd29swkayafu0s9okha8l4 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.invoice_details (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('invoice_detail_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        amount double precision,
                                        amount_currency character varying CHECK (amount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  description character varying,
  discount_amount double precision,
  discount_currency character varying CHECK (discount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  gross_amount double precision,
  gross_amount_currency character varying CHECK (gross_amount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  item_no character varying,
  net_amount double precision,
  net_amount_currency character varying CHECK (net_amount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  quantity double precision,
  unit_price double precision,
  unit_price_currency character varying CHECK (unit_price_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  vat_amount double precision,
  vat_currency character varying CHECK (vat_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  vat_rate double precision,
  tenant_id uuid,
  invoice_id uuid,
  characteristic_id uuid,
  CONSTRAINT invoice_details_pkey PRIMARY KEY (id),
  CONSTRAINT fk3sg3mxtqmscnjwjkqox1tln4r FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
  CONSTRAINT fkd80byodqx0ii7u8t7543e2kbd FOREIGN KEY (invoice_id) REFERENCES public.invoices(id),
  CONSTRAINT fkp4brcecdadwf7ot3nscaad8rp FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.invoices (
                                 id uuid NOT NULL DEFAULT gen_random_uuid(),
                                 active boolean DEFAULT true,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('invoice_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 approve_date timestamp with time zone,
                                 approved boolean DEFAULT false,
                                 details_amount double precision NOT NULL,
                                 details_amount_currency character varying CHECK (details_amount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  discount_amount double precision NOT NULL,
  discount_currency character varying CHECK (discount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  due_date timestamp with time zone,
  ettn character varying,
  invoice_date timestamp with time zone,
  invoice_number character varying,
  sub_total_amount double precision NOT NULL,
  sub_total_amount_currency character varying CHECK (sub_total_amount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  total_amount double precision NOT NULL,
  total_amount_currency character varying CHECK (total_amount_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  total_price double precision NOT NULL,
  total_price_currency character varying CHECK (total_price_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  vat_amount double precision NOT NULL,
  vat_currency character varying CHECK (vat_currency::text = ANY (ARRAY['USD'::character varying::text, 'EUR'::character varying::text, 'TRY'::character varying::text])),
  vat_rate double precision NOT NULL,
  tenant_id uuid,
  approving_id uuid,
  characteristics_id uuid,
  unit_id uuid,
  vendor_id uuid,
  payment_status character varying CHECK (payment_status::text = ANY (ARRAY['PENDING'::character varying, 'PAID'::character varying, 'CANCELLED'::character varying, 'CONFIRMED'::character varying, 'REJECTED'::character varying]::text[])),
  period_end_date timestamp with time zone,
  period_start_date timestamp with time zone,
  CONSTRAINT invoices_pkey PRIMARY KEY (id),
  CONSTRAINT fk6suo86v59hc1pxkk1vfrn5sfy FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fk6u4lpfij1kqyoyt3d7324fxq7 FOREIGN KEY (characteristics_id) REFERENCES public.characteristics(id),
  CONSTRAINT fk7cowa4qnymcyqvbsjglb91w49 FOREIGN KEY (unit_id) REFERENCES public.units(id),
  CONSTRAINT fkiao96jetvyvor7h2dwa7b4weh FOREIGN KEY (vendor_id) REFERENCES public.vendors(id),
  CONSTRAINT fko4xb1aawkst4jk2f4j5cv9jrd FOREIGN KEY (approving_id) REFERENCES public.realm_users(id)
);
CREATE TABLE public.item_characteristics (
                                             id uuid NOT NULL,
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('item_characteristic_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             value text,
                                             characteristic_id uuid,
                                             item_id uuid,
                                             CONSTRAINT item_characteristics_pkey PRIMARY KEY (id),
                                             CONSTRAINT fkdb81tsiw63exjfmctsfjwqcf6 FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                             CONSTRAINT fkrltkt8ykygc4dnmq09rfhijr4 FOREIGN KEY (item_id) REFERENCES public.items(id)
);
CREATE TABLE public.item_location_history (
                                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                                              item_id uuid NOT NULL,
                                              from_unit_id uuid,
                                              to_unit_id uuid NOT NULL,
                                              movement_type_id uuid,
                                              movement_reason text,
                                              requires_approval boolean DEFAULT false,
                                              approved_at timestamp with time zone,
                                              approved_by uuid,
                                              status character varying DEFAULT 'COMPLETED'::character varying CHECK (status::text = ANY (ARRAY['PENDING'::character varying, 'IN_TRANSIT'::character varying, 'COMPLETED'::character varying, 'CANCELLED'::character varying]::text[])),
                                              moved_at timestamp with time zone DEFAULT now(),
                                              moved_by uuid NOT NULL,
                                              notes text,
                                              row_id integer NOT NULL DEFAULT nextval('item_location_history_row_id_seq'::regclass),
                                              CONSTRAINT item_location_history_pkey PRIMARY KEY (id),
                                              CONSTRAINT item_location_history_item_id_fkey FOREIGN KEY (item_id) REFERENCES public.items(id),
                                              CONSTRAINT item_location_history_from_unit_id_fkey FOREIGN KEY (from_unit_id) REFERENCES public.units(id),
                                              CONSTRAINT item_location_history_to_unit_id_fkey FOREIGN KEY (to_unit_id) REFERENCES public.units(id),
                                              CONSTRAINT item_location_history_movement_type_id_fkey FOREIGN KEY (movement_type_id) REFERENCES public.categories(id)
);
CREATE TABLE public.items (
                              type character varying NOT NULL,
                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('item_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              barcode character varying,
                              code character varying,
                              description character varying,
                              name character varying,
                              row_number integer,
                              serial_number character varying,
                              installation_date timestamp with time zone,
                              last_maintenance timestamp with time zone,
                              is_used boolean DEFAULT false,
                              used_by uuid,
                              used_date timestamp without time zone DEFAULT now(),
                              brand_id uuid NOT NULL,
                              tenant_id uuid,
                              blueprint_id uuid,
                              production_id uuid,
                              vendor_id uuid,
                              currency character varying,
                              image_path character varying,
                              last_maintenance_at timestamp with time zone,
                              max_stock_level double precision,
                              min_stock_level double precision,
                              next_maintenance_at timestamp with time zone,
                              reorder_level double precision,
                              unit_price double precision,
                              warranty_months integer,
                              catalog_id uuid,
                              device_model_id uuid,
                              device_sub_category_id uuid,
                              device_type_id uuid,
                              device uuid DEFAULT gen_random_uuid() UNIQUE,
                              device_type uuid DEFAULT gen_random_uuid() UNIQUE,
                              manufactured_at timestamp with time zone,
                              expires_at timestamp with time zone,
                              is_verified boolean DEFAULT false,
                              published boolean DEFAULT false,
                              current_unit_id uuid,
                              last_location_change_at timestamp with time zone,
                              last_location_change_by uuid,
                              location_change_reason character varying,
                              CONSTRAINT items_pkey PRIMARY KEY (id),
                              CONSTRAINT fknhv6v9cnhqnty7rbguwlxr7e FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                              CONSTRAINT fkdrkgx9furxyv09fpsfv4wag4o FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                              CONSTRAINT fkkdyj7stpmr5en30xdjgweraye FOREIGN KEY (production_id) REFERENCES public.productions(id),
                              CONSTRAINT fknqhrysahmgdfmistfffpjgyxx FOREIGN KEY (vendor_id) REFERENCES public.vendors(id),
                              CONSTRAINT fkkjietbo1n7p2sxb56fnxd9uj1 FOREIGN KEY (catalog_id) REFERENCES public.catalogs(id),
                              CONSTRAINT fkio51b16935m2kjvf9f20up3cq FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                              CONSTRAINT fkdt6dglrl79vxog4cs9q0kpffh FOREIGN KEY (device_sub_category_id) REFERENCES public.device_types(id),
                              CONSTRAINT fk3kmppxng4872pmy3l0ce3vlul FOREIGN KEY (device_type_id) REFERENCES public.device_types(id),
                              CONSTRAINT fk_item_current_unit FOREIGN KEY (current_unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.keywords (
                                 id uuid NOT NULL,
                                 active boolean,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('keyword_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 defaultvalue character varying,
                                 key character varying,
                                 longvalue character varying,
                                 reference_entity character varying,
                                 reference_id uuid,
                                 shortvalue character varying,
                                 language_id uuid,
                                 CONSTRAINT keywords_pkey PRIMARY KEY (id),
                                 CONSTRAINT fkccr2fj908u2bjdmcifyjjw27q FOREIGN KEY (language_id) REFERENCES public.languages(id)
);
CREATE TABLE public.kpi_group_controllers (
                                              kpigroup_id uuid NOT NULL,
                                              controller_id uuid NOT NULL,
                                              CONSTRAINT fk7vbi7osj5tw7ct5572np3cyyq FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                                              CONSTRAINT fkgo2seq6ofg2v8kqw0754hv1lm FOREIGN KEY (kpigroup_id) REFERENCES public.kpi_groups(id)
);
CREATE TABLE public.kpi_groups (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL DEFAULT nextval('kpi_group_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   code character varying,
                                   description character varying,
                                   name character varying,
                                   reference_entity character varying,
                                   reference_id uuid,
                                   CONSTRAINT kpi_groups_pkey PRIMARY KEY (id)
);
CREATE TABLE public.kpi_reports (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('kpi_report_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    high_threshold integer,
                                    low_threshold integer,
                                    max_high_threshold_percentage integer,
                                    max_low_threshold_percentage integer,
                                    name character varying,
                                    reference_entity character varying,
                                    reference_id uuid,
                                    CONSTRAINT kpi_reports_pkey PRIMARY KEY (id)
);
CREATE TABLE public.lang_values (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('lang_value_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    entity character varying,
                                    entity_id uuid,
                                    key character varying,
                                    value character varying,
                                    language_id uuid,
                                    CONSTRAINT lang_values_pkey PRIMARY KEY (id),
                                    CONSTRAINT fklk6qnys9q0mxp6nnqnpv71vuv FOREIGN KEY (language_id) REFERENCES public.languages(id)
);
CREATE TABLE public.languages (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('language_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  icon character varying,
                                  locale character varying,
                                  system_default boolean,
                                  native_name character varying,
                                  is_default boolean DEFAULT false,
                                  CONSTRAINT languages_pkey PRIMARY KEY (id)
);
CREATE TABLE public.location_histories (
                                           id uuid NOT NULL,
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('location_history_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           altitude character varying,
                                           latitude character varying,
                                           longitude character varying,
                                           CONSTRAINT location_histories_pkey PRIMARY KEY (id)
);
CREATE TABLE public.locations (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('location_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  address character varying,
                                  admin1name character varying,
                                  admin2name character varying,
                                  altitude character varying,
                                  city character varying,
                                  country character varying,
                                  geo_name_id character varying,
                                  iso2 character varying,
                                  lat double precision,
                                  latitude character varying,
                                  lng double precision,
                                  longitude character varying,
                                  name_ascii character varying,
                                  town character varying,
                                  type character varying,
                                  zoom integer,
                                  tenant_id uuid,
                                  CONSTRAINT locations_pkey PRIMARY KEY (id),
                                  CONSTRAINT locations_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.log_report_controllers (
                                               logreport_id uuid NOT NULL,
                                               controller_id uuid NOT NULL,
                                               CONSTRAINT fkfou4d7b274ywfsop97hy3786q FOREIGN KEY (logreport_id) REFERENCES public.log_reports(id),
                                               CONSTRAINT fkp3i8u92ckvyearfouupsvwjum FOREIGN KEY (controller_id) REFERENCES public.controllers(id)
);
CREATE TABLE public.log_reports (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('log_report_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    frequency integer,
                                    name character varying,
                                    period character varying,
                                    reference_entity character varying,
                                    reference_id uuid,
                                    CONSTRAINT log_reports_pkey PRIMARY KEY (id)
);
CREATE TABLE public.logs (
                             id uuid NOT NULL,
                             active boolean,
                             created_by uuid,
                             created_at timestamp with time zone,
                             row_id integer NOT NULL DEFAULT nextval('log_row_id_seq'::regclass),
                             updated_by uuid,
                             updated_at timestamp with time zone,
                             datetime timestamp with time zone,
                             maintenance character varying,
                             onoff integer,
                             value character varying,
                             archive_group character varying,
                             cancelled boolean,
                             code character varying,
                             date_time timestamp with time zone,
                             description character varying,
                             is_archive boolean,
                             name character varying,
                             on_off integer,
                             controller_id uuid,
                             provider_id uuid,
                             realtime_id uuid,
                             tenant_id uuid,
                             txn_id uuid,
                             variable_id uuid,
                             organization_id uuid,
                             CONSTRAINT logs_pkey PRIMARY KEY (id),
                             CONSTRAINT fkqm3ywwytyt8ivdy0nfgq5lb2q FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                             CONSTRAINT fk64ypxp51p8wpo8w9dqonelirc FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                             CONSTRAINT fk86yu7c0juy6v4cn30sptgxnpc FOREIGN KEY (realtime_id) REFERENCES public.realtimes(id),
                             CONSTRAINT fkl25yk8kyg1xm0l6jphad2ufic FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                             CONSTRAINT fk82x80md4hj4lujd6ogffqm1hv FOREIGN KEY (txn_id) REFERENCES public.txns(id),
                             CONSTRAINT fkgaca6f1768cv5qbclgpln6y7m FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                             CONSTRAINT logs_organization_id_fkey FOREIGN KEY (organization_id) REFERENCES public.organizations(id)
);
CREATE TABLE public.mail_daily_stats (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         row_id integer NOT NULL DEFAULT nextval('mail_daily_stats_row_id_seq'::regclass),
                                         created_at timestamp with time zone DEFAULT now(),
                                         updated_at timestamp with time zone DEFAULT now(),
                                         date date NOT NULL,
                                         platform_id uuid,
                                         tenant_id uuid,
                                         queued_count integer DEFAULT 0,
                                         sent_count integer DEFAULT 0,
                                         delivered_count integer DEFAULT 0,
                                         failed_count integer DEFAULT 0,
                                         bounced_count integer DEFAULT 0,
                                         opened_count integer DEFAULT 0,
                                         clicked_count integer DEFAULT 0,
                                         CONSTRAINT mail_daily_stats_pkey PRIMARY KEY (id),
                                         CONSTRAINT mail_daily_stats_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                         CONSTRAINT mail_daily_stats_platform_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id)
);
CREATE TABLE public.mail_events (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    active boolean DEFAULT true,
                                    created_by uuid,
                                    created_at timestamp with time zone DEFAULT now(),
                                    row_id integer NOT NULL DEFAULT nextval('mail_events_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone DEFAULT now(),
                                    mail_id uuid NOT NULL,
                                    event_type USER-DEFINED NOT NULL,
                                    event_data jsonb,
                                    CONSTRAINT mail_events_pkey PRIMARY KEY (id),
                                    CONSTRAINT mail_events_mail_fkey FOREIGN KEY (mail_id) REFERENCES public.mail_queue(id)
);
CREATE TABLE public.mail_providers (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       active boolean DEFAULT true,
                                       created_by uuid,
                                       created_at timestamp with time zone DEFAULT now(),
                                       row_id integer NOT NULL DEFAULT nextval('mail_providers_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone DEFAULT now(),
                                       tenant_id uuid NOT NULL,
                                       platform_id uuid,
                                       provider_type USER-DEFINED NOT NULL,
                                       name character varying NOT NULL,
                                       description text,
                                       credentials jsonb NOT NULL DEFAULT '{}'::jsonb,
                                       from_address character varying,
                                       from_name character varying,
                                       reply_to character varying,
                                       priority integer DEFAULT 1,
                                       is_default boolean DEFAULT false,
                                       is_active boolean DEFAULT true,
                                       last_error text,
                                       last_error_at timestamp with time zone,
                                       success_count integer DEFAULT 0,
                                       failure_count integer DEFAULT 0,
                                       last_used_at timestamp with time zone,
                                       CONSTRAINT mail_providers_pkey PRIMARY KEY (id),
                                       CONSTRAINT mail_providers_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                       CONSTRAINT mail_providers_platform_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id)
);
CREATE TABLE public.mail_queue (
                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                   active boolean DEFAULT true,
                                   created_by uuid,
                                   created_at timestamp with time zone DEFAULT now(),
                                   row_id integer NOT NULL DEFAULT nextval('mail_queue_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone DEFAULT now(),
                                   platform_id uuid,
                                   tenant_id uuid NOT NULL,
                                   provider_id uuid,
                                   template_id uuid,
                                   external_id character varying,
                                   batch_id uuid,
                                   from_address character varying NOT NULL,
                                   from_name character varying,
                                   reply_to character varying,
                                   to_addresses jsonb NOT NULL DEFAULT '[]'::jsonb,
                                   cc_addresses jsonb DEFAULT '[]'::jsonb,
                                   bcc_addresses jsonb DEFAULT '[]'::jsonb,
                                   subject character varying NOT NULL,
                                   body_html text,
                                   body_text text,
                                   attachments jsonb DEFAULT '[]'::jsonb,
                                   status USER-DEFINED DEFAULT 'pending'::mail_status,
                                   priority integer DEFAULT 5,
                                   scheduled_at timestamp with time zone,
                                   attempts integer DEFAULT 0,
                                   max_attempts integer DEFAULT 3,
                                   next_retry_at timestamp with time zone,
                                   processing_started_at timestamp with time zone,
                                   sent_at timestamp with time zone,
                                   delivered_at timestamp with time zone,
                                   message_id character varying,
                                   error_code character varying,
                                   error_message text,
                                   track_opens boolean DEFAULT false,
                                   track_clicks boolean DEFAULT false,
                                   opened_at timestamp with time zone,
                                   open_count integer DEFAULT 0,
                                   click_count integer DEFAULT 0,
                                   tags ARRAY,
                                   metadata jsonb,
                                   CONSTRAINT mail_queue_pkey PRIMARY KEY (id),
                                   CONSTRAINT mail_queue_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                   CONSTRAINT mail_queue_platform_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                   CONSTRAINT mail_queue_provider_fkey FOREIGN KEY (provider_id) REFERENCES public.mail_providers(id),
                                   CONSTRAINT mail_queue_template_fkey FOREIGN KEY (template_id) REFERENCES public.mail_templates(id)
);
CREATE TABLE public.mail_templates (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       active boolean DEFAULT true,
                                       created_by uuid,
                                       created_at timestamp with time zone DEFAULT now(),
                                       row_id integer NOT NULL DEFAULT nextval('mail_templates_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone DEFAULT now(),
                                       platform_id uuid,
                                       tenant_id uuid,
                                       name character varying NOT NULL,
                                       slug character varying NOT NULL,
                                       description text,
                                       subject_template text NOT NULL,
                                       body_html_template text,
                                       body_text_template text,
                                       variables_schema jsonb,
                                       sample_variables jsonb,
                                       default_from_address character varying,
                                       default_from_name character varying,
                                       version integer DEFAULT 1,
                                       is_active boolean DEFAULT true,
                                       category character varying,
                                       tags ARRAY,
                                       CONSTRAINT mail_templates_pkey PRIMARY KEY (id),
                                       CONSTRAINT mail_templates_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                       CONSTRAINT mail_templates_platform_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id)
);
CREATE TABLE public.mail_webhook_subscriptions (
                                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                   active boolean DEFAULT true,
                                                   created_by uuid,
                                                   created_at timestamp with time zone DEFAULT now(),
                                                   row_id integer NOT NULL DEFAULT nextval('mail_webhook_subscriptions_row_id_seq'::regclass),
                                                   updated_by uuid,
                                                   updated_at timestamp with time zone DEFAULT now(),
                                                   platform_id uuid NOT NULL,
                                                   tenant_id uuid,
                                                   name character varying NOT NULL,
                                                   url text NOT NULL,
                                                   secret character varying NOT NULL,
                                                   events ARRAY NOT NULL,
                                                   is_active boolean DEFAULT true,
                                                   success_count integer DEFAULT 0,
                                                   failure_count integer DEFAULT 0,
                                                   last_triggered_at timestamp with time zone,
                                                   last_failure_reason text,
                                                   CONSTRAINT mail_webhook_subscriptions_pkey PRIMARY KEY (id),
                                                   CONSTRAINT mail_webhooks_platform_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                                   CONSTRAINT mail_webhooks_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.maintenance_logs (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('maintenance_logs_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         description character varying,
                                         maintenance_date timestamp with time zone,
                                         status character varying CHECK (status::text = ANY (ARRAY['CREATED'::character varying, 'ASSIGNED'::character varying, 'IN_PROGRESS'::character varying, 'COMPLETED'::character varying, 'REJECTED'::character varying, 'STOPPED'::character varying, 'CANCELED'::character varying]::text[])),
  tenant_id uuid,
  controller_id uuid,
  staff_id uuid,
  CONSTRAINT maintenance_logs_pkey PRIMARY KEY (id),
  CONSTRAINT fka9bhp3i4f2apnemkvs7q77o7k FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fk8f0qw5ets2g1fh5md7ggotfnh FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
  CONSTRAINT fk9eygy0yj8ov78wceybcpnjwo5 FOREIGN KEY (staff_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.maintenances (
                                     id uuid NOT NULL DEFAULT gen_random_uuid(),
                                     active boolean,
                                     created_by uuid,
                                     created_at timestamp with time zone,
                                     row_id integer NOT NULL DEFAULT nextval('maintenance_row_id_seq'::regclass),
                                     updated_by uuid,
                                     updated_at timestamp with time zone,
                                     actual_duration_hours integer,
                                     code character varying,
                                     completed_date timestamp with time zone,
                                     cost double precision,
                                     description character varying,
                                     due_date timestamp with time zone,
                                     estimated_duration_hours integer,
                                     maintenance_type character varying,
                                     name character varying,
                                     notes character varying,
                                     priority character varying CHECK (priority::text = ANY (ARRAY['LOW'::character varying, 'MEDIUM'::character varying, 'HIGH'::character varying, 'CRITICAL'::character varying, 'URGENT'::character varying, 'IMMEDIATE'::character varying, 'ASAP'::character varying, 'EMERGENCY'::character varying, 'STAT'::character varying, 'STANDARD'::character varying, 'ROUTINE'::character varying, 'REGULAR'::character varying]::text[])),
  scheduled_date timestamp with time zone,
  status character varying,
  tenant_id uuid DEFAULT gen_random_uuid(),
  assigned_staff_id uuid DEFAULT gen_random_uuid(),
  contractor_id uuid DEFAULT gen_random_uuid(),
  item_id uuid DEFAULT gen_random_uuid(),
  sub_contractor_id uuid DEFAULT gen_random_uuid(),
  unit_id uuid DEFAULT gen_random_uuid(),
  CONSTRAINT maintenances_pkey PRIMARY KEY (id),
  CONSTRAINT fk6fdl9sfeijgrvuc5ywssec9h1 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fk9i913bhtcc186hhj4sra09a1u FOREIGN KEY (assigned_staff_id) REFERENCES public.staffs(id),
  CONSTRAINT fktqxy4dn5ng9gco77ktjx8t9yx FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
  CONSTRAINT fk5uac2rst7o99y1njgpi9k67tj FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
  CONSTRAINT fknvn2lmld5nkbts0yl7e4k77st FOREIGN KEY (unit_id) REFERENCES public.units(id),
  CONSTRAINT fkceqm3yy85tbo8daufi4s44txx FOREIGN KEY (item_id) REFERENCES public.items(id)
);
CREATE TABLE public.markers (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('marker_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                code character varying,
                                description character varying,
                                location character varying,
                                name character varying,
                                tenant_id uuid,
                                CONSTRAINT markers_pkey PRIMARY KEY (id),
                                CONSTRAINT markers_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.measurements (
                                     id uuid NOT NULL,
                                     active boolean,
                                     created_by uuid,
                                     created_at timestamp with time zone,
                                     row_id integer NOT NULL DEFAULT nextval('measurement_row_id_seq'::regclass),
                                     updated_by uuid,
                                     updated_at timestamp with time zone,
                                     code character varying,
                                     description character varying,
                                     name character varying,
                                     reference_entity character varying,
                                     reference_id character varying,
                                     devicemodel_id uuid,
                                     provider_id uuid,
                                     CONSTRAINT measurements_pkey PRIMARY KEY (id),
                                     CONSTRAINT fkc3tqtq2y9chjlugcb2oxw1wrq FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                                     CONSTRAINT fkrt3belhlhcbo60snx140kq64l FOREIGN KEY (devicemodel_id) REFERENCES public.device_models(id)
);
CREATE TABLE public.menu_ids (
                                 id uuid NOT NULL,
                                 active boolean,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('menu_id_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 menu_id uuid,
                                 profile_id uuid,
                                 CONSTRAINT menu_ids_pkey PRIMARY KEY (id),
                                 CONSTRAINT fk169fea832yhynja8agombnrmo FOREIGN KEY (profile_id) REFERENCES public.profiles(id)
);
CREATE TABLE public.menus (
                              id uuid NOT NULL,
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('menu_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              description character varying,
                              name character varying,
                              role character varying,
                              CONSTRAINT menus_pkey PRIMARY KEY (id)
);
CREATE TABLE public.notifications (
                                      id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('notification_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      acknowledged boolean,
                                      acknowledged_at timestamp with time zone,
                                      date_time timestamp with time zone,
                                      description text,
                                      entity_id uuid,
                                      entity_type character varying CHECK (entity_type::text = ANY (ARRAY['INVOICE'::character varying, 'PRODUCTION'::character varying, 'PRODUCT'::character varying, 'BLUEPRINT'::character varying, 'PRODUCTION_ORDER'::character varying, 'CONTROLLER'::character varying, 'PROVIDER'::character varying, 'ITEM'::character varying, 'UNIT'::character varying]::text[])),
  meta text,
  notification_type character varying CHECK (notification_type::text = ANY (ARRAY['ALERT'::character varying, 'REMINDER'::character varying, 'INFO'::character varying]::text[])),
  priority smallint CHECK (priority >= 0 AND priority <= 11),
  sent boolean,
  title character varying,
  acknowledged_by uuid,
  platform_id uuid,
  profile_id uuid,
  read boolean,
  sender_id uuid,
  recipient_id uuid,
  tenant_id uuid,
  is_read boolean NOT NULL DEFAULT false,
  read_at timestamp with time zone,
  CONSTRAINT notifications_pkey PRIMARY KEY (id),
  CONSTRAINT notifications_sender_id_fkey FOREIGN KEY (sender_id) REFERENCES public.profiles(id),
  CONSTRAINT notifications_recipient_id_fkey FOREIGN KEY (recipient_id) REFERENCES public.profiles(id),
  CONSTRAINT notifications_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT notifications_acknowledged_by_fkey FOREIGN KEY (acknowledged_by) REFERENCES public.profiles(id),
  CONSTRAINT notifications_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
  CONSTRAINT notifications_profile_id_fkey FOREIGN KEY (profile_id) REFERENCES public.profiles(id)
);
CREATE TABLE public.onboarding_checklist (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             tenant_id uuid NOT NULL,
                                             item_key character varying NOT NULL,
                                             item_name character varying NOT NULL,
                                             item_description text,
                                             item_order integer DEFAULT 0,
                                             is_required boolean DEFAULT true,
                                             is_completed boolean DEFAULT false,
                                             is_skipped boolean DEFAULT false,
                                             completed_at timestamp with time zone,
                                             completed_by uuid,
                                             skipped_at timestamp with time zone,
                                             skipped_by uuid,
                                             skip_reason text,
                                             created_at timestamp with time zone DEFAULT now(),
                                             updated_at timestamp with time zone DEFAULT now(),
                                             CONSTRAINT onboarding_checklist_pkey PRIMARY KEY (id),
                                             CONSTRAINT onboarding_checklist_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.onboarding_templates (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             code character varying NOT NULL UNIQUE,
                                             name character varying NOT NULL,
                                             description text,
                                             template_data jsonb NOT NULL DEFAULT '{}'::jsonb,
                                             category character varying,
                                             tags ARRAY DEFAULT ARRAY[]::text[],
                                             icon character varying,
                                             color character varying,
                                             image_url text,
                                             sort_order integer DEFAULT 0,
                                             is_enabled boolean DEFAULT true,
                                             is_default boolean DEFAULT false,
                                             is_system boolean DEFAULT false,
                                             usage_count integer DEFAULT 0,
                                             last_used_at timestamp with time zone,
                                             created_at timestamp with time zone DEFAULT now(),
                                             updated_at timestamp with time zone DEFAULT now(),
                                             created_by uuid,
                                             updated_by uuid,
                                             CONSTRAINT onboarding_templates_pkey PRIMARY KEY (id)
);
CREATE TABLE public.operation_actions (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('operation_action_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          code character varying,
                                          description character varying,
                                          name character varying,
                                          protocol character varying,
                                          protocol_acronym character varying,
                                          operation_method_id uuid,
                                          specific_integer1 integer,
                                          specific_string1 character varying,
                                          specific_string2 character varying,
                                          CONSTRAINT operation_actions_pkey PRIMARY KEY (id),
                                          CONSTRAINT fkgokow9n5xnyqxu1qxgcpr6n50 FOREIGN KEY (operation_method_id) REFERENCES public.operation_methods(id)
);
CREATE TABLE public.operation_methods (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('operation_method_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          code character varying,
                                          description character varying,
                                          name character varying,
                                          CONSTRAINT operation_methods_pkey PRIMARY KEY (id)
);
CREATE TABLE public.organization_contractors (
                                                 id uuid NOT NULL,
                                                 active boolean,
                                                 created_by uuid,
                                                 created_at timestamp with time zone,
                                                 row_id integer NOT NULL DEFAULT nextval('consumer_contractor_row_id_seq'::regclass),
                                                 updated_by uuid,
                                                 updated_at timestamp with time zone,
                                                 organization_id uuid,
                                                 contractor_id uuid,
                                                 CONSTRAINT organization_contractors_pkey PRIMARY KEY (id),
                                                 CONSTRAINT fk5eb8ysmnd738hyeuxvx9tjkt6 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                                 CONSTRAINT fkcag3m0tq1slyeww6pt3bh3ie4 FOREIGN KEY (organization_id) REFERENCES public.organizations(id)
);
CREATE TABLE public.organization_payments (
                                              organization_id uuid NOT NULL,
                                              payment_id uuid NOT NULL,
                                              CONSTRAINT fk6oec8sodi81q15gbyka2j0ot3 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                              CONSTRAINT fkmdiikvchccde6400shcw4o2de FOREIGN KEY (payment_id) REFERENCES public.payments(id)
);
CREATE TABLE public.organization_teams (
                                           organization_id uuid NOT NULL,
                                           team_id uuid NOT NULL,
                                           CONSTRAINT fkaqffplbyhac8odpjkrdm7vau2 FOREIGN KEY (team_id) REFERENCES public.organizations(id),
                                           CONSTRAINT fkb0ibpvtaiahqoiv6k6t0kwkkd FOREIGN KEY (organization_id) REFERENCES public.teams(id),
                                           CONSTRAINT fk34m8q52vp5abrhydtg36ndsuc FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                           CONSTRAINT fkoa6yqua2tj7272khormwqdoy6 FOREIGN KEY (organization_id) REFERENCES public.organizations(id)
);
CREATE TABLE public.organization_tickets (
                                             organization_id uuid NOT NULL,
                                             ticket_id uuid NOT NULL,
                                             CONSTRAINT fkktx7ed3b7nlkcwciq8dj22gd9 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                             CONSTRAINT fkp30eh5b2ci8sxthj1blosac6 FOREIGN KEY (ticket_id) REFERENCES public.tickets(id)
);
CREATE TABLE public.organizations (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('consumer_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      code character varying,
                                      description character varying,
                                      name character varying,
                                      color character varying,
                                      image_path character varying,
                                      address character varying,
                                      city character varying,
                                      country character varying,
                                      latitude double precision,
                                      longitude double precision,
                                      town character varying,
                                      zoom integer,
                                      financial_id uuid UNIQUE,
                                      marker_id uuid,
                                      tenant_id uuid NOT NULL,
                                      contact_person character varying,
                                      contact_email character varying,
                                      contact_phone character varying,
                                      website character varying,
                                      tax_number character varying,
                                      registration_number character varying,
                                      CONSTRAINT organizations_pkey PRIMARY KEY (id),
                                      CONSTRAINT fk1dnpups9kil1mb737ga7pvnoa FOREIGN KEY (financial_id) REFERENCES public.financials(id),
                                      CONSTRAINT fk88nta2sgkm10q9tckn6qhcljl FOREIGN KEY (marker_id) REFERENCES public.markers(id),
                                      CONSTRAINT fkrs059hp3rlsk0sah594eut9ua FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.page_ids (
                                 id uuid NOT NULL,
                                 active boolean,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('page_id_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 page_id uuid,
                                 profile_id uuid,
                                 CONSTRAINT page_ids_pkey PRIMARY KEY (id),
                                 CONSTRAINT fkp7gi4gos0d6br0bn0gn11ay5g FOREIGN KEY (profile_id) REFERENCES public.profiles(id)
);
CREATE TABLE public.pages (
                              id uuid NOT NULL,
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('page_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              description character varying,
                              name character varying,
                              role character varying,
                              sub_menu_id uuid,
                              CONSTRAINT pages_pkey PRIMARY KEY (id),
                              CONSTRAINT fk5ottqac9pnawo5lgfaf8ish38 FOREIGN KEY (sub_menu_id) REFERENCES public.sub_menus(id)
);
CREATE TABLE public.payments (
                                 id uuid NOT NULL,
                                 active boolean,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('payment_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 payment_status character varying CHECK (payment_status::text = ANY (ARRAY['PENDING'::character varying::text, 'PAID'::character varying::text, 'CANCELLED'::character varying::text, 'CONFIRMED'::character varying::text, 'REJECTED'::character varying::text])),
  payment_type character varying CHECK (payment_type::text = ANY (ARRAY['PROJECT'::character varying::text, 'WORKFLOW'::character varying::text, 'TASK'::character varying::text])),
  source uuid,
  target uuid,
  tenant_id uuid,
  project_work_request_id uuid,
  task_work_request_id uuid,
  workflow_work_request_id uuid,
  CONSTRAINT payments_pkey PRIMARY KEY (id),
  CONSTRAINT fk244xe1adi73e37pyxyoiuucdl FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
  CONSTRAINT fk3ej2q92pbpcq6slrw5hiljfsh FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
  CONSTRAINT fk3wmnc0a2hib45e3p18ue7qsui FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fkf1n63q4nn3q4c0o2ef567g9l FOREIGN KEY (task_work_request_id) REFERENCES public.tasks(work_request_id)
);
CREATE TABLE public.periods (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('period_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                description character varying,
                                end_time time without time zone,
                                name character varying,
                                short_code character varying,
                                start_time time without time zone,
                                unit_id uuid,
                                CONSTRAINT periods_pkey PRIMARY KEY (id),
                                CONSTRAINT fkl9yjx5m0t125qflex86gwwdca FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.persons (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('person_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                code character varying,
                                description character varying,
                                name character varying,
                                note character varying,
                                position character varying,
                                assigned_to_staff_id uuid,
                                customer_id uuid,
                                tenant_id uuid,
                                CONSTRAINT persons_pkey PRIMARY KEY (id),
                                CONSTRAINT fk1jx942s7rhh961xvkmx4p22ts FOREIGN KEY (assigned_to_staff_id) REFERENCES public.staffs(id),
                                CONSTRAINT fkmt858287xbam24ywsax76bt8r FOREIGN KEY (customer_id) REFERENCES public.customers(id),
                                CONSTRAINT persons_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.plan_quotas (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    subscription_plan_id uuid NOT NULL,
                                    quota_key character varying NOT NULL,
                                    quota_value integer NOT NULL CHECK (quota_value > 0),
                                    quota_unit character varying,
                                    created_at timestamp with time zone DEFAULT now(),
                                    updated_at timestamp with time zone DEFAULT now(),
                                    created_by uuid,
                                    updated_by uuid,
                                    CONSTRAINT plan_quotas_pkey PRIMARY KEY (id),
                                    CONSTRAINT plan_quotas_subscription_plan_id_fkey FOREIGN KEY (subscription_plan_id) REFERENCES public.subscription_plans(id),
                                    CONSTRAINT plan_quotas_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                    CONSTRAINT plan_quotas_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.platform_budgets (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         platform_id uuid NOT NULL,
                                         budget_year integer NOT NULL,
                                         budget_quarter integer CHECK (budget_quarter IS NULL OR budget_quarter >= 1 AND budget_quarter <= 4),
                                         budget_month integer CHECK (budget_month IS NULL OR budget_month >= 1 AND budget_month <= 12),
                                         development_budget numeric DEFAULT 0,
                                         infrastructure_budget numeric DEFAULT 0,
                                         marketing_budget numeric DEFAULT 0,
                                         support_budget numeric DEFAULT 0,
                                         other_budget numeric DEFAULT 0,
                                         total_budget numeric DEFAULT ((((development_budget + infrastructure_budget) + marketing_budget) + support_budget) + other_budget),
                                         development_spent numeric DEFAULT 0,
                                         infrastructure_spent numeric DEFAULT 0,
                                         marketing_spent numeric DEFAULT 0,
                                         support_spent numeric DEFAULT 0,
                                         other_spent numeric DEFAULT 0,
                                         total_spent numeric DEFAULT ((((development_spent + infrastructure_spent) + marketing_spent) + support_spent) + other_spent),
                                         variance numeric DEFAULT 0,
                                         variance_percentage numeric DEFAULT 0,
                                         currency character varying DEFAULT 'TRY'::character varying,
                                         status character varying DEFAULT 'draft'::character varying CHECK (status::text = ANY (ARRAY['draft'::character varying, 'pending'::character varying, 'approved'::character varying, 'active'::character varying, 'closed'::character varying, 'cancelled'::character varying]::text[])),
                                         approved_at timestamp with time zone,
                                         approved_by uuid,
                                         notes text,
                                         created_at timestamp with time zone DEFAULT now(),
                                         updated_at timestamp with time zone DEFAULT now(),
                                         created_by uuid,
                                         updated_by uuid,
                                         active boolean,
                                         CONSTRAINT platform_budgets_pkey PRIMARY KEY (id),
                                         CONSTRAINT platform_budgets_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_budgets_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_budgets_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id)
);
CREATE TABLE public.platform_change_logs (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             platform_id uuid NOT NULL,
                                             platform_version_id uuid,
                                             change_type character varying NOT NULL CHECK (change_type::text = ANY (ARRAY['feature'::character varying, 'bugfix'::character varying, 'improvement'::character varying, 'security'::character varying, 'performance'::character varying, 'deprecation'::character varying, 'breaking'::character varying, 'documentation'::character varying]::text[])),
  change_category character varying,
  title character varying NOT NULL,
  description text,
  breaking_change boolean DEFAULT false,
  migration_required boolean DEFAULT false,
  migration_notes text,
  affected_modules ARRAY,
  affected_features ARRAY,
  commit_hash character varying,
  pull_request_url text,
  issue_url text,
  author character varying,
  published_at timestamp with time zone DEFAULT now(),
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  active boolean,
  CONSTRAINT platform_change_logs_pkey PRIMARY KEY (id),
  CONSTRAINT platform_change_logs_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT platform_change_logs_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT platform_change_logs_updated_by_fkey1 FOREIGN KEY (updated_by) REFERENCES public.profiles(id),
  CONSTRAINT platform_change_logs_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
  CONSTRAINT platform_change_logs_platform_version_id_fkey FOREIGN KEY (platform_version_id) REFERENCES public.platform_versions(id)
);
CREATE TABLE public.platform_configurations (
                                                id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                config_key character varying NOT NULL UNIQUE,
                                                config_value jsonb NOT NULL,
                                                description text,
                                                is_encrypted boolean DEFAULT false,
                                                is_public boolean DEFAULT false,
                                                version integer DEFAULT 1,
                                                created_at timestamp with time zone DEFAULT now(),
                                                updated_at timestamp with time zone DEFAULT now(),
                                                updated_by uuid,
                                                platform_id uuid,
                                                created_by uuid,
                                                CONSTRAINT platform_configurations_pkey PRIMARY KEY (id),
                                                CONSTRAINT platform_configurations_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                                CONSTRAINT platform_configurations_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id)
);
CREATE TABLE public.platform_costs (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       platform_id uuid NOT NULL,
                                       platform_budget_id uuid,
                                       cost_type character varying NOT NULL,
                                       cost_category character varying NOT NULL CHECK (cost_category::text = ANY (ARRAY['development'::character varying, 'infrastructure'::character varying, 'marketing'::character varying, 'support'::character varying, 'licensing'::character varying, 'training'::character varying, 'consulting'::character varying, 'hardware'::character varying, 'software'::character varying, 'cloud'::character varying, 'other'::character varying]::text[])),
  amount numeric NOT NULL CHECK (amount > 0::numeric),
  currency character varying DEFAULT 'TRY'::character varying,
  cost_date date NOT NULL DEFAULT CURRENT_DATE,
  description text NOT NULL,
  vendor character varying,
  invoice_number character varying,
  invoice_url text,
  payment_status character varying DEFAULT 'pending'::character varying CHECK (payment_status::text = ANY (ARRAY['pending'::character varying, 'paid'::character varying, 'overdue'::character varying, 'cancelled'::character varying, 'refunded'::character varying]::text[])),
  paid_at timestamp with time zone,
  is_recurring boolean DEFAULT false,
  recurrence_interval character varying CHECK (recurrence_interval IS NULL OR (recurrence_interval::text = ANY (ARRAY['daily'::character varying, 'weekly'::character varying, 'monthly'::character varying, 'quarterly'::character varying, 'yearly'::character varying]::text[]))),
  recurrence_end_date date,
  allocation_percentage numeric DEFAULT 100 CHECK (allocation_percentage > 0::numeric AND allocation_percentage <= 100::numeric),
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  active boolean,
  CONSTRAINT platform_costs_pkey PRIMARY KEY (id),
  CONSTRAINT platform_costs_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT platform_costs_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
  CONSTRAINT platform_costs_platform_budget_id_fkey FOREIGN KEY (platform_budget_id) REFERENCES public.platform_budgets(id)
);
CREATE TABLE public.platform_dependencies (
                                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                                              platform_id uuid NOT NULL,
                                              depends_on_platform_id uuid NOT NULL,
                                              dependency_type character varying NOT NULL DEFAULT 'required'::character varying CHECK (dependency_type::text = ANY (ARRAY['required'::character varying, 'optional'::character varying, 'recommended'::character varying, 'conflicts'::character varying]::text[])),
                                              min_version character varying,
                                              max_version character varying,
                                              recommended_version character varying,
                                              active boolean DEFAULT true,
                                              description text,
                                              created_at timestamp with time zone DEFAULT now(),
                                              updated_at timestamp with time zone DEFAULT now(),
                                              created_by uuid,
                                              updated_by uuid,
                                              CONSTRAINT platform_dependencies_pkey PRIMARY KEY (id),
                                              CONSTRAINT platform_dependencies_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                              CONSTRAINT platform_dependencies_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                              CONSTRAINT platform_dependencies_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                              CONSTRAINT platform_dependencies_depends_on_platform_id_fkey FOREIGN KEY (depends_on_platform_id) REFERENCES public.platforms(id)
);
CREATE TABLE public.platform_features (
                                          id uuid NOT NULL DEFAULT gen_random_uuid(),
                                          feature_key character varying NOT NULL UNIQUE,
                                          feature_name character varying NOT NULL,
                                          description text,
                                          active boolean DEFAULT false,
                                          rollout_percentage integer DEFAULT 0 CHECK (rollout_percentage >= 0 AND rollout_percentage <= 100),
                                          rollout_type character varying DEFAULT 'percentage'::character varying CHECK (rollout_type::text = ANY (ARRAY['percentage'::character varying, 'whitelist'::character varying, 'blacklist'::character varying, 'plans'::character varying, 'all'::character varying]::text[])),
                                          target_plan_codes ARRAY,
                                          target_tenant_ids ARRAY,
                                          target_criteria jsonb,
                                          created_at timestamp with time zone DEFAULT now(),
                                          updated_at timestamp with time zone DEFAULT now(),
                                          enabled_at timestamp with time zone,
                                          disabled_at timestamp with time zone,
                                          platform_id uuid,
                                          created_by uuid,
                                          updated_by uuid,
                                          CONSTRAINT platform_features_pkey PRIMARY KEY (id),
                                          CONSTRAINT platform_features_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                          CONSTRAINT platform_features_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                          CONSTRAINT platform_features_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.platform_files (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       platform_id uuid NOT NULL,
                                       platform_version_id uuid,
                                       file_type character varying NOT NULL CHECK (file_type::text = ANY (ARRAY['installer'::character varying, 'binary'::character varying, 'documentation'::character varying, 'api_spec'::character varying, 'changelog'::character varying, 'license'::character varying, 'readme'::character varying, 'migration_script'::character varying, 'backup'::character varying, 'configuration'::character varying, 'asset'::character varying, 'other'::character varying]::text[])),
  file_category character varying,
  file_name character varying NOT NULL,
  file_size bigint,
  file_path text,
  file_url text,
  storage_provider character varying DEFAULT 'supabase'::character varying CHECK (storage_provider::text = ANY (ARRAY['supabase'::character varying, 's3'::character varying, 'azure'::character varying, 'gcs'::character varying, 'local'::character varying, 'cdn'::character varying]::text[])),
  storage_bucket character varying,
  storage_path text,
  md5_hash character varying,
  sha256_hash character varying,
  mime_type character varying,
  description text,
  is_public boolean DEFAULT false,
  download_count integer DEFAULT 0,
  last_downloaded_at timestamp with time zone,
  version character varying,
  is_latest boolean DEFAULT true,
  uploaded_by uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  CONSTRAINT platform_files_pkey PRIMARY KEY (id),
  CONSTRAINT platform_files_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT platform_files_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT platform_files_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
  CONSTRAINT platform_files_platform_version_id_fkey FOREIGN KEY (platform_version_id) REFERENCES public.platform_versions(id)
);
CREATE TABLE public.platform_licenses (
                                          id uuid NOT NULL DEFAULT gen_random_uuid(),
                                          platform_id uuid NOT NULL,
                                          license_type character varying NOT NULL CHECK (license_type::text = ANY (ARRAY['commercial'::character varying, 'trial'::character varying, 'development'::character varying, 'enterprise'::character varying, 'oem'::character varying, 'opensource'::character varying, 'custom'::character varying]::text[])),
  license_key text,
  issued_at timestamp with time zone NOT NULL DEFAULT now(),
  expires_at timestamp with time zone,
  is_perpetual boolean DEFAULT false,
  max_tenants integer,
  max_users integer,
  max_installations integer,
  licensed_to character varying,
  organization_name character varying,
  email character varying,
  status character varying DEFAULT 'active'::character varying CHECK (status::text = ANY (ARRAY['active'::character varying, 'expired'::character varying, 'suspended'::character varying, 'revoked'::character varying, 'pending'::character varying]::text[])),
  activation_count integer DEFAULT 0,
  last_activated_at timestamp with time zone,
  notes text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  active boolean,
  CONSTRAINT platform_licenses_pkey PRIMARY KEY (id),
  CONSTRAINT platform_licenses_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT platform_licenses_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT platform_licenses_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id)
);
CREATE TABLE public.platform_metrics (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         metric_date date NOT NULL DEFAULT CURRENT_DATE UNIQUE,
                                         total_tenants integer DEFAULT 0,
                                         active_tenants integer DEFAULT 0,
                                         new_tenants_today integer DEFAULT 0,
                                         churned_tenants_today integer DEFAULT 0,
                                         total_users integer DEFAULT 0,
                                         active_users_today integer DEFAULT 0,
                                         new_users_today integer DEFAULT 0,
                                         total_subscriptions integer DEFAULT 0,
                                         trial_subscriptions integer DEFAULT 0,
                                         active_subscriptions integer DEFAULT 0,
                                         canceled_subscriptions integer DEFAULT 0,
                                         mrr numeric DEFAULT 0,
                                         arr numeric DEFAULT 0,
                                         revenue_today numeric DEFAULT 0,
                                         credits_purchased_today integer DEFAULT 0,
                                         credits_spent_today integer DEFAULT 0,
                                         total_api_calls_today bigint DEFAULT 0,
                                         total_storage_used_gb numeric DEFAULT 0,
                                         created_at timestamp with time zone DEFAULT now(),
                                         platform_id uuid,
                                         created_by uuid,
                                         updated_by uuid,
                                         updated_at timestamp with time zone DEFAULT now(),
                                         CONSTRAINT platform_metrics_pkey PRIMARY KEY (id),
                                         CONSTRAINT platform_metrics_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                         CONSTRAINT platform_metrics_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_metrics_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.platform_modules (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         platform_id uuid NOT NULL,
                                         module_code character varying NOT NULL UNIQUE,
                                         module_name character varying NOT NULL,
                                         description text,
                                         parent_module_id uuid,
                                         active boolean DEFAULT true,
                                         is_required boolean DEFAULT false,
                                         is_beta boolean DEFAULT false,
                                         version character varying,
                                         min_platform_version character varying,
                                         max_platform_version character varying,
                                         icon_url text,
                                         display_order integer DEFAULT 0,
                                         category character varying,
                                         entrypoint character varying,
                                         configuration jsonb,
                                         created_at timestamp with time zone DEFAULT now(),
                                         updated_at timestamp with time zone DEFAULT now(),
                                         is_active boolean,
                                         created_by uuid,
                                         updated_by uuid,
                                         CONSTRAINT platform_modules_pkey PRIMARY KEY (id),
                                         CONSTRAINT platform_modules_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_modules_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_modules_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                         CONSTRAINT platform_modules_parent_module_id_fkey FOREIGN KEY (parent_module_id) REFERENCES public.platform_modules(id)
);
CREATE TABLE public.platform_tenants (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         platform_id uuid NOT NULL,
                                         tenant_id uuid NOT NULL,
                                         active boolean DEFAULT true,
                                         is_trial boolean DEFAULT false,
                                         subscribed_at timestamp with time zone DEFAULT now(),
                                         trial_starts_at timestamp with time zone,
                                         trial_ends_at timestamp with time zone,
                                         expires_at timestamp with time zone,
                                         locked_version_id uuid,
                                         auto_upgrade boolean DEFAULT true,
                                         custom_limits jsonb,
                                         activated_by uuid,
                                         deactivated_at timestamp with time zone,
                                         deactivated_by uuid,
                                         deactivation_reason text,
                                         created_at timestamp with time zone DEFAULT now(),
                                         updated_at timestamp with time zone DEFAULT now(),
                                         created_by uuid,
                                         updated_by uuid,
                                         CONSTRAINT platform_tenants_pkey PRIMARY KEY (id),
                                         CONSTRAINT platform_tenants_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_tenants_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                         CONSTRAINT platform_tenants_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
                                         CONSTRAINT platform_tenants_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                         CONSTRAINT platform_tenants_locked_version_id_fkey FOREIGN KEY (locked_version_id) REFERENCES public.platform_versions(id)
);
CREATE TABLE public.platform_versions (
                                          id uuid NOT NULL DEFAULT gen_random_uuid(),
                                          version_number character varying NOT NULL UNIQUE CHECK (version_number::text ~ '^\d+\.\d+\.\d+$'::text),
  version_name character varying,
  release_date timestamp with time zone NOT NULL,
  release_notes text,
  changelog text,
  active boolean DEFAULT true,
  is_current boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  platform_id uuid,
  created_by uuid,
  updated_by uuid,
  CONSTRAINT platform_versions_pkey PRIMARY KEY (id),
  CONSTRAINT platform_versions_platform_id_fkey FOREIGN KEY (platform_id) REFERENCES public.platforms(id),
  CONSTRAINT platform_versions_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT platform_versions_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.platforms (
                                  id uuid NOT NULL DEFAULT gen_random_uuid(),
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('platform_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  display_name character varying,
                                  slug character varying,
                                  icon_url text,
                                  color character varying,
                                  status character varying DEFAULT 'active'::character varying CHECK (status::text = ANY (ARRAY['active'::character varying, 'deprecated'::character varying, 'maintenance'::character varying, 'beta'::character varying, 'alpha'::character varying, 'archived'::character varying]::text[])),
                                  platform_type character varying DEFAULT 'application'::character varying CHECK (platform_type::text = ANY (ARRAY['application'::character varying, 'module'::character varying, 'service'::character varying, 'integration'::character varying, 'framework'::character varying]::text[])),
                                  is_core boolean DEFAULT false,
                                  display_order integer DEFAULT 0,
                                  metadata jsonb DEFAULT '{}'::jsonb,
                                  CONSTRAINT platforms_pkey PRIMARY KEY (id)
);
CREATE TABLE public.preference_types (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('preference_type_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         code character varying,
                                         description character varying,
                                         name character varying,
                                         CONSTRAINT preference_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.preferences (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('preference_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    name character varying,
                                    value character varying NOT NULL,
                                    preference_type_id uuid NOT NULL,
                                    profile_id uuid DEFAULT gen_random_uuid(),
                                    CONSTRAINT preferences_pkey PRIMARY KEY (id),
                                    CONSTRAINT fkeeyrm28raswf0w4emc0kjr2wa FOREIGN KEY (preference_type_id) REFERENCES public.preference_types(id)
);
CREATE TABLE public.priorities (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL DEFAULT nextval('priority_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   code character varying,
                                   color character varying,
                                   description character varying,
                                   level integer,
                                   name character varying,
                                   CONSTRAINT priorities_pkey PRIMARY KEY (id)
);
CREATE TABLE public.product_characteristics (
                                                id uuid NOT NULL,
                                                active boolean,
                                                created_by uuid,
                                                created_at timestamp with time zone,
                                                row_id integer NOT NULL DEFAULT nextval('product_characteristic_row_id_seq'::regclass),
                                                updated_by uuid,
                                                updated_at timestamp with time zone,
                                                value text,
                                                characteristic_id uuid,
                                                item_id uuid,
                                                row_number integer,
                                                CONSTRAINT product_characteristics_pkey PRIMARY KEY (id),
                                                CONSTRAINT fk_product_char_characteristic FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                                CONSTRAINT fk_product_char_product FOREIGN KEY (item_id) REFERENCES public.items(id)
);
CREATE TABLE public.production_characteristics (
                                                   id uuid NOT NULL,
                                                   active boolean,
                                                   created_by uuid,
                                                   created_at timestamp with time zone,
                                                   row_id integer NOT NULL DEFAULT nextval('production_characteristic_row_id_seq'::regclass),
                                                   updated_by uuid,
                                                   updated_at timestamp with time zone,
                                                   value text,
                                                   characteristic_id uuid,
                                                   production_id uuid,
                                                   CONSTRAINT production_characteristics_pkey PRIMARY KEY (id),
                                                   CONSTRAINT fk_prod_char_characteristic FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                                   CONSTRAINT fk_prod_char_production FOREIGN KEY (production_id) REFERENCES public.productions(id)
);
CREATE TABLE public.production_orders (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('production_order_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          code character varying,
                                          description character varying,
                                          name character varying,
                                          external_identifier character varying,
                                          quantity double precision,
                                          status character varying CHECK (status::text = ANY (ARRAY['CREATED'::character varying::text, 'PRODUCTION'::character varying::text])),
  tenant_id uuid,
  blueprint_id uuid,
  confirmation_id uuid UNIQUE,
  inventory_id uuid,
  work_request_id uuid,
  CONSTRAINT production_orders_pkey PRIMARY KEY (id),
  CONSTRAINT fk9x8gijbqorfqxatqxnnp0n2pm FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
  CONSTRAINT fkeb1x45vvgrqxbeclbkxxlowkh FOREIGN KEY (inventory_id) REFERENCES public.inventories(id),
  CONSTRAINT fki1d7jc5535215o1grjsq4kjrn FOREIGN KEY (confirmation_id) REFERENCES public.confirmations(id),
  CONSTRAINT fkpgcet2ka5wvfikky3ths870we FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.productions (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('production_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    description character varying,
                                    name character varying,
                                    production_method character varying CHECK (production_method::text = ANY (ARRAY['AUTOMATIC'::character varying::text, 'MANUAL'::character varying::text])),
  quantity double precision,
  remote_id uuid,
  status character varying CHECK (status::text = ANY (ARRAY['CHECKING'::character varying::text, 'WAITING'::character varying::text, 'STARTED'::character varying::text, 'IN_PROGRESS'::character varying::text, 'PAUSED'::character varying::text, 'DONE'::character varying::text, 'PUBLISHED'::character varying::text])),
  tenant_id uuid,
  blueprint_id uuid,
  business_interaction_id uuid,
  confirmation_id uuid,
  production_order_id uuid,
  approved_production_at timestamp with time zone,
  finish_production_at timestamp with time zone,
  blueprint uuid DEFAULT gen_random_uuid(),
  business_interaction uuid DEFAULT gen_random_uuid(),
  confirmation uuid DEFAULT gen_random_uuid(),
  production_order uuid DEFAULT gen_random_uuid(),
  CONSTRAINT productions_pkey PRIMARY KEY (id),
  CONSTRAINT fk_production_production_order FOREIGN KEY (production_order_id) REFERENCES public.production_orders(id),
  CONSTRAINT fk_production_confirmation FOREIGN KEY (confirmation_id) REFERENCES public.confirmations(id),
  CONSTRAINT productions_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.profiles (
                                 id uuid NOT NULL DEFAULT uuid_generate_v4(),
                                 created_at timestamp with time zone DEFAULT now(),
                                 updated_at timestamp with time zone DEFAULT now(),
                                 username character varying UNIQUE,
                                 full_name character varying,
                                 first_name character varying,
                                 last_name character varying,
                                 avatar_url text,
                                 email character varying NOT NULL UNIQUE,
                                 phone character varying,
                                 bio character varying,
                                 two_factor_enabled boolean DEFAULT false,
                                 active boolean DEFAULT true,
                                 role character varying NOT NULL DEFAULT 'ROLE_USER'::character varying CHECK (role::text = ANY (ARRAY['ROLE_ADMIN'::character varying::text, 'ROLE_MANAGER'::character varying::text, 'ROLE_USER'::character varying::text])),
                                 tenant_id uuid,
                                 created_by uuid,
                                 row_id integer NOT NULL DEFAULT nextval('profiles_row_id_seq'::regclass),
                                 updated_by uuid,
                                 created_by_role character varying,
                                 description character varying,
                                 is_default boolean,
                                 last_login timestamp with time zone,
                                 name character varying,
                                 type character varying,
                                 type_attribute character varying,
                                 CONSTRAINT profiles_pkey PRIMARY KEY (id),
                                 CONSTRAINT fk_profiles_tenant FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.project_contractors (
                                            id uuid NOT NULL,
                                            active boolean,
                                            created_by uuid,
                                            created_at timestamp with time zone,
                                            row_id integer NOT NULL DEFAULT nextval('project_contractor_row_id_seq'::regclass),
                                            updated_by uuid,
                                            updated_at timestamp with time zone,
                                            contractor_id uuid,
                                            project_work_request_id uuid,
                                            CONSTRAINT project_contractors_pkey PRIMARY KEY (id),
                                            CONSTRAINT fkmh1p5b1c3ll5rtpwk3cw3yi6a FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                            CONSTRAINT fkr9bty8ddrspxvfdq9amq1tyh6 FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id)
);
CREATE TABLE public.project_staffs (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('project_staff_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       project_work_request_id uuid,
                                       staff_id uuid,
                                       CONSTRAINT project_staffs_pkey PRIMARY KEY (id),
                                       CONSTRAINT fkb24ihy4y2vvnfcqb7fnr1le9u FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
                                       CONSTRAINT fkpcwa733c10xpg75363ioloyg8 FOREIGN KEY (staff_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.project_sub_contractors (
                                                id uuid NOT NULL,
                                                active boolean,
                                                created_by uuid,
                                                created_at timestamp with time zone,
                                                row_id integer NOT NULL DEFAULT nextval('project_sub_contractor_row_id_seq'::regclass),
                                                updated_by uuid,
                                                updated_at timestamp with time zone,
                                                workflow_project_work_request_id uuid,
                                                sub_contractor_id uuid,
                                                CONSTRAINT project_sub_contractors_pkey PRIMARY KEY (id),
                                                CONSTRAINT fksmsvrjqm0wjsgb07mewuj3bio FOREIGN KEY (workflow_project_work_request_id) REFERENCES public.projects(work_request_id),
                                                CONSTRAINT fkt91v2xsbgc8s13ba2b63n1eh0 FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id)
);
CREATE TABLE public.project_teams (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('project_team_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      project_work_request_id uuid,
                                      team_id uuid,
                                      CONSTRAINT project_teams_pkey PRIMARY KEY (id),
                                      CONSTRAINT fkj2qskv985hwj820nc8g5tbkpl FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
                                      CONSTRAINT fklm3rkt1l272mv694v18cojjuj FOREIGN KEY (team_id) REFERENCES public.teams(id)
);
CREATE TABLE public.project_units (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('project_unit_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      project_work_request_id uuid,
                                      unit_id uuid,
                                      CONSTRAINT project_units_pkey PRIMARY KEY (id),
                                      CONSTRAINT fkoyrnp6qxwqmnf1lccyp4bxiu0 FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
                                      CONSTRAINT fktwtmoichpkw2bu1vm27gk86h FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.projects (
                                 active boolean,
                                 created_by uuid,
                                 created_at timestamp with time zone,
                                 row_id integer NOT NULL DEFAULT nextval('project_row_id_seq'::regclass),
                                 updated_by uuid,
                                 updated_at timestamp with time zone,
                                 code character varying,
                                 address character varying,
                                 directions character varying,
                                 email character varying,
                                 fax character varying,
                                 first_name character varying,
                                 last_name character varying,
                                 phone character varying,
                                 town character varying,
                                 website character varying,
                                 description character varying,
                                 name character varying,
                                 work_request_id uuid NOT NULL,
                                 tenant_id uuid,
                                 organization_id uuid,
                                 location_id uuid,
                                 city_id integer,
                                 country_id character varying,
                                 CONSTRAINT projects_pkey PRIMARY KEY (work_request_id),
                                 CONSTRAINT fk7lnalkti45ptcq9no5n99mlfn FOREIGN KEY (location_id) REFERENCES public.locations(id),
                                 CONSTRAINT fkdq6mb3e67w5yb0ifer19jfjbc FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
                                 CONSTRAINT fkgjipwrxiwpbnbhl0ttwoh5xrw FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                 CONSTRAINT fklmtp60k9wxuigi7annd4sj6hv FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                 CONSTRAINT projects_city_id_fkey FOREIGN KEY (city_id) REFERENCES public.cities(id),
                                 CONSTRAINT projects_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id)
);
CREATE TABLE public.protocol_types (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('protocol_type_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       code character varying,
                                       description character varying,
                                       name character varying,
                                       CONSTRAINT protocol_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.provider_device_info_histories (
                                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                       provider_id uuid NOT NULL,
                                                       changed_field character varying NOT NULL,
                                                       old_value text,
                                                       new_value text,
                                                       device_user character varying,
                                                       device_password character varying,
                                                       device_type character varying,
                                                       software_version character varying,
                                                       product_code character varying,
                                                       mac_address character varying,
                                                       protocol_version character varying,
                                                       last_alignment timestamp with time zone,
                                                       device_status integer,
                                                       restore_point text,
                                                       device_local_time bigint,
                                                       device_timezone character varying,
                                                       provider_mac_address character varying,
                                                       provider_sys_version character varying,
                                                       change_type character varying NOT NULL,
                                                       is_critical_change boolean DEFAULT false,
                                                       is_mismatch boolean DEFAULT false,
                                                       ntp_status character varying,
                                                       detected_at timestamp with time zone DEFAULT now(),
                                                       created_by uuid,
                                                       CONSTRAINT provider_device_info_histories_pkey PRIMARY KEY (id),
                                                       CONSTRAINT provider_device_info_history_provider_id_fkey FOREIGN KEY (provider_id) REFERENCES public.providers(id)
);
CREATE TABLE public.provider_device_infos (
                                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                                              provider_id uuid NOT NULL UNIQUE,
                                              device_user character varying,
                                              device_password character varying,
                                              device_type character varying,
                                              software_version character varying,
                                              product_code character varying,
                                              mac_address character varying NOT NULL,
                                              protocol_version character varying,
                                              last_alignment timestamp with time zone,
                                              device_status integer,
                                              restore_point text,
                                              device_local_time bigint,
                                              device_timezone character varying,
                                              provider_mac_address character varying,
                                              provider_sys_version character varying,
                                              mac_mismatch boolean DEFAULT false,
                                              version_mismatch boolean DEFAULT false,
                                              is_ntp_synced boolean DEFAULT false,
                                              ntp_drift_seconds integer,
                                              response_time_ms integer,
                                              is_reachable boolean DEFAULT true,
                                              consecutive_failures integer DEFAULT 0,
                                              created_at timestamp with time zone DEFAULT now(),
                                              updated_at timestamp with time zone DEFAULT now(),
                                              created_by uuid,
                                              updated_by uuid,
                                              CONSTRAINT provider_device_infos_pkey PRIMARY KEY (id),
                                              CONSTRAINT provider_device_info_provider_id_fkey FOREIGN KEY (provider_id) REFERENCES public.providers(id)
);
CREATE TABLE public.provider_monitoring_configs (
                                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                    provider_id uuid NOT NULL UNIQUE,
                                                    monitoring_enabled boolean DEFAULT true,
                                                    check_interval_minutes integer DEFAULT 15,
                                                    track_software_version boolean DEFAULT true,
                                                    track_mac_address boolean DEFAULT true,
                                                    track_timezone boolean DEFAULT true,
                                                    track_device_type boolean DEFAULT true,
                                                    track_protocol_version boolean DEFAULT true,
                                                    track_device_status boolean DEFAULT true,
                                                    track_product_code boolean DEFAULT true,
                                                    check_mac_mismatch boolean DEFAULT true,
                                                    check_version_mismatch boolean DEFAULT true,
                                                    ntp_monitoring_enabled boolean DEFAULT true,
                                                    max_ntp_drift_seconds integer DEFAULT 300,
                                                    enable_alarm_integration boolean DEFAULT true,
                                                    create_critical_alarms boolean DEFAULT true,
                                                    create_warning_alarms boolean DEFAULT true,
                                                    life_test_alarm_integration boolean DEFAULT true,
                                                    created_at timestamp with time zone DEFAULT now(),
                                                    updated_at timestamp with time zone DEFAULT now(),
                                                    created_by uuid,
                                                    updated_by uuid,
                                                    CONSTRAINT provider_monitoring_configs_pkey PRIMARY KEY (id),
                                                    CONSTRAINT provider_monitoring_config_provider_id_fkey FOREIGN KEY (provider_id) REFERENCES public.providers(id)
);
CREATE TABLE public.provider_preferences (
                                             provider_id uuid NOT NULL,
                                             preference_id uuid NOT NULL,
                                             CONSTRAINT fk15r4kgg3uuqsc9v9cre3gldvu FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                                             CONSTRAINT fknuvhc2mtvor676ms8t57ix89x FOREIGN KEY (preference_id) REFERENCES public.preferences(id)
);
CREATE TABLE public.providers (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('provider_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  app_version character varying,
                                  color character varying,
                                  configuration_time timestamp with time zone,
                                  ftp_client_password character varying,
                                  ftp_client_username character varying,
                                  ftp_password character varying,
                                  ftp_username character varying,
                                  http_password character varying,
                                  http_username character varying,
                                  first_communication_time timestamp with time zone,
                                  first_connection_time timestamp with time zone,
                                  first_data_alignment_time timestamp with time zone,
                                  first_synchronization_time timestamp with time zone,
                                  has_alarm boolean,
                                  hostname character varying,
                                  image_path character varying,
                                  ip character varying,
                                  ip_code character varying,
                                  last_communication_time timestamp with time zone,
                                  last_connection_time timestamp with time zone,
                                  last_data_alignment_time timestamp with time zone,
                                  last_synchronization_time timestamp with time zone,
                                  life_test boolean,
                                  address character varying,
                                  city character varying,
                                  country character varying,
                                  latitude double precision,
                                  longitude double precision,
                                  town character varying,
                                  zoom integer,
                                  mac character varying,
                                  password character varying,
                                  proxy_prefix character varying,
                                  sys_version character varying,
                                  uptime character varying,
                                  tenant_id uuid,
                                  area_id uuid,
                                  brand_id uuid NOT NULL,
                                  device_id uuid,
                                  language_id uuid NOT NULL,
                                  marker_id uuid NOT NULL,
                                  protocol_type_id uuid NOT NULL,
                                  site_id uuid NOT NULL,
                                  supervisor_type_id uuid NOT NULL,
                                  unit_id uuid,
                                  device_item_id uuid,
                                  inventory_item_id uuid UNIQUE,
                                  CONSTRAINT providers_pkey PRIMARY KEY (id),
                                  CONSTRAINT fk2im01q7hko5y6juxdyx2b8h09 FOREIGN KEY (area_id) REFERENCES public.areas(id),
                                  CONSTRAINT fk39jguig1ea98q4vlhae0vvlpj FOREIGN KEY (language_id) REFERENCES public.languages(id),
                                  CONSTRAINT fk3sgury3lp4cw84kttiv944tgt FOREIGN KEY (site_id) REFERENCES public.sites(id),
                                  CONSTRAINT fkg95y919myw0ol6un6ruh975dj FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                  CONSTRAINT fkjgi011w9xcnvu3hn4rvej5r0i FOREIGN KEY (supervisor_type_id) REFERENCES public.supervisor_types(id),
                                  CONSTRAINT fkjvwtyokwa0a7m9nh665mx41xo FOREIGN KEY (protocol_type_id) REFERENCES public.protocol_types(id),
                                  CONSTRAINT fkkpvnrinjdygu6iofxewqrtp8e FOREIGN KEY (marker_id) REFERENCES public.markers(id),
                                  CONSTRAINT fkqj39li43fabye4lw7g53910hx FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                  CONSTRAINT fkrp6n76gikcg86g1332q7sy8ut FOREIGN KEY (device_id) REFERENCES public.devices(id),
                                  CONSTRAINT fktlbedvnhn2awumhvl080lcr1x FOREIGN KEY (unit_id) REFERENCES public.units(id),
                                  CONSTRAINT fkok6lwddv2wy2v6bo6tolq0nko FOREIGN KEY (device_item_id) REFERENCES public.items(id),
                                  CONSTRAINT fkgrm8gq37gsnil6p6u3vulogcg FOREIGN KEY (inventory_item_id) REFERENCES public.inventory_items(id)
);
CREATE TABLE public.query_limits (
                                     id uuid NOT NULL DEFAULT gen_random_uuid(),
                                     table_name character varying NOT NULL UNIQUE,
                                     max_limit integer NOT NULL DEFAULT 50000,
                                     default_limit integer NOT NULL DEFAULT 1000,
                                     created_at timestamp with time zone DEFAULT now(),
                                     updated_at timestamp with time zone DEFAULT now(),
                                     CONSTRAINT query_limits_pkey PRIMARY KEY (id)
);
CREATE TABLE public.ratings (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('rating_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                tenant_id uuid,
                                CONSTRAINT ratings_pkey PRIMARY KEY (id),
                                CONSTRAINT fki1ott1wlchryn7k7afsbontr2 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.realm_user_required_actions (
                                                    realm_user uuid NOT NULL,
                                                    required_action character varying,
                                                    CONSTRAINT fkebx0bd8vvp8v7r77ctsqa352b FOREIGN KEY (realm_user) REFERENCES public.realm_users(id)
);
CREATE TABLE public.realm_users (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('realm_user_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    key character varying,
                                    value character varying,
                                    client character varying,
                                    email character varying,
                                    email_validated boolean,
                                    first_name character varying,
                                    image_path character varying,
                                    is_enabled boolean,
                                    is_temporary boolean,
                                    is_verified_email boolean,
                                    last_name character varying,
                                    locale character varying,
                                    old_password character varying,
                                    password character varying,
                                    phone_validated boolean,
                                    realm character varying,
                                    realm_user_id uuid,
                                    role character varying,
                                    theme_type character varying,
                                    user_id uuid,
                                    username character varying,
                                    consumer uuid,
                                    contractor uuid,
                                    profile uuid,
                                    sub_contractor uuid,
                                    tenant_id uuid,
                                    CONSTRAINT realm_users_pkey PRIMARY KEY (id),
                                    CONSTRAINT fkc219uxqb7gfo3pa07ei2o0kho FOREIGN KEY (consumer) REFERENCES public.organizations(id),
                                    CONSTRAINT fkehq2muksnnwv6b5jlajw9eeec FOREIGN KEY (sub_contractor) REFERENCES public.sub_contractors(id),
                                    CONSTRAINT fkj8gh1yfu412tm8fp972n98tt FOREIGN KEY (contractor) REFERENCES public.contractors(id),
                                    CONSTRAINT fkc3opnu0m34015yfhvy0hgealw FOREIGN KEY (profile) REFERENCES public.profiles(id),
                                    CONSTRAINT realm_users_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.realtimes (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('realtime_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  is_loggable boolean,
                                  name character varying,
                                  cancelled_controller_id uuid,
                                  controller_id uuid,
                                  device_model_id uuid,
                                  priority_id uuid,
                                  variable_id uuid,
                                  tenant_id uuid,
                                  CONSTRAINT realtimes_pkey PRIMARY KEY (id),
                                  CONSTRAINT fkgk6ti2fej239x38vemvaf8stq FOREIGN KEY (priority_id) REFERENCES public.priorities(id),
                                  CONSTRAINT fkluxy163p05uwqpl94rgpo8snn FOREIGN KEY (variable_id) REFERENCES public.variables(id),
                                  CONSTRAINT fkoa28vdt3atm2cp64xckpmps9s FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
                                  CONSTRAINT fkqk2q1pvfr3yb175pk6qklmb1b FOREIGN KEY (cancelled_controller_id) REFERENCES public.cancelled_controllers(id),
                                  CONSTRAINT fkrbhit6vnj1gdp71wvr6055uwd FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                                  CONSTRAINT realtimes_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.report_fields (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('report_field_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      code character varying,
                                      description character varying,
                                      name character varying,
                                      report_type_id uuid,
                                      CONSTRAINT report_fields_pkey PRIMARY KEY (id),
                                      CONSTRAINT fkplrm1f1m2wqoopii8dcr573ic FOREIGN KEY (report_type_id) REFERENCES public.report_types(id)
);
CREATE TABLE public.report_template_controllers (
                                                    reporttemplate_id uuid NOT NULL,
                                                    controller_id uuid NOT NULL,
                                                    CONSTRAINT fkauoskc7lodf04hvbd7gjqo8l2 FOREIGN KEY (reporttemplate_id) REFERENCES public.report_templates(id),
                                                    CONSTRAINT fkklgu4h3mncavfe4n3pchvyer8 FOREIGN KEY (controller_id) REFERENCES public.controllers(id)
);
CREATE TABLE public.report_template_realtimes (
                                                  report_template_id uuid NOT NULL,
                                                  realtime_id uuid NOT NULL,
                                                  CONSTRAINT fkn4vrr48ijhlk3rnl12rgccaro FOREIGN KEY (realtime_id) REFERENCES public.realtimes(id),
                                                  CONSTRAINT fkpn63vce1fsk7lx0kamf6hds8u FOREIGN KEY (report_template_id) REFERENCES public.report_templates(id)
);
CREATE TABLE public.report_template_variables (
                                                  reporttemplate_id uuid NOT NULL,
                                                  variable_id uuid NOT NULL,
                                                  CONSTRAINT fklsa050815ru1bpnpbkhsv3ie7 FOREIGN KEY (reporttemplate_id) REFERENCES public.report_templates(id),
                                                  CONSTRAINT fkrxrdhh15hls0hl4535q2q2qp6 FOREIGN KEY (variable_id) REFERENCES public.variables(id)
);
CREATE TABLE public.report_templates (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('report_template_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         controller_id character varying,
                                         provider_id character varying,
                                         site_id character varying,
                                         code character varying,
                                         description character varying,
                                         frequency integer,
                                         high_threshold integer,
                                         is_kpi_group boolean,
                                         low_threshold integer,
                                         max_high_threshold_percentage integer,
                                         max_low_threshold_percentage integer,
                                         name character varying,
                                         period character varying,
                                         controller uuid,
                                         provider uuid,
                                         report_type_id uuid,
                                         site uuid,
                                         tenant_id uuid NOT NULL,
                                         CONSTRAINT report_templates_pkey PRIMARY KEY (id),
                                         CONSTRAINT fk198jqt06nhsxbte0loes4615 FOREIGN KEY (report_type_id) REFERENCES public.report_types(id),
                                         CONSTRAINT fk221iet5x0vd2ufp4edcbuh1tj FOREIGN KEY (provider) REFERENCES public.providers(id),
                                         CONSTRAINT fk2j61ifm5k2mgwvjklcux3264e FOREIGN KEY (site) REFERENCES public.sites(id),
                                         CONSTRAINT fkfyt29539xvogld8t57wbxx5wp FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                         CONSTRAINT fksyw0y02h1p3k27wisu9clmwrx FOREIGN KEY (controller) REFERENCES public.controllers(id)
);
CREATE TABLE public.report_types (
                                     id uuid NOT NULL,
                                     active boolean,
                                     created_by uuid,
                                     created_at timestamp with time zone,
                                     row_id integer NOT NULL DEFAULT nextval('report_type_row_id_seq'::regclass),
                                     updated_by uuid,
                                     updated_at timestamp with time zone,
                                     code character varying,
                                     description character varying,
                                     name character varying,
                                     CONSTRAINT report_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.reservation_characteristics (
                                                    id uuid NOT NULL,
                                                    active boolean,
                                                    created_by uuid,
                                                    created_at timestamp with time zone,
                                                    row_id integer NOT NULL DEFAULT nextval('reservation_characteristic_row_id_seq'::regclass),
                                                    updated_by uuid,
                                                    updated_at timestamp with time zone,
                                                    value character varying,
                                                    characteristic_id uuid,
                                                    reservation_id uuid,
                                                    CONSTRAINT reservation_characteristics_pkey PRIMARY KEY (id),
                                                    CONSTRAINT fk4qfc9q2r2bl8koor7vrksm168 FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                                    CONSTRAINT fkr8vb0buo628ugad0qpq1hu7ib FOREIGN KEY (reservation_id) REFERENCES public.reservations(id)
);
CREATE TABLE public.reservation_items (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('reservation_item_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          quantity double precision,
                                          item_id uuid,
                                          reservation_id uuid,
                                          CONSTRAINT reservation_items_pkey PRIMARY KEY (id),
                                          CONSTRAINT fkh7daoyl0195hd2e9e3773b5wq FOREIGN KEY (reservation_id) REFERENCES public.reservations(id),
                                          CONSTRAINT fk9gl16cpbc2rvc72hpvfhasas2 FOREIGN KEY (item_id) REFERENCES public.items(id)
);
CREATE TABLE public.reservation_units (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('reservation_unit_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          reservation_id uuid,
                                          unit_id uuid,
                                          CONSTRAINT reservation_units_pkey PRIMARY KEY (id),
                                          CONSTRAINT fk4dthqdmhe1inemqhj246iuqem FOREIGN KEY (unit_id) REFERENCES public.units(id),
                                          CONSTRAINT fkjc9hple43j2i5utf2mt803lit FOREIGN KEY (reservation_id) REFERENCES public.reservations(id)
);
CREATE TABLE public.reservations (
                                     id uuid NOT NULL,
                                     active boolean,
                                     created_by uuid,
                                     created_at timestamp with time zone,
                                     row_id integer NOT NULL DEFAULT nextval('reservation_row_id_seq'::regclass),
                                     updated_by uuid,
                                     updated_at timestamp with time zone,
                                     address character varying,
                                     directions character varying,
                                     email character varying,
                                     fax character varying,
                                     first_name character varying,
                                     last_name character varying,
                                     phone character varying,
                                     town character varying,
                                     website character varying,
                                     end_time timestamp with time zone,
                                     start_time timestamp with time zone,
                                     status character varying CHECK (status::text = ANY (ARRAY['PREPARING'::character varying::text, 'CREATED'::character varying::text, 'VERIFIED'::character varying::text, 'ACCEPTED'::character varying::text, 'WAITING'::character varying::text, 'CHECKEDIN'::character varying::text, 'IGNORED'::character varying::text, 'COMPLETED'::character varying::text, 'CANCELED'::character varying::text])),
  tenant_id uuid,
  customer_id uuid,
  inventory_id uuid,
  period_id uuid,
  city_id integer,
  country_id character varying,
  CONSTRAINT reservations_pkey PRIMARY KEY (id),
  CONSTRAINT fk9btf4wa06m9ysc4ugn6gy5yb9 FOREIGN KEY (inventory_id) REFERENCES public.inventories(id),
  CONSTRAINT fkjw69j4fx60yix8mh68dw3xd1t FOREIGN KEY (period_id) REFERENCES public.periods(id),
  CONSTRAINT fkmvt73eeifd3fkpe055rae1d7y FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fksg8770wfft7ktwtf9r8a6cwos FOREIGN KEY (customer_id) REFERENCES public.customers(id),
  CONSTRAINT reservations_city_id_fkey FOREIGN KEY (city_id) REFERENCES public.cities(id),
  CONSTRAINT reservations_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id)
);
CREATE TABLE public.retail_chains (
                                      id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      active boolean DEFAULT true,
                                      created_by uuid,
                                      created_at timestamp with time zone DEFAULT now(),
                                      updated_by uuid,
                                      updated_at timestamp with time zone DEFAULT now(),
                                      row_id integer NOT NULL DEFAULT nextval('retail_chains_row_id_seq'::regclass),
                                      name character varying NOT NULL,
                                      code character varying UNIQUE,
                                      description text,
                                      api_endpoint character varying,
                                      api_key_encrypted text,
                                      data_format character varying CHECK (data_format::text = ANY (ARRAY['json'::character varying, 'xml'::character varying, 'csv'::character varying]::text[])),
  sync_enabled boolean DEFAULT false,
  last_sync_date timestamp with time zone,
  sync_frequency_hours integer DEFAULT 24,
  logo_url character varying,
  brand_color character varying,
  website character varying,
  tenant_id uuid,
  CONSTRAINT retail_chains_pkey PRIMARY KEY (id),
  CONSTRAINT retail_chains_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.route_locations (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('route_location_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        enter_time timestamp with time zone,
                                        exit_time timestamp with time zone,
                                        position character varying,
                                        position_type character varying CHECK (position_type::text = ANY (ARRAY['START'::character varying::text, 'END'::character varying::text, 'MIDDLE'::character varying::text])),
  tenant_id uuid,
  location_id uuid,
  route_id uuid,
  staff_id uuid UNIQUE,
  team_id uuid UNIQUE,
  CONSTRAINT route_locations_pkey PRIMARY KEY (id),
  CONSTRAINT fk1bo1p9auu02uxa6nskmeextiy FOREIGN KEY (team_id) REFERENCES public.teams(id),
  CONSTRAINT fk2tb9siscwqtu3abh4y5jx9env FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fk6dp2hu4gxecvoogch053wa3yn FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
  CONSTRAINT fk9c3mwskmwup0qnl2d3ed2hyiq FOREIGN KEY (route_id) REFERENCES public.routes(id),
  CONSTRAINT fkq83u14gninmwrf13at4mlgri7 FOREIGN KEY (location_id) REFERENCES public.locations(id)
);
CREATE TABLE public.routes (
                               id uuid NOT NULL,
                               active boolean,
                               created_by uuid,
                               created_at timestamp with time zone,
                               row_id integer NOT NULL DEFAULT nextval('route_row_id_seq'::regclass),
                               updated_by uuid,
                               updated_at timestamp with time zone,
                               tenant_id uuid,
                               project_work_request_id uuid,
                               task_work_request_id uuid,
                               workflow_work_request_id uuid,
                               CONSTRAINT routes_pkey PRIMARY KEY (id),
                               CONSTRAINT fkbekloqjnc3b30ss6uvsli82ue FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
                               CONSTRAINT fkd03wuqvwit2esagq9koslqwfy FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
                               CONSTRAINT fkdkofpspqmpsht2xitmanc1jfd FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                               CONSTRAINT fkth5dtg5qcao83xko9tnxibmva FOREIGN KEY (task_work_request_id) REFERENCES public.tasks(work_request_id)
);
CREATE TABLE public.sale_business_interactions (
                                                   id uuid NOT NULL,
                                                   active boolean,
                                                   created_by uuid,
                                                   created_at timestamp with time zone,
                                                   row_id integer NOT NULL DEFAULT nextval('sale_business_interaction_row_id_seq'::regclass),
                                                   updated_by uuid,
                                                   updated_at timestamp with time zone,
                                                   business_interaction_id uuid,
                                                   deal_id uuid,
                                                   CONSTRAINT sale_business_interactions_pkey PRIMARY KEY (id),
                                                   CONSTRAINT fk6esmvxdtiafw5f5b3ygyno5l6 FOREIGN KEY (deal_id) REFERENCES public.deals(id),
                                                   CONSTRAINT fktrrn9d14hdclrd0uekpipdygq FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id)
);
CREATE TABLE public.sale_item_business_interactions (
                                                        id uuid NOT NULL,
                                                        active boolean,
                                                        created_by uuid,
                                                        created_at timestamp with time zone,
                                                        row_id integer NOT NULL DEFAULT nextval('sale_item_business_interaction_row_id_seq'::regclass),
                                                        updated_by uuid,
                                                        updated_at timestamp with time zone,
                                                        business_interaction_id uuid,
                                                        sale_item_id uuid,
                                                        CONSTRAINT sale_item_business_interactions_pkey PRIMARY KEY (id),
                                                        CONSTRAINT fkdh4bi8g9u8ufiaagwc6ny60hu FOREIGN KEY (sale_item_id) REFERENCES public.sale_items(id),
                                                        CONSTRAINT fkplh0g8ettuvg7vra4cgya88e9 FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id)
);
CREATE TABLE public.sale_items (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL DEFAULT nextval('sale_item_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   item_id uuid,
                                   deal_id uuid,
                                   CONSTRAINT sale_items_pkey PRIMARY KEY (id),
                                   CONSTRAINT fkn11oh21x1ica0nsfyms4ce117 FOREIGN KEY (deal_id) REFERENCES public.deals(id),
                                   CONSTRAINT fk5w6f9ed9ucemqs8ovhwnvylwh FOREIGN KEY (item_id) REFERENCES public.items(id)
);
CREATE TABLE public.scheduled_reports (
                                          id uuid NOT NULL,
                                          active boolean,
                                          created_by uuid,
                                          created_at timestamp with time zone,
                                          row_id integer NOT NULL DEFAULT nextval('scheduled_report_row_id_seq'::regclass),
                                          updated_by uuid,
                                          updated_at timestamp with time zone,
                                          code character varying,
                                          day_of_the_week integer,
                                          description character varying,
                                          email_address character varying,
                                          name character varying,
                                          start_time integer,
                                          report_template_id uuid,
                                          CONSTRAINT scheduled_reports_pkey PRIMARY KEY (id),
                                          CONSTRAINT fka9pvgons9ispltaq5nx2iwmt9 FOREIGN KEY (report_template_id) REFERENCES public.report_templates(id)
);
CREATE TABLE public.sector_contractors (
                                           sector_id uuid NOT NULL,
                                           contractor_id uuid NOT NULL,
                                           CONSTRAINT fk2gtlvkrgjs0mxp6twx9ab8nmk FOREIGN KEY (sector_id) REFERENCES public.sectors(id),
                                           CONSTRAINT fk8krw2bv9gqij57u0m0d4q9eo5 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id)
);
CREATE TABLE public.sector_sub_contractors (
                                               sector_id uuid NOT NULL,
                                               sub_contractor_id uuid NOT NULL,
                                               CONSTRAINT fk2cb4cvv7x5335dfdo1bb5dwek FOREIGN KEY (sector_id) REFERENCES public.sub_contractors(id),
                                               CONSTRAINT fka00995rawhnrq2wp8rc1nmo9n FOREIGN KEY (sub_contractor_id) REFERENCES public.sectors(id),
                                               CONSTRAINT fk9n83ka1275nwwd664w0y9t9cw FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
                                               CONSTRAINT fk60vmhw4i9ict3haa7h9kq5er4 FOREIGN KEY (sector_id) REFERENCES public.sectors(id)
);
CREATE TABLE public.sector_tenants (
                                       tenant_id uuid NOT NULL,
                                       sector_id uuid NOT NULL,
                                       CONSTRAINT fk6n8fa5giclpg7mewel3grwptr FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                       CONSTRAINT fkblkakiykqv9v1hdoh9878smbv FOREIGN KEY (sector_id) REFERENCES public.sectors(id),
                                       CONSTRAINT fk53o6i0lkmlywtr3y6mk5yqmki FOREIGN KEY (sector_id) REFERENCES public.tenants(id),
                                       CONSTRAINT fkgyc2mrj39bs7ysfjn1141n6nk FOREIGN KEY (tenant_id) REFERENCES public.sectors(id)
);
CREATE TABLE public.sectors (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('sector_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                code character varying,
                                description character varying,
                                name character varying,
                                CONSTRAINT sectors_pkey PRIMARY KEY (id)
);
CREATE TABLE public.site_group_memberships (
                                               id uuid NOT NULL DEFAULT gen_random_uuid(),
                                               site_id uuid NOT NULL,
                                               site_group_id uuid NOT NULL,
                                               is_primary boolean DEFAULT false,
                                               valid_from date DEFAULT CURRENT_DATE,
                                               valid_until date,
                                               notes text,
                                               priority integer DEFAULT 0,
                                               active boolean DEFAULT true,
                                               created_at timestamp with time zone DEFAULT now(),
                                               updated_at timestamp with time zone DEFAULT now(),
                                               created_by uuid,
                                               updated_by uuid,
                                               row_id integer NOT NULL DEFAULT nextval('site_group_memberships_row_id_seq'::regclass),
                                               CONSTRAINT site_group_memberships_pkey PRIMARY KEY (id),
                                               CONSTRAINT site_group_memberships_site_id_fkey FOREIGN KEY (site_id) REFERENCES public.sites(id),
                                               CONSTRAINT site_group_memberships_site_group_id_fkey FOREIGN KEY (site_group_id) REFERENCES public.site_groups(id)
);
CREATE TABLE public.site_group_types (
                                         id uuid NOT NULL DEFAULT gen_random_uuid(),
                                         code character varying NOT NULL UNIQUE,
                                         name character varying NOT NULL,
                                         description text,
                                         grouping_criterion_id uuid,
                                         allows_hierarchy boolean DEFAULT false,
                                         max_hierarchy_depth integer DEFAULT 3,
                                         requires_location boolean DEFAULT false,
                                         icon character varying,
                                         color character varying,
                                         display_order integer DEFAULT 0,
                                         active boolean DEFAULT true,
                                         created_at timestamp with time zone DEFAULT now(),
                                         updated_at timestamp with time zone DEFAULT now(),
                                         created_by uuid,
                                         updated_by uuid,
                                         row_id integer NOT NULL DEFAULT nextval('site_group_types_row_id_seq'::regclass),
                                         CONSTRAINT site_group_types_pkey PRIMARY KEY (id),
                                         CONSTRAINT site_group_types_grouping_criterion_id_fkey FOREIGN KEY (grouping_criterion_id) REFERENCES public.categories(id)
);
CREATE TABLE public.site_groups (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('site_group_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    code character varying,
                                    color character varying,
                                    description character varying,
                                    image_path character varying,
                                    address character varying,
                                    city character varying,
                                    country character varying,
                                    latitude double precision,
                                    longitude double precision,
                                    town character varying,
                                    zoom integer,
                                    name character varying,
                                    organization_id uuid NOT NULL,
                                    site_group_type_id uuid,
                                    parent_group_id uuid,
                                    hierarchy_level integer DEFAULT 1,
                                    hierarchy_path character varying,
                                    sort_order integer DEFAULT 0,
                                    CONSTRAINT site_groups_pkey PRIMARY KEY (id),
                                    CONSTRAINT fk4kgc8jw348ey7k14u3o2empgk FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                    CONSTRAINT fk_site_group_type FOREIGN KEY (site_group_type_id) REFERENCES public.site_group_types(id),
                                    CONSTRAINT fk_parent_group FOREIGN KEY (parent_group_id) REFERENCES public.site_groups(id)
);
CREATE TABLE public.site_types (
                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                   code character varying NOT NULL UNIQUE,
                                   name character varying NOT NULL,
                                   description text,
                                   category_id uuid,
                                   auto_create_main_unit boolean DEFAULT true,
                                   default_main_unit_name character varying DEFAULT 'Ana Alan'::character varying,
                                   typical_area_range jsonb,
                                   requires_climate_control boolean DEFAULT false,
                                   requires_energy_monitoring boolean DEFAULT true,
                                   default_kpi_template jsonb,
                                   icon character varying,
                                   color character varying,
                                   display_order integer DEFAULT 0,
                                   active boolean DEFAULT true,
                                   created_at timestamp with time zone DEFAULT now(),
                                   updated_at timestamp with time zone DEFAULT now(),
                                   created_by uuid,
                                   updated_by uuid,
                                   row_id integer NOT NULL DEFAULT nextval('site_types_row_id_seq'::regclass),
                                   CONSTRAINT site_types_pkey PRIMARY KEY (id),
                                   CONSTRAINT site_types_category_id_fkey FOREIGN KEY (category_id) REFERENCES public.categories(id)
);
CREATE TABLE public.sites (
                              id uuid NOT NULL,
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('site_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              code character varying,
                              color character varying,
                              description character varying,
                              image_path character varying,
                              address character varying,
                              city character varying,
                              country character varying,
                              latitude double precision,
                              longitude double precision,
                              town character varying,
                              zoom integer,
                              name character varying,
                              tenant_id uuid,
                              organization_id uuid NOT NULL,
                              marker_id uuid NOT NULL,
                              site_group_id uuid,
                              friday_end_time time without time zone,
                              friday_start_time time without time zone,
                              general_close_time time without time zone,
                              general_open_time time without time zone,
                              working_time_active boolean,
                              monday_end_time time without time zone,
                              monday_start_time time without time zone,
                              saturday_end_time time without time zone,
                              saturday_start_time time without time zone,
                              sunday_end_time time without time zone,
                              sunday_start_time time without time zone,
                              thursday_end_time time without time zone,
                              thursday_start_time time without time zone,
                              tuesday_end_time time without time zone,
                              tuesday_start_time time without time zone,
                              wednesday_end_time time without time zone,
                              wednesday_start_time time without time zone,
                              site_type_id uuid,
                              has_main_unit boolean DEFAULT false,
                              gross_area_sqm numeric CHECK (gross_area_sqm > 0::numeric),
  net_area_sqm numeric CHECK (net_area_sqm > 0::numeric),
  floor_count integer CHECK (floor_count > 0),
  year_built integer CHECK (year_built >= 1900 AND year_built::numeric <= EXTRACT(year FROM CURRENT_DATE)),
  operating_since date,
  climate_zone character varying,
  energy_certificate_class character varying CHECK (energy_certificate_class::text = ANY (ARRAY['A+'::character varying, 'A'::character varying, 'B'::character varying, 'C'::character varying, 'D'::character varying, 'E'::character varying, 'F'::character varying, 'G'::character varying]::text[])),
  CONSTRAINT sites_pkey PRIMARY KEY (id),
  CONSTRAINT fkl32ds7ymuv3u68pu0foxcyy5r FOREIGN KEY (marker_id) REFERENCES public.markers(id),
  CONSTRAINT fkl38iqmphktv0erwkpuskscuhi FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fktoywv2fl4cftjslj2htkkdehj FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
  CONSTRAINT fktqp5m6dni0cm24j8vi25s98q0 FOREIGN KEY (site_group_id) REFERENCES public.site_groups(id),
  CONSTRAINT fk_site_type FOREIGN KEY (site_type_id) REFERENCES public.site_types(id)
);
CREATE TABLE public.staff_organizations (
                                            id uuid NOT NULL,
                                            active boolean,
                                            created_by uuid,
                                            created_at timestamp with time zone,
                                            row_id integer NOT NULL DEFAULT nextval('organization_row_id_seq'::regclass),
                                            updated_by uuid,
                                            updated_at timestamp with time zone,
                                            code character varying,
                                            description character varying,
                                            name character varying,
                                            note character varying,
                                            assigned_to_staff_id uuid,
                                            CONSTRAINT staff_organizations_pkey PRIMARY KEY (id),
                                            CONSTRAINT fkda9ikhnti072e0w08hmbxwa3r FOREIGN KEY (assigned_to_staff_id) REFERENCES public.staffs(id)
);
CREATE TABLE public.staff_types (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('staff_type_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    description character varying,
                                    name character varying,
                                    CONSTRAINT staff_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.staffs (
                               id uuid NOT NULL,
                               active boolean,
                               created_by uuid,
                               created_at timestamp with time zone,
                               row_id integer NOT NULL DEFAULT nextval('staff_row_id_seq'::regclass),
                               updated_by uuid,
                               updated_at timestamp with time zone,
                               code character varying,
                               description character varying,
                               name character varying,
                               user_id uuid,
                               organization_id uuid,
                               contractor_id uuid,
                               rating_id uuid UNIQUE,
                               route_location_id uuid UNIQUE,
                               staff_type_id uuid,
                               sub_contractor_id uuid,
                               tenant_id uuid,
                               address character varying,
                               directions character varying,
                               email character varying,
                               fax character varying,
                               first_name character varying,
                               last_name character varying,
                               phone character varying,
                               town character varying,
                               website character varying,
                               profile_id uuid,
                               city_id integer,
                               country_id character varying,
                               CONSTRAINT staffs_pkey PRIMARY KEY (id),
                               CONSTRAINT fk4vtrokoba3qe1ggh2esj4jkm0 FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                               CONSTRAINT fke0dc3vmw8ghkwupqxcleh7tiw FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
                               CONSTRAINT fkehk4mhojhpvwyppyt1rr5i1mo FOREIGN KEY (staff_type_id) REFERENCES public.staff_types(id),
                               CONSTRAINT fkir3flh2qk3ppdsvgcekaw62d4 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                               CONSTRAINT fkmsllr79ojd8n982u6d8mdkjoh FOREIGN KEY (rating_id) REFERENCES public.ratings(id),
                               CONSTRAINT fkoxa8mrjy97glk0dltj1rei5ci FOREIGN KEY (route_location_id) REFERENCES public.route_locations(id),
                               CONSTRAINT fkrdhh416trl3gqy9gjlhxs2ni2 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                               CONSTRAINT fk3oj9ulsvwikmesw38gc1o3974 FOREIGN KEY (profile_id) REFERENCES public.profiles(id),
                               CONSTRAINT staffs_city_id_fkey FOREIGN KEY (city_id) REFERENCES public.cities(id),
                               CONSTRAINT staffs_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id)
);
CREATE TABLE public.states (
                               id integer NOT NULL DEFAULT nextval('states_id_seq'::regclass),
                               country_id character varying NOT NULL,
                               code character varying,
                               name character varying NOT NULL,
                               type character varying,
                               latitude numeric,
                               longitude numeric,
                               active boolean DEFAULT true,
                               created_at timestamp with time zone DEFAULT now(),
                               updated_at timestamp with time zone DEFAULT now(),
                               CONSTRAINT states_pkey PRIMARY KEY (id),
                               CONSTRAINT states_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id)
);
CREATE TABLE public.step_executions (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        execution_id uuid NOT NULL,
                                        step_id uuid NOT NULL,
                                        status character varying NOT NULL CHECK (status::text = ANY (ARRAY['PENDING'::character varying, 'RUNNING'::character varying, 'COMPLETED'::character varying, 'FAILED'::character varying, 'SKIPPED'::character varying]::text[])),
  started_at timestamp with time zone,
  completed_at timestamp with time zone,
  duration_ms integer,
  input_data jsonb,
  output_data jsonb,
  error_message text,
  error_stack text,
  retry_count integer DEFAULT 0,
  max_retries integer DEFAULT 3,
  execution_order integer,
  active boolean DEFAULT true,
  created_by uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  row_id integer NOT NULL DEFAULT nextval('step_execution_row_id_seq'::regclass),
  CONSTRAINT step_executions_pkey PRIMARY KEY (id),
  CONSTRAINT step_execution_execution_fkey FOREIGN KEY (execution_id) REFERENCES public.workflow_executions(id),
  CONSTRAINT step_execution_step_fkey FOREIGN KEY (step_id) REFERENCES public.business_steps(id)
);
CREATE TABLE public.store_contacts (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       active boolean DEFAULT true,
                                       created_by uuid,
                                       created_at timestamp with time zone DEFAULT now(),
                                       updated_by uuid,
                                       updated_at timestamp with time zone DEFAULT now(),
                                       row_id integer NOT NULL DEFAULT nextval('store_contacts_row_id_seq'::regclass),
                                       contact_type character varying CHECK (contact_type::text = ANY (ARRAY['phone'::character varying, 'fax'::character varying, 'email'::character varying, 'whatsapp'::character varying, 'social_media'::character varying]::text[])),
  contact_value character varying NOT NULL,
  contact_label character varying,
  is_primary boolean DEFAULT false,
  display_order integer DEFAULT 0,
  store_id uuid NOT NULL,
  CONSTRAINT store_contacts_pkey PRIMARY KEY (id),
  CONSTRAINT store_contacts_store_id_fkey FOREIGN KEY (store_id) REFERENCES public.stores(id)
);
CREATE TABLE public.store_operating_hours (
                                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                                              active boolean DEFAULT true,
                                              created_by uuid,
                                              created_at timestamp with time zone DEFAULT now(),
                                              updated_by uuid,
                                              updated_at timestamp with time zone DEFAULT now(),
                                              row_id integer NOT NULL DEFAULT nextval('store_operating_hours_row_id_seq'::regclass),
                                              day_of_week integer CHECK (day_of_week >= 0 AND day_of_week <= 6),
                                              day_name character varying,
                                              open_time time without time zone,
                                              close_time time without time zone,
                                              is_24_hours boolean DEFAULT false,
                                              is_closed boolean DEFAULT false,
                                              is_holiday_hours boolean DEFAULT false,
                                              effective_from date,
                                              effective_to date,
                                              notes text,
                                              store_id uuid NOT NULL,
                                              CONSTRAINT store_operating_hours_pkey PRIMARY KEY (id),
                                              CONSTRAINT store_operating_hours_store_id_fkey FOREIGN KEY (store_id) REFERENCES public.stores(id)
);
CREATE TABLE public.store_services (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       active boolean DEFAULT true,
                                       created_by uuid,
                                       created_at timestamp with time zone DEFAULT now(),
                                       updated_by uuid,
                                       updated_at timestamp with time zone DEFAULT now(),
                                       row_id integer NOT NULL DEFAULT nextval('store_services_row_id_seq'::regclass),
                                       service_name character varying NOT NULL,
                                       service_code character varying,
                                       description text,
                                       is_available boolean DEFAULT true,
                                       category character varying,
                                       store_id uuid NOT NULL,
                                       CONSTRAINT store_services_pkey PRIMARY KEY (id),
                                       CONSTRAINT store_services_store_id_fkey FOREIGN KEY (store_id) REFERENCES public.stores(id)
);
CREATE TABLE public.stores (
                               id uuid NOT NULL DEFAULT gen_random_uuid(),
                               active boolean DEFAULT true,
                               created_by uuid,
                               created_at timestamp with time zone DEFAULT now(),
                               updated_by uuid,
                               updated_at timestamp with time zone DEFAULT now(),
                               row_id integer NOT NULL DEFAULT nextval('stores_row_id_seq'::regclass),
                               external_id character varying,
                               name character varying NOT NULL,
                               code character varying,
                               description text,
                               address text,
                               city_id integer,
                               city_name character varying,
                               district_id integer,
                               district_name character varying,
                               postal_code character varying,
                               latitude numeric,
                               longitude numeric,
                               phone character varying,
                               email character varying,
                               status character varying DEFAULT 'active'::character varying CHECK (status::text = ANY (ARRAY['active'::character varying, 'inactive'::character varying, 'temporarily_closed'::character varying, 'under_renovation'::character varying]::text[])),
                               opening_date date,
                               closing_date date,
                               store_type character varying,
                               store_size_sqm integer,
                               parking_available boolean DEFAULT false,
                               accessible_entrance boolean DEFAULT false,
                               last_updated_from_api timestamp with time zone,
                               api_data_hash character varying,
                               retail_chain_id uuid NOT NULL,
                               tenant_id uuid,
                               country_id character varying,
                               state_id integer,
                               CONSTRAINT stores_pkey PRIMARY KEY (id),
                               CONSTRAINT stores_city_id_fkey FOREIGN KEY (city_id) REFERENCES public.cities(id),
                               CONSTRAINT stores_district_id_fkey FOREIGN KEY (district_id) REFERENCES public.districts(id),
                               CONSTRAINT stores_retail_chain_id_fkey FOREIGN KEY (retail_chain_id) REFERENCES public.retail_chains(id),
                               CONSTRAINT stores_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id),
                               CONSTRAINT stores_state_id_fkey FOREIGN KEY (state_id) REFERENCES public.states(id),
                               CONSTRAINT stores_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.sub_contractor_organizations (
                                                     sub_contractor_id uuid NOT NULL,
                                                     organization_id uuid NOT NULL,
                                                     CONSTRAINT fk66p91m4uejqy5tdpfswmoe6ag FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                                                     CONSTRAINT fkn6d5cf2inm4xgx0fywp7kg6j1 FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
                                                     CONSTRAINT fkdhuvmsm32bvn95c653o62boct FOREIGN KEY (organization_id) REFERENCES public.sub_contractors(id),
                                                     CONSTRAINT fki7jqhur56v1uexkim01slynmm FOREIGN KEY (sub_contractor_id) REFERENCES public.organizations(id)
);
CREATE TABLE public.sub_contractor_teams (
                                             sub_contractor_id uuid NOT NULL,
                                             team_id uuid NOT NULL,
                                             CONSTRAINT fk4qj8p29hxe3rvps9ctc1xck4n FOREIGN KEY (sub_contractor_id) REFERENCES public.teams(id),
                                             CONSTRAINT fk7vedb0xxypjkldqh7s2b0nyjf FOREIGN KEY (team_id) REFERENCES public.sub_contractors(id),
                                             CONSTRAINT fkct8ubtc7w3olqphorp52k6xt3 FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                             CONSTRAINT fkg93ws6h487il5dcskfb0mcgpr FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id)
);
CREATE TABLE public.sub_contractors (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('sub_contractor_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        code character varying,
                                        description character varying,
                                        name character varying,
                                        client character varying,
                                        color character varying,
                                        image_path character varying,
                                        avatar_code character varying,
                                        foundation_date character varying,
                                        financial_id uuid UNIQUE,
                                        location_id uuid UNIQUE,
                                        rating_id uuid UNIQUE,
                                        tenant_id uuid,
                                        CONSTRAINT sub_contractors_pkey PRIMARY KEY (id),
                                        CONSTRAINT fk2sx64f8kjqp9xo2epo749ww2p FOREIGN KEY (location_id) REFERENCES public.locations(id),
                                        CONSTRAINT fk5pwvgyq72v32l1pa0xfsa8a5g FOREIGN KEY (financial_id) REFERENCES public.financials(id),
                                        CONSTRAINT fkdlqnd72ubli9uwgjqb7x9o4jh FOREIGN KEY (rating_id) REFERENCES public.ratings(id),
                                        CONSTRAINT sub_contractors_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.sub_menu_ids (
                                     id uuid NOT NULL,
                                     active boolean,
                                     created_by uuid,
                                     created_at timestamp with time zone,
                                     row_id integer NOT NULL DEFAULT nextval('sub_menu_id_row_id_seq'::regclass),
                                     updated_by uuid,
                                     updated_at timestamp with time zone,
                                     sub_menu_id uuid,
                                     profile_id uuid,
                                     CONSTRAINT sub_menu_ids_pkey PRIMARY KEY (id),
                                     CONSTRAINT fkkvgrnvrgxojc95w2dkjh3qiu1 FOREIGN KEY (profile_id) REFERENCES public.profiles(id)
);
CREATE TABLE public.sub_menus (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('sub_menu_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  description character varying,
                                  name character varying,
                                  path character varying,
                                  role character varying,
                                  menu_id uuid,
                                  CONSTRAINT sub_menus_pkey PRIMARY KEY (id),
                                  CONSTRAINT fkgjbf8ya011eg4opecaeeprlwo FOREIGN KEY (menu_id) REFERENCES public.menus(id)
);
CREATE TABLE public.subscription_plans (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           plan_code character varying NOT NULL UNIQUE,
                                           plan_name character varying NOT NULL,
                                           description text,
                                           price_monthly numeric CHECK (price_monthly IS NULL OR price_monthly >= 0::numeric),
  price_yearly numeric,
  currency character varying DEFAULT 'TRY'::character varying,
  trial_days integer DEFAULT 14,
  active boolean DEFAULT true,
  is_public boolean DEFAULT true,
  display_order integer DEFAULT 0,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  CONSTRAINT subscription_plans_pkey PRIMARY KEY (id),
  CONSTRAINT subscription_plans_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT subscription_plans_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.supervisor_controllers (
                                               id uuid NOT NULL DEFAULT gen_random_uuid(),
                                               row_id integer NOT NULL DEFAULT nextval('supervisor_controller_row_id_seq'::regclass),
                                               active boolean DEFAULT true,
                                               created_by uuid,
                                               created_at timestamp with time zone DEFAULT now(),
                                               updated_by uuid,
                                               updated_at timestamp with time zone DEFAULT now(),
                                               supervisor_id uuid NOT NULL,
                                               controller_id uuid NOT NULL,
                                               priority integer DEFAULT 1 CHECK (priority > 0),
                                               is_primary boolean DEFAULT false,
                                               assignment_date timestamp with time zone DEFAULT now(),
                                               is_monitoring boolean DEFAULT true,
                                               last_monitoring_time timestamp with time zone,
                                               polling_override integer,
                                               timeout_override integer,
                                               CONSTRAINT supervisor_controllers_pkey PRIMARY KEY (id),
                                               CONSTRAINT supervisor_controller_supervisor_id_fkey FOREIGN KEY (supervisor_id) REFERENCES public.supervisors(id),
                                               CONSTRAINT supervisor_controller_controller_id_fkey FOREIGN KEY (controller_id) REFERENCES public.controllers(id)
);
CREATE TABLE public.supervisor_types (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('supervisor_type_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         code character varying,
                                         description character varying,
                                         ftp_client_directory character varying,
                                         ftp_client_file_name character varying,
                                         ftp_client_permission character varying,
                                         ftp_client_port integer,
                                         image_path character varying,
                                         name character varying,
                                         brand_id uuid NOT NULL,
                                         CONSTRAINT supervisor_types_pkey PRIMARY KEY (id),
                                         CONSTRAINT fkbcg4ki97xlsj1q1u40yben8o7 FOREIGN KEY (brand_id) REFERENCES public.brands(id)
);
CREATE TABLE public.supervisors (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    row_id integer NOT NULL DEFAULT nextval('supervisor_row_id_seq'::regclass),
                                    active boolean DEFAULT true,
                                    created_by uuid,
                                    created_at timestamp with time zone DEFAULT now(),
                                    updated_by uuid,
                                    updated_at timestamp with time zone DEFAULT now(),
                                    code character varying UNIQUE,
                                    name character varying NOT NULL,
                                    description character varying,
                                    ip character varying,
                                    port integer DEFAULT 80,
                                    mac character varying,
                                    username character varying,
                                    password character varying,
                                    polling_interval integer DEFAULT 60 CHECK (polling_interval > 0),
                                    timeout_duration integer DEFAULT 30 CHECK (timeout_duration > 0),
                                    max_retries integer DEFAULT 3 CHECK (max_retries >= 0),
                                    is_enabled boolean DEFAULT true,
                                    is_online boolean DEFAULT false,
                                    last_heartbeat timestamp with time zone,
                                    last_communication_time timestamp with time zone,
                                    last_sync_time timestamp with time zone,
                                    latitude double precision,
                                    longitude double precision,
                                    address character varying,
                                    city character varying,
                                    country character varying,
                                    color character varying DEFAULT '#007bff'::character varying,
                                    icon_path character varying,
                                    image_path character varying,
                                    supervisor_type_id uuid NOT NULL,
                                    brand_id uuid NOT NULL,
                                    site_id uuid NOT NULL,
                                    tenant_id uuid,
                                    area_id uuid,
                                    contractor_id uuid,
                                    CONSTRAINT supervisors_pkey PRIMARY KEY (id),
                                    CONSTRAINT supervisor_supervisor_type_fkey FOREIGN KEY (supervisor_type_id) REFERENCES public.supervisor_types(id),
                                    CONSTRAINT supervisor_brand_fkey FOREIGN KEY (brand_id) REFERENCES public.brands(id),
                                    CONSTRAINT supervisor_site_fkey FOREIGN KEY (site_id) REFERENCES public.sites(id),
                                    CONSTRAINT supervisor_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                    CONSTRAINT supervisor_area_fkey FOREIGN KEY (area_id) REFERENCES public.areas(id),
                                    CONSTRAINT supervisor_contractor_fkey FOREIGN KEY (contractor_id) REFERENCES public.contractors(id)
);
CREATE TABLE public.sync_logs (
                                  id uuid NOT NULL DEFAULT gen_random_uuid(),
                                  sync_type character varying NOT NULL,
                                  operation character varying NOT NULL,
                                  entity_id uuid NOT NULL,
                                  status character varying NOT NULL,
                                  error_message text,
                                  source_system character varying DEFAULT 'SUPABASE'::character varying,
                                  created_at timestamp with time zone DEFAULT now(),
                                  CONSTRAINT sync_logs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.system_logs (
                                    id uuid NOT NULL DEFAULT uuid_generate_v4(),
                                    created_at timestamp with time zone DEFAULT now(),
                                    user_id uuid,
                                    action character varying NOT NULL,
                                    entity_type character varying NOT NULL,
                                    entity_id uuid,
                                    description text,
                                    old_values jsonb,
                                    new_values jsonb,
                                    ip_address character varying,
                                    user_agent text,
                                    metadata jsonb,
                                    tenant_id uuid,
                                    CONSTRAINT system_logs_pkey PRIMARY KEY (id),
                                    CONSTRAINT system_logs_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tasks (
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('task_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              assignee character varying,
                              assigner character varying,
                              code character varying,
                              description text,
                              due_date timestamp with time zone,
                              duration numeric,
                              end_date timestamp with time zone,
                              last_date timestamp with time zone,
                              last_modified_date timestamp with time zone,
                              priority character varying CHECK (priority::text = ANY (ARRAY['LOW'::character varying::text, 'MEDIUM'::character varying::text, 'HIGH'::character varying::text, 'CRITICAL'::character varying::text, 'URGENT'::character varying::text, 'IMMEDIATE'::character varying::text, 'ASAP'::character varying::text, 'EMERGENCY'::character varying::text, 'STAT'::character varying::text, 'STANDARD'::character varying::text, 'ROUTINE'::character varying::text, 'REGULAR'::character varying::text])),
  progress double precision,
  start_date timestamp with time zone,
  status character varying CHECK (status::text = ANY (ARRAY['CREATED'::character varying::text, 'ASSIGNED'::character varying::text, 'IN_PROGRESS'::character varying::text, 'COMPLETED'::character varying::text, 'REJECTED'::character varying::text, 'STOPPED'::character varying::text, 'CANCELED'::character varying::text])),
  tags character varying,
  title character varying,
  work_request_id uuid NOT NULL,
  tenant_id uuid,
  organization_id uuid,
  contractor_id uuid,
  project_work_request_id uuid,
  staff_id uuid,
  sub_contractor_id uuid,
  team_id uuid,
  unit_id uuid,
  workflow_work_request_id uuid,
  CONSTRAINT tasks_pkey PRIMARY KEY (work_request_id),
  CONSTRAINT fk1nq54k59m07qlk6o1pc7f079c FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
  CONSTRAINT fk38g8gejjqibvfq5wphjriclow FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
  CONSTRAINT fk9a7pq3fo97ohy7w8cleq59un FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
  CONSTRAINT fkfmsjv01ybcf3bu8yuy36cgquf FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
  CONSTRAINT fkihos42gv17tf5m0ygme746dq6 FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
  CONSTRAINT fkkh8tks816054ua9p6fwuxicwy FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
  CONSTRAINT fkqw0j6mw9ec3e2ifegvvt4vcho FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
  CONSTRAINT fkr0l2ptcp17n9tccepdbn4e56g FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fks3wk3nsant43nvllvndb08jkh FOREIGN KEY (team_id) REFERENCES public.teams(id),
  CONSTRAINT fksl5vvpy1crnfy7djxq76mfew2 FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.team_staffs (
                                    team_id uuid NOT NULL,
                                    staff_id uuid NOT NULL,
                                    active boolean,
                                    created_at timestamp with time zone,
                                    updated_at timestamp with time zone,
                                    CONSTRAINT fk2jaba5rfigo1dt6v7vqm1okfj FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
                                    CONSTRAINT fk98buj8hapfynrt9x8ef2vnpon FOREIGN KEY (team_id) REFERENCES public.teams(id)
);
CREATE TABLE public.teams (
                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('team_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              code character varying,
                              description character varying,
                              name character varying,
                              independent boolean,
                              rating_id uuid UNIQUE,
                              route_locations_id uuid UNIQUE,
                              tenant_id uuid,
                              CONSTRAINT teams_pkey PRIMARY KEY (id),
                              CONSTRAINT fkcrffdty58hki7w5vdou7p1hop FOREIGN KEY (rating_id) REFERENCES public.ratings(id),
                              CONSTRAINT fkt47hcimqsvl5sau85uqxlevp5 FOREIGN KEY (route_locations_id) REFERENCES public.route_locations(id),
                              CONSTRAINT teams_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.temperature_reference_values (
                                                     id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                     active boolean,
                                                     created_by uuid,
                                                     created_at timestamp with time zone,
                                                     row_id integer NOT NULL DEFAULT nextval('temperature_reference_values_row_id_seq'::regclass),
                                                     updated_by uuid,
                                                     updated_at timestamp with time zone,
                                                     cooling_baseline numeric NOT NULL,
                                                     heating_baseline numeric NOT NULL,
                                                     area_id uuid NOT NULL DEFAULT gen_random_uuid() UNIQUE,
                                                     CONSTRAINT temperature_reference_values_pkey PRIMARY KEY (id),
                                                     CONSTRAINT fkq4djy2pjr2jsbixqw21i9y2xc FOREIGN KEY (area_id) REFERENCES public.areas(id)
);
CREATE TABLE public.tenant_billing_info (
                                            id uuid NOT NULL DEFAULT gen_random_uuid(),
                                            tenant_id uuid NOT NULL UNIQUE,
                                            company_name character varying NOT NULL,
                                            tax_office character varying,
                                            tax_number character varying,
                                            billing_address text,
                                            billing_city character varying,
                                            billing_country character varying DEFAULT 'TR'::character varying,
                                            billing_postal_code character varying,
                                            billing_email character varying NOT NULL CHECK (billing_email::text ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'::text),
  billing_phone character varying,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  CONSTRAINT tenant_billing_info_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_billing_info_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_billing_info_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_billing_info_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_contractors (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('tenant_contractor_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           contractor_id uuid,
                                           tenant_id uuid,
                                           CONSTRAINT tenant_contractors_pkey PRIMARY KEY (id),
                                           CONSTRAINT fk3409undhj80ht06bl816mbufi FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                           CONSTRAINT fk9pqr95rytdbehtrocbuw4aecg FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_credit_transactions (
                                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                   tenant_id uuid NOT NULL,
                                                   transaction_type character varying NOT NULL CHECK (transaction_type::text = ANY (ARRAY['purchase'::character varying, 'usage'::character varying, 'refund'::character varying, 'bonus'::character varying, 'expiration'::character varying, 'adjustment'::character varying, 'gift'::character varying]::text[])),
  credit_amount integer NOT NULL,
  balance_before integer NOT NULL,
  balance_after integer NOT NULL,
  related_entity_type character varying,
  related_entity_id uuid,
  credit_package_id uuid,
  payment_transaction_id uuid,
  description text,
  metadata jsonb,
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT tenant_credit_transactions_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_credit_transactions_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_credit_transactions_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT tenant_credit_transactions_credit_package_id_fkey FOREIGN KEY (credit_package_id) REFERENCES public.credit_packages(id)
);
CREATE TABLE public.tenant_credits (
                                       id uuid NOT NULL DEFAULT gen_random_uuid(),
                                       tenant_id uuid NOT NULL UNIQUE,
                                       total_credits integer DEFAULT 0,
                                       used_credits integer DEFAULT 0,
                                       available_credits integer DEFAULT (total_credits - used_credits),
                                       lifetime_purchased_credits integer DEFAULT 0,
                                       lifetime_bonus_credits integer DEFAULT 0,
                                       last_purchase_at timestamp with time zone,
                                       created_at timestamp with time zone DEFAULT now(),
                                       updated_at timestamp with time zone DEFAULT now(),
                                       created_by uuid,
                                       updated_by uuid,
                                       CONSTRAINT tenant_credits_pkey PRIMARY KEY (id),
                                       CONSTRAINT tenant_credits_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                       CONSTRAINT tenant_credits_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                       CONSTRAINT tenant_credits_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_features (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        tenant_id uuid NOT NULL,
                                        feature_key character varying NOT NULL,
                                        is_enabled boolean NOT NULL,
                                        override_reason text,
                                        created_at timestamp with time zone DEFAULT now(),
                                        updated_at timestamp with time zone DEFAULT now(),
                                        enabled_at timestamp with time zone,
                                        disabled_at timestamp with time zone,
                                        enabled_by uuid,
                                        created_by uuid,
                                        updated_by uuid,
                                        CONSTRAINT tenant_features_pkey PRIMARY KEY (id),
                                        CONSTRAINT tenant_features_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                        CONSTRAINT tenant_features_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                        CONSTRAINT tenant_features_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_invoices (
                                        id uuid NOT NULL DEFAULT gen_random_uuid(),
                                        tenant_id uuid NOT NULL,
                                        tenant_subscription_id uuid,
                                        invoice_number character varying NOT NULL UNIQUE,
                                        invoice_date date NOT NULL DEFAULT CURRENT_DATE,
                                        due_date date NOT NULL,
                                        subtotal numeric NOT NULL,
                                        tax_rate numeric DEFAULT 20.00,
                                        tax_amount numeric NOT NULL,
                                        discount_amount numeric DEFAULT 0,
                                        total_amount numeric NOT NULL,
                                        currency character varying DEFAULT 'TRY'::character varying,
                                        status character varying NOT NULL DEFAULT 'draft'::character varying CHECK (status::text = ANY (ARRAY['draft'::character varying, 'sent'::character varying, 'paid'::character varying, 'partially_paid'::character varying, 'overdue'::character varying, 'void'::character varying, 'refunded'::character varying]::text[])),
                                        payment_date date,
                                        paid_amount numeric DEFAULT 0,
                                        invoice_pdf_url text,
                                        invoice_xml_url text,
                                        related_entity_type character varying,
                                        related_entity_id uuid,
                                        notes text,
                                        internal_notes text,
                                        created_at timestamp with time zone DEFAULT now(),
                                        updated_at timestamp with time zone DEFAULT now(),
                                        created_by uuid,
                                        updated_by uuid,
                                        CONSTRAINT tenant_invoices_pkey PRIMARY KEY (id),
                                        CONSTRAINT tenant_invoices_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                        CONSTRAINT tenant_invoices_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                        CONSTRAINT tenant_invoices_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                        CONSTRAINT tenant_invoices_tenant_subscription_id_fkey FOREIGN KEY (tenant_subscription_id) REFERENCES public.tenant_subscriptions(id)
);
CREATE TABLE public.tenant_lifecycle_events (
                                                id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                tenant_id uuid NOT NULL,
                                                event_type character varying NOT NULL CHECK (event_type::text = ANY (ARRAY['created'::character varying, 'activated'::character varying, 'trial_started'::character varying, 'trial_ending_soon'::character varying, 'trial_ended'::character varying, 'subscription_started'::character varying, 'subscription_renewed'::character varying, 'subscription_upgraded'::character varying, 'subscription_downgraded'::character varying, 'subscription_canceled'::character varying, 'suspended'::character varying, 'reactivated'::character varying, 'churned'::character varying, 'deleted'::character varying]::text[])),
  event_data jsonb,
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT tenant_lifecycle_events_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_lifecycle_events_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_lifecycle_events_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_notifications (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             tenant_id uuid NOT NULL,
                                             notification_type character varying NOT NULL CHECK (notification_type::text = ANY (ARRAY['quota_warning'::character varying, 'quota_exceeded'::character varying, 'trial_ending_soon'::character varying, 'trial_ended'::character varying, 'payment_failed'::character varying, 'payment_due'::character varying, 'invoice_ready'::character varying, 'subscription_renewed'::character varying, 'subscription_canceled'::character varying, 'feature_announcement'::character varying, 'system_maintenance'::character varying, 'security_alert'::character varying]::text[])),
  priority character varying DEFAULT 'normal'::character varying CHECK (priority::text = ANY (ARRAY['low'::character varying, 'normal'::character varying, 'high'::character varying, 'critical'::character varying]::text[])),
  title character varying NOT NULL,
  message text NOT NULL,
  action_text character varying,
  action_url text,
  is_read boolean DEFAULT false,
  is_dismissed boolean DEFAULT false,
  read_at timestamp with time zone,
  dismissed_at timestamp with time zone,
  expires_at timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT tenant_notifications_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_notifications_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_notifications_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_notifications_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_onboarding (
                                          id uuid NOT NULL DEFAULT gen_random_uuid(),
                                          tenant_id uuid,
                                          user_id uuid NOT NULL,
                                          current_step character varying NOT NULL DEFAULT 'welcome'::character varying,
                                          steps_completed jsonb DEFAULT '[]'::jsonb,
                                          step_data jsonb DEFAULT '{}'::jsonb,
                                          template_id uuid,
                                          template_applied boolean DEFAULT false,
                                          started_at timestamp with time zone DEFAULT now(),
                                          completed_at timestamp with time zone,
                                          last_activity_at timestamp with time zone DEFAULT now(),
                                          status character varying NOT NULL DEFAULT 'in_progress'::character varying CHECK (status::text = ANY (ARRAY['in_progress'::character varying, 'completed'::character varying, 'abandoned'::character varying, 'paused'::character varying]::text[])),
                                          created_at timestamp with time zone DEFAULT now(),
                                          updated_at timestamp with time zone DEFAULT now(),
                                          CONSTRAINT tenant_onboarding_pkey PRIMARY KEY (id),
                                          CONSTRAINT tenant_onboarding_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_payment_methods (
                                               id uuid NOT NULL DEFAULT gen_random_uuid(),
                                               tenant_id uuid NOT NULL,
                                               payment_type character varying NOT NULL CHECK (payment_type::text = ANY (ARRAY['credit_card'::character varying, 'bank_transfer'::character varying, 'iyzico'::character varying, 'manual'::character varying]::text[])),
  card_last_4 character varying,
  card_brand character varying,
  card_exp_month integer,
  card_exp_year integer,
  cardholder_name character varying,
  bank_name character varying,
  iban character varying,
  account_holder_name character varying,
  external_payment_id character varying,
  external_payment_data jsonb,
  is_default boolean DEFAULT false,
  active boolean DEFAULT true,
  is_verified boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  last_used_at timestamp with time zone,
  created_by uuid,
  updated_by uuid,
  CONSTRAINT tenant_payment_methods_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_payment_methods_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_payment_methods_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_payment_methods_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_payment_transactions (
                                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                    tenant_id uuid NOT NULL,
                                                    tenant_invoice_id uuid,
                                                    tenant_payment_method_id uuid,
                                                    transaction_type character varying NOT NULL CHECK (transaction_type::text = ANY (ARRAY['payment'::character varying, 'refund'::character varying, 'chargeback'::character varying, 'adjustment'::character varying]::text[])),
  amount numeric NOT NULL CHECK (amount > 0::numeric),
  currency character varying DEFAULT 'TRY'::character varying,
  status character varying NOT NULL DEFAULT 'pending'::character varying CHECK (status::text = ANY (ARRAY['pending'::character varying, 'processing'::character varying, 'success'::character varying, 'failed'::character varying, 'refunded'::character varying, 'cancelled'::character varying]::text[])),
  external_transaction_id character varying,
  external_conversation_id character varying,
  gateway_name character varying DEFAULT 'iyzico'::character varying,
  gateway_response jsonb,
  error_code character varying,
  error_message text,
  description text,
  processed_at timestamp with time zone,
  failed_at timestamp with time zone,
  refunded_at timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  CONSTRAINT tenant_payment_transactions_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_payment_transactions_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_payment_transactions_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_payment_transactions_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT tenant_payment_transactions_tenant_invoice_id_fkey FOREIGN KEY (tenant_invoice_id) REFERENCES public.tenant_invoices(id),
  CONSTRAINT tenant_payment_transactions_tenant_payment_method_id_fkey FOREIGN KEY (tenant_payment_method_id) REFERENCES public.tenant_payment_methods(id)
);
CREATE TABLE public.tenant_quotas (
                                      id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      tenant_id uuid NOT NULL,
                                      quota_key character varying NOT NULL,
                                      quota_value integer NOT NULL CHECK (quota_value >= 0),
                                      is_custom boolean DEFAULT false,
                                      effective_from timestamp with time zone DEFAULT now(),
                                      effective_until timestamp with time zone,
                                      created_at timestamp with time zone DEFAULT now(),
                                      updated_at timestamp with time zone DEFAULT now(),
                                      created_by uuid,
                                      updated_by uuid,
                                      CONSTRAINT tenant_quotas_pkey PRIMARY KEY (id),
                                      CONSTRAINT tenant_quotas_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                      CONSTRAINT tenant_quotas_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                      CONSTRAINT tenant_quotas_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_sub_contractors (
                                               tenant_id uuid NOT NULL,
                                               sub_contractor_id uuid NOT NULL,
                                               CONSTRAINT fk8kvrt258xm9bewu58xvvknahm FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                               CONSTRAINT fkfct1xpx63ch8jywrr1wxv0shc FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id)
);
CREATE TABLE public.tenant_subscription_history (
                                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                    tenant_id uuid NOT NULL,
                                                    tenant_subscription_id uuid,
                                                    change_type character varying NOT NULL CHECK (change_type::text = ANY (ARRAY['created'::character varying, 'plan_changed'::character varying, 'status_changed'::character varying, 'trial_started'::character varying, 'trial_ended'::character varying, 'canceled'::character varying, 'reactivated'::character varying]::text[])),
  old_plan_id uuid,
  new_plan_id uuid,
  old_status character varying,
  new_status character varying,
  change_reason text,
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT tenant_subscription_history_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_subscription_history_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_subscription_history_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT tenant_subscription_history_tenant_subscription_id_fkey FOREIGN KEY (tenant_subscription_id) REFERENCES public.tenant_subscriptions(id),
  CONSTRAINT tenant_subscription_history_old_plan_id_fkey FOREIGN KEY (old_plan_id) REFERENCES public.subscription_plans(id),
  CONSTRAINT tenant_subscription_history_new_plan_id_fkey FOREIGN KEY (new_plan_id) REFERENCES public.subscription_plans(id)
);
CREATE TABLE public.tenant_subscriptions (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             tenant_id uuid NOT NULL,
                                             subscription_plan_id uuid NOT NULL,
                                             status character varying NOT NULL DEFAULT 'trial'::character varying CHECK (status::text = ANY (ARRAY['trial'::character varying, 'active'::character varying, 'past_due'::character varying, 'canceled'::character varying, 'suspended'::character varying, 'incomplete'::character varying]::text[])),
                                             trial_starts_at timestamp with time zone,
                                             trial_ends_at timestamp with time zone,
                                             current_period_start timestamp with time zone NOT NULL DEFAULT now(),
                                             current_period_end timestamp with time zone NOT NULL DEFAULT (now() + '30 days'::interval),
                                             cancel_at_period_end boolean DEFAULT false,
                                             canceled_at timestamp with time zone,
                                             cancellation_reason text,
                                             created_at timestamp with time zone DEFAULT now(),
                                             updated_at timestamp with time zone DEFAULT now(),
                                             created_by uuid,
                                             updated_by uuid,
                                             CONSTRAINT tenant_subscriptions_pkey PRIMARY KEY (id),
                                             CONSTRAINT tenant_subscriptions_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
                                             CONSTRAINT tenant_subscriptions_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
                                             CONSTRAINT tenant_subscriptions_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                             CONSTRAINT tenant_subscriptions_subscription_plan_id_fkey FOREIGN KEY (subscription_plan_id) REFERENCES public.subscription_plans(id)
);
CREATE TABLE public.tenant_teams (
                                     tenant_id uuid NOT NULL,
                                     team_id uuid NOT NULL,
                                     CONSTRAINT fk2veklfroyw7t882nd2bxq31m FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                     CONSTRAINT fkp2i7d32ukm58p7g8v1sbqlyn3 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_usage_metrics (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             tenant_id uuid NOT NULL,
                                             metric_key character varying NOT NULL CHECK (metric_key::text = ANY (ARRAY['active_organizations'::character varying, 'active_sites'::character varying, 'active_units'::character varying, 'active_variables'::character varying, 'active_users'::character varying, 'active_contractors'::character varying, 'storage_used_gb'::character varying, 'api_calls_daily'::character varying, 'api_calls_monthly'::character varying]::text[])),
  metric_value numeric NOT NULL DEFAULT 0 CHECK (metric_value >= 0::numeric),
  measured_at timestamp with time zone DEFAULT now(),
  created_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  CONSTRAINT tenant_usage_metrics_pkey PRIMARY KEY (id),
  CONSTRAINT tenant_usage_metrics_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_usage_metrics_updated_by_fkey FOREIGN KEY (updated_by) REFERENCES auth.users(id),
  CONSTRAINT tenant_usage_metrics_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.tenant_users (
                                     id uuid NOT NULL DEFAULT gen_random_uuid(),
                                     user_id uuid NOT NULL,
                                     tenant_id uuid NOT NULL,
                                     role character varying NOT NULL DEFAULT 'member'::character varying CHECK (role::text = ANY (ARRAY['owner'::character varying, 'admin'::character varying, 'manager'::character varying, 'member'::character varying, 'viewer'::character varying]::text[])),
                                     status character varying NOT NULL DEFAULT 'active'::character varying CHECK (status::text = ANY (ARRAY['active'::character varying, 'inactive'::character varying, 'suspended'::character varying, 'pending'::character varying]::text[])),
                                     is_default boolean NOT NULL DEFAULT false,
                                     invited_by uuid,
                                     invited_at timestamp with time zone,
                                     invitation_token uuid,
                                     invitation_expires_at timestamp with time zone,
                                     joined_at timestamp with time zone DEFAULT now(),
                                     last_accessed_at timestamp with time zone,
                                     created_at timestamp with time zone NOT NULL DEFAULT now(),
                                     updated_at timestamp with time zone NOT NULL DEFAULT now(),
                                     CONSTRAINT tenant_users_pkey PRIMARY KEY (id),
                                     CONSTRAINT tenant_users_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
                                     CONSTRAINT tenant_users_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                     CONSTRAINT tenant_users_invited_by_fkey FOREIGN KEY (invited_by) REFERENCES auth.users(id)
);
CREATE TABLE public.tenants (
                                id uuid NOT NULL DEFAULT gen_random_uuid(),
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('tenant_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                code character varying,
                                description character varying,
                                name character varying,
                                client character varying,
                                address character varying,
                                city character varying,
                                country character varying,
                                latitude double precision,
                                longitude double precision,
                                town character varying,
                                zoom integer,
                                time_zone character varying,
                                onboarding_completed boolean DEFAULT false,
                                onboarding_completed_at timestamp with time zone,
                                onboarding_completed_by uuid,
                                contact_person character varying,
                                contact_email character varying,
                                contact_phone character varying,
                                website character varying,
                                tax_number character varying,
                                registration_number character varying,
                                CONSTRAINT tenants_pkey PRIMARY KEY (id)
);
CREATE TABLE public.tickets (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('ticket_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                tenant_id uuid,
                                CONSTRAINT tickets_pkey PRIMARY KEY (id),
                                CONSTRAINT fk8pnnxrjds16x2ive2s3ua30kh FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.todo_calendar_notifications (
                                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                    user_id character varying NOT NULL,
                                                    todo_id uuid,
                                                    event_id uuid,
                                                    notification_type character varying NOT NULL CHECK (notification_type::text = ANY (ARRAY['TODO_DUE_SOON'::character varying, 'TODO_OVERDUE'::character varying, 'TODO_ASSIGNED'::character varying, 'TODO_SHARED'::character varying, 'TODO_UPDATED'::character varying, 'EVENT_REMINDER'::character varying, 'EVENT_INVITATION'::character varying, 'EVENT_UPDATED'::character varying, 'EVENT_CANCELLED'::character varying, 'EVENT_RSVP_RESPONSE'::character varying]::text[])),
  title character varying NOT NULL,
  message text,
  is_read boolean DEFAULT false,
  read_at timestamp with time zone,
  sent_at timestamp with time zone DEFAULT now(),
  scheduled_for timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT todo_calendar_notifications_pkey PRIMARY KEY (id),
  CONSTRAINT notification_todo_fkey FOREIGN KEY (todo_id) REFERENCES public.todo_items(id),
  CONSTRAINT notification_event_fkey FOREIGN KEY (event_id) REFERENCES public.calendar_events(id)
);
CREATE TABLE public.todo_item_audit_logs (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             todo_id uuid NOT NULL,
                                             operation character varying NOT NULL CHECK (operation::text = ANY (ARRAY['INSERT'::character varying, 'UPDATE'::character varying, 'DELETE'::character varying]::text[])),
  old_data jsonb,
  new_data jsonb,
  changed_fields ARRAY,
  tenant_id uuid NOT NULL,
  changed_by character varying NOT NULL,
  changed_at timestamp with time zone DEFAULT now(),
  ip_address inet,
  user_agent text,
  CONSTRAINT todo_item_audit_logs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.todo_items (
                                   id uuid NOT NULL DEFAULT gen_random_uuid(),
                                   title character varying NOT NULL,
                                   description text,
                                   priority character varying NOT NULL CHECK (priority::text = ANY (ARRAY['LOW'::character varying, 'MEDIUM'::character varying, 'HIGH'::character varying, 'URGENT'::character varying]::text[])),
  status character varying NOT NULL CHECK (status::text = ANY (ARRAY['NOT_STARTED'::character varying, 'IN_PROGRESS'::character varying, 'COMPLETED'::character varying, 'CANCELLED'::character varying]::text[])),
  due_date timestamp with time zone,
  completed_at timestamp with time zone,
  tenant_id uuid NOT NULL,
  created_by uuid NOT NULL,
  assigned_to uuid,
  linked_event_id uuid,
  active boolean DEFAULT true,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  updated_by uuid,
  row_id integer NOT NULL DEFAULT nextval('todo_item_row_id_seq'::regclass),
  CONSTRAINT todo_items_pkey PRIMARY KEY (id),
  CONSTRAINT todo_item_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT todo_item_assigned_to_fkey FOREIGN KEY (assigned_to) REFERENCES public.staffs(id),
  CONSTRAINT todo_item_linked_event_fkey FOREIGN KEY (linked_event_id) REFERENCES public.calendar_events(id)
);
CREATE TABLE public.todo_shares (
                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                    todo_id uuid NOT NULL,
                                    shared_with_user uuid,
                                    shared_with_team uuid,
                                    shared_with_department uuid,
                                    can_edit boolean DEFAULT false,
                                    can_delete boolean DEFAULT false,
                                    shared_by character varying NOT NULL,
                                    shared_at timestamp with time zone DEFAULT now(),
                                    CONSTRAINT todo_shares_pkey PRIMARY KEY (id),
                                    CONSTRAINT todo_share_todo_fkey FOREIGN KEY (todo_id) REFERENCES public.todo_items(id),
                                    CONSTRAINT todo_share_user_fkey FOREIGN KEY (shared_with_user) REFERENCES public.staffs(id),
                                    CONSTRAINT todo_share_team_fkey FOREIGN KEY (shared_with_team) REFERENCES public.teams(id),
                                    CONSTRAINT todo_share_department_fkey FOREIGN KEY (shared_with_department) REFERENCES public.departments(id)
);
CREATE TABLE public.txn_types (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('txn_type_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  CONSTRAINT txn_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.txns (
                             id uuid NOT NULL,
                             active boolean,
                             created_by uuid,
                             created_at timestamp with time zone,
                             row_id integer NOT NULL DEFAULT nextval('txn_row_id_seq'::regclass),
                             updated_by uuid,
                             updated_at timestamp with time zone,
                             end_date timestamp with time zone,
                             has_error boolean DEFAULT false,
                             interval_end_date timestamp with time zone,
                             interval_start_date timestamp with time zone,
                             processing boolean DEFAULT false,
                             start_date timestamp with time zone,
                             status boolean DEFAULT false,
                             txn_group uuid,
                             controller_id uuid,
                             provider_id uuid,
                             txn_type_id uuid,
                             expected_process_count integer,
                             processed_count integer,
                             tenant_id uuid,
                             CONSTRAINT txns_pkey PRIMARY KEY (id),
                             CONSTRAINT fk6c4uuc8ej96e9x27xoic3ha58 FOREIGN KEY (provider_id) REFERENCES public.providers(id),
                             CONSTRAINT fkogsldse7qs0nv84gdcmiy2hfc FOREIGN KEY (txn_type_id) REFERENCES public.txn_types(id),
                             CONSTRAINT fkqt38u3y6qn2uh4g2hi3y1oxe2 FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                             CONSTRAINT txns_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.unit_characteristics (
                                             id uuid NOT NULL,
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('unit_characteristic_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             value character varying,
                                             characteristic_id uuid,
                                             unit_id uuid,
                                             CONSTRAINT unit_characteristics_pkey PRIMARY KEY (id),
                                             CONSTRAINT fk2lqip5doxj97sfsux6xfdiygy FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                             CONSTRAINT fk5a0wiym6b38c8t3iknkn69j7l FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.unit_schedules (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('unit_schedule_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       days_of_week text,
                                       description text,
                                       end_day integer,
                                       end_month integer,
                                       is_active boolean NOT NULL,
                                       name character varying NOT NULL,
                                       open_end_time time without time zone,
                                       open_start_time time without time zone,
                                       priority integer NOT NULL,
                                       schedule_type character varying NOT NULL CHECK (schedule_type::text = ANY (ARRAY['POSTPONE'::character varying, 'FOR_EACH'::character varying]::text[])),
  start_day integer,
  start_month integer,
  valid_from timestamp with time zone,
  valid_until timestamp with time zone,
  work_end_time time without time zone,
  work_start_time time without time zone,
  unit_id uuid NOT NULL,
  CONSTRAINT unit_schedules_pkey PRIMARY KEY (id),
  CONSTRAINT fka48a6qy43fy3t1ryu6t5f53f6 FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.unit_types (
                                   id uuid NOT NULL,
                                   active boolean,
                                   created_by uuid,
                                   created_at timestamp with time zone,
                                   row_id integer NOT NULL DEFAULT nextval('unit_type_row_id_seq'::regclass),
                                   updated_by uuid,
                                   updated_at timestamp with time zone,
                                   description character varying,
                                   name character varying,
                                   code character varying,
                                   is_main_area boolean DEFAULT false,
                                   is_system_type boolean DEFAULT false,
                                   category character varying CHECK (category::text = ANY (ARRAY['MAIN'::character varying, 'FLOOR'::character varying, 'SECTION'::character varying, 'ROOM'::character varying, 'ZONE'::character varying, 'PRODUCTION'::character varying, 'STORAGE'::character varying, 'SERVICE'::character varying, 'COMMON'::character varying, 'TECHNICAL'::character varying, 'OUTDOOR'::character varying, 'CUSTOM'::character varying]::text[])),
  allowed_site_types jsonb,
  icon character varying,
  color character varying,
  display_order integer DEFAULT 0,
  CONSTRAINT unit_types_pkey PRIMARY KEY (id)
);
CREATE TABLE public.units (
                              id uuid NOT NULL DEFAULT gen_random_uuid(),
                              active boolean,
                              created_by uuid,
                              created_at timestamp with time zone,
                              row_id integer NOT NULL DEFAULT nextval('unit_row_id_seq'::regclass),
                              updated_by uuid,
                              updated_at timestamp with time zone,
                              code character varying,
                              description character varying,
                              name character varying,
                              area_size double precision,
                              tenant_id uuid,
                              authorized_staff uuid,
                              organization_id uuid,
                              contractor_id uuid,
                              financial_id uuid UNIQUE,
                              location_id uuid UNIQUE,
                              parent_unit_id uuid,
                              sub_contractor_id uuid,
                              unit_type_id uuid,
                              area_id uuid,
                              image_bucket character varying,
                              friday_end_time time without time zone,
                              friday_start_time time without time zone,
                              general_close_time time without time zone,
                              general_open_time time without time zone,
                              working_time_active boolean,
                              monday_end_time time without time zone,
                              monday_start_time time without time zone,
                              saturday_end_time time without time zone,
                              saturday_start_time time without time zone,
                              sunday_end_time time without time zone,
                              sunday_start_time time without time zone,
                              thursday_end_time time without time zone,
                              thursday_start_time time without time zone,
                              tuesday_end_time time without time zone,
                              tuesday_start_time time without time zone,
                              wednesday_end_time time without time zone,
                              wednesday_start_time time without time zone,
                              site_id uuid,
                              is_main_area boolean DEFAULT false,
                              is_deletable boolean DEFAULT true,
                              original_main_area boolean DEFAULT false,
                              CONSTRAINT units_pkey PRIMARY KEY (id),
                              CONSTRAINT fk4yxigu36rfab6n4oqpotyi5ft FOREIGN KEY (location_id) REFERENCES public.locations(id),
                              CONSTRAINT fk9r11s9o7916gn8v8wf2opjamk FOREIGN KEY (financial_id) REFERENCES public.financials(id),
                              CONSTRAINT fkcd9lgh4l9l2npbq04e2j8jq41 FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
                              CONSTRAINT fkh6pl6rhyk5xci4clt14paj3c4 FOREIGN KEY (unit_type_id) REFERENCES public.unit_types(id),
                              CONSTRAINT fkjt5nec13c3e594fvqytk6dvh1 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                              CONSTRAINT fkkox6h2jqjvsbj45i5lrbmlifd FOREIGN KEY (authorized_staff) REFERENCES public.staffs(id),
                              CONSTRAINT fklowpi7fagcf61cecn3gdunre FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                              CONSTRAINT fknauig7ulpygoc676o9jw8vymk FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
                              CONSTRAINT fkr2vrnuslbmo7b5ohqw6iit0ly FOREIGN KEY (parent_unit_id) REFERENCES public.units(id),
                              CONSTRAINT fkjtr4r90c5dxckbrtmexgv6cpc FOREIGN KEY (area_id) REFERENCES public.areas(id),
                              CONSTRAINT fk2a0fccsdtgua421abp2e1t78t FOREIGN KEY (site_id) REFERENCES public.sites(id)
);
CREATE TABLE public.validation_steps (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('validation_step_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         absolute_path character varying,
                                         short_code character varying,
                                         validation_id uuid,
                                         CONSTRAINT validation_steps_pkey PRIMARY KEY (id),
                                         CONSTRAINT fk9e5sukxr8g6qj5wohsff088cg FOREIGN KEY (validation_id) REFERENCES public.validations(id)
);
CREATE TABLE public.validations (
                                    id uuid NOT NULL,
                                    active boolean,
                                    created_by uuid,
                                    created_at timestamp with time zone,
                                    row_id integer NOT NULL DEFAULT nextval('validation_row_id_seq'::regclass),
                                    updated_by uuid,
                                    updated_at timestamp with time zone,
                                    decision character varying CHECK (decision::text = ANY (ARRAY['ALL'::character varying::text, 'CONSENSUS'::character varying::text, 'ONEOF'::character varying::text])),
  description character varying,
  name character varying,
  short_code character varying,
  tenant_id uuid,
  CONSTRAINT validations_pkey PRIMARY KEY (id),
  CONSTRAINT fkbdwns72rhe3nqvbh5eicsfrmb FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.variable_report_controllers (
                                                    variable_report_id uuid NOT NULL,
                                                    controller_id uuid NOT NULL,
                                                    CONSTRAINT fkf0g2b9xtap64jbdt1alva949l FOREIGN KEY (controller_id) REFERENCES public.controllers(id),
                                                    CONSTRAINT fkr5jsxs8tm7hsiarupbyx37g3e FOREIGN KEY (variable_report_id) REFERENCES public.variable_reports(id)
);
CREATE TABLE public.variable_report_realtimes (
                                                  variable_report_id uuid NOT NULL,
                                                  realtime_id uuid NOT NULL,
                                                  CONSTRAINT fk3uhml4je8a405hnigpgfu8wnx FOREIGN KEY (variable_report_id) REFERENCES public.variable_reports(id),
                                                  CONSTRAINT fkcm2crtbd775eps5skivghbt69 FOREIGN KEY (realtime_id) REFERENCES public.realtimes(id)
);
CREATE TABLE public.variable_reports (
                                         id uuid NOT NULL,
                                         active boolean,
                                         created_by uuid,
                                         created_at timestamp with time zone,
                                         row_id integer NOT NULL DEFAULT nextval('variable_report_row_id_seq'::regclass),
                                         updated_by uuid,
                                         updated_at timestamp with time zone,
                                         code character varying,
                                         description character varying,
                                         frequency integer,
                                         name character varying,
                                         period character varying,
                                         reference_entity character varying,
                                         reference_id uuid,
                                         CONSTRAINT variable_reports_pkey PRIMARY KEY (id)
);
CREATE TABLE public.variable_templates (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           name character varying NOT NULL,
                                           code character varying,
                                           description text,
                                           data_type character varying NOT NULL CHECK (data_type::text = ANY (ARRAY['number'::character varying, 'string'::character varying, 'boolean'::character varying]::text[])),
  unit character varying,
  min_value numeric,
  max_value numeric,
  status character varying NOT NULL DEFAULT 'active'::character varying CHECK (status::text = ANY (ARRAY['active'::character varying, 'inactive'::character varying]::text[])),
  device_type_id uuid,
  category character varying,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  created_by uuid,
  updated_by uuid,
  row_id integer NOT NULL DEFAULT nextval('variable_template_row_id_seq'::regclass),
  CONSTRAINT variable_templates_pkey PRIMARY KEY (id),
  CONSTRAINT variable_template_device_type_id_fkey FOREIGN KEY (device_type_id) REFERENCES public.device_types(id)
);
CREATE TABLE public.variables (
                                  id uuid NOT NULL,
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('variable_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  a_value double precision,
                                  address_input integer,
                                  address_output integer,
                                  b_value double precision,
                                  bit_position integer,
                                  button_path character varying,
                                  code character varying,
                                  color character varying,
                                  decimal boolean,
                                  default_value character varying,
                                  delay character varying,
                                  delta character varying,
                                  description character varying,
                                  dimension integer,
                                  frequency character varying,
                                  func_type_read integer,
                                  func_type_write integer,
                                  function_code character varying,
                                  grp_category character varying,
                                  id_group integer,
                                  idhsvariable integer,
                                  image_off character varying,
                                  image_on character varying,
                                  insert_time timestamp with time zone,
                                  is_active boolean,
                                  is_cancelled boolean,
                                  ishaccp boolean,
                                  is_logged boolean,
                                  is_logic boolean,
                                  is_on_change boolean,
                                  last_update timestamp with time zone,
                                  length integer,
                                  maximum character varying,
                                  measure_unit character varying,
                                  minimum character varying,
                                  name character varying,
                                  rack_compressor_name character varying,
                                  read_only boolean,
                                  read_write integer,
                                  signed boolean,
                                  to_display character varying,
                                  type character varying,
                                  unit character varying,
                                  value character varying,
                                  var_encoding integer,
                                  variable_type character varying CHECK (variable_type::text = ANY (ARRAY['DIGITAL'::character varying::text, 'ANALOG'::character varying::text, 'INTEGER'::character varying::text, 'ALARM'::character varying::text, 'COMMAND'::character varying::text, 'UNDEFINED'::character varying::text])),
  working_time_variable_type character varying CHECK (working_time_variable_type::text = ANY (ARRAY['COMPRESSOR_STATUS'::character varying::text, 'DEFROST_STATUS'::character varying::text, 'ACTIVE_ENERGY_VARIABLE'::character varying::text, 'POWER_VARIABLE'::character varying::text, 'RACK_COMPRESSOR_VARIABLE'::character varying::text, 'RACK_DEFROST_VARIABLE'::character varying::text])),
  device_model_id uuid,
  origin_priority_id uuid,
  priority_id uuid,
  data_type character varying NOT NULL DEFAULT 'number'::character varying CHECK (data_type::text = ANY (ARRAY['number'::character varying, 'string'::character varying, 'boolean'::character varying]::text[])),
  min_value numeric,
  max_value numeric,
  status character varying NOT NULL DEFAULT 'active'::character varying CHECK (status::text = ANY (ARRAY['active'::character varying, 'inactive'::character varying]::text[])),
  time_series_enabled boolean,
  tenant_id uuid,
  CONSTRAINT variables_pkey PRIMARY KEY (id),
  CONSTRAINT fkgq2bb3tqkck60eih4qq6pj3f0 FOREIGN KEY (device_model_id) REFERENCES public.device_models(id),
  CONSTRAINT fkmp9k9gi94hsk5hrqjv4t72bn7 FOREIGN KEY (origin_priority_id) REFERENCES public.priorities(id),
  CONSTRAINT fkqpnd5new9tyu2hhb7s9ykh8bq FOREIGN KEY (priority_id) REFERENCES public.priorities(id),
  CONSTRAINT variables_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.vendors (
                                id uuid NOT NULL,
                                active boolean,
                                created_by uuid,
                                created_at timestamp with time zone,
                                row_id integer NOT NULL DEFAULT nextval('vendor_row_id_seq'::regclass),
                                updated_by uuid,
                                updated_at timestamp with time zone,
                                code character varying,
                                description character varying,
                                name character varying,
                                tenant_id uuid,
                                financial_id uuid UNIQUE,
                                CONSTRAINT vendors_pkey PRIMARY KEY (id),
                                CONSTRAINT fk4fnmpdx1mle6k9nwr5kte2afp FOREIGN KEY (financial_id) REFERENCES public.financials(id),
                                CONSTRAINT fkcs0sjhi06ivkgv5bgstqepqw2 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.weather_data_imports (
                                             id uuid NOT NULL DEFAULT gen_random_uuid(),
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('weather_data_imports_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             end_date date NOT NULL,
                                             error_count integer NOT NULL,
                                             error_message text,
                                             import_date timestamp with time zone NOT NULL,
                                             is_automated boolean NOT NULL,
                                             start_date date NOT NULL,
                                             status character varying NOT NULL CHECK (status::text = ANY (ARRAY['COMPLETED'::character varying, 'FAILED'::character varying, 'PARTIAL'::character varying]::text[])),
  success_count integer NOT NULL,
  unit_count integer NOT NULL,
  created_by_profile uuid DEFAULT gen_random_uuid(),
  CONSTRAINT weather_data_imports_pkey PRIMARY KEY (id),
  CONSTRAINT fk1okxlq3rneegoy2wyxrjfgjv4 FOREIGN KEY (created_by_profile) REFERENCES public.profiles(id)
);
CREATE TABLE public.weather_datas (
                                      id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('weather_data_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      city_id integer,
                                      city_name character varying,
                                      clouds integer,
                                      country_code character varying,
                                      date date NOT NULL,
                                      dt bigint,
                                      feels_like numeric,
                                      grnd_level numeric,
                                      humidity numeric,
                                      pressure numeric,
                                      sea_level numeric,
                                      sunrise bigint,
                                      sunset bigint,
                                      temperature numeric,
                                      temperature_max numeric,
                                      temperature_min numeric,
                                      timezone character varying,
                                      visibility integer,
                                      weather_description character varying,
                                      weather_icon character varying,
                                      weather_id integer,
                                      weather_main character varying,
                                      wind_deg integer,
                                      wind_speed numeric,
                                      temperature_reference_id uuid DEFAULT gen_random_uuid(),
                                      unit_id uuid NOT NULL DEFAULT gen_random_uuid(),
                                      CONSTRAINT weather_datas_pkey PRIMARY KEY (id),
                                      CONSTRAINT fkgax81qsd561ynas51ornbe4hl FOREIGN KEY (temperature_reference_id) REFERENCES public.temperature_reference_values(id),
                                      CONSTRAINT fkogws265dg26uw5ccxdwhmw0jb FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.work_flow_stage_maps (
                                             id uuid NOT NULL,
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('work_flow_stage_map_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             next_stage_id uuid,
                                             previous_stage_id uuid,
                                             CONSTRAINT work_flow_stage_maps_pkey PRIMARY KEY (id),
                                             CONSTRAINT fk5vk9ud1m4ol1i21suuu9clcl0 FOREIGN KEY (next_stage_id) REFERENCES public.workflow_stages(id),
                                             CONSTRAINT fk72iltdm1u9m4nvkmp3efl4ph1 FOREIGN KEY (previous_stage_id) REFERENCES public.workflow_stages(id)
);
CREATE TABLE public.work_request_characteristics (
                                                     id uuid NOT NULL DEFAULT uuid_generate_v4(),
                                                     active boolean,
                                                     created_by uuid,
                                                     created_at timestamp with time zone,
                                                     row_id integer NOT NULL DEFAULT nextval('work_request_characteristic_row_id_seq'::regclass),
                                                     updated_by uuid,
                                                     updated_at timestamp with time zone,
                                                     value text,
                                                     characteristic_id uuid,
                                                     work_request_id uuid,
                                                     CONSTRAINT work_request_characteristics_pkey PRIMARY KEY (id),
                                                     CONSTRAINT fkafp0i13mglxu52g0v3fiow5ox FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                                     CONSTRAINT fkpq7njmm9naqde6hoost7mjy2x FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id)
);
CREATE TABLE public.work_request_type_characteristics (
                                                          id uuid NOT NULL DEFAULT uuid_generate_v4(),
                                                          active boolean,
                                                          created_by uuid,
                                                          created_at timestamp with time zone,
                                                          row_id integer NOT NULL DEFAULT nextval('work_request_type_characteristic_row_id_seq'::regclass),
                                                          updated_by uuid,
                                                          updated_at timestamp with time zone,
                                                          value text,
                                                          characteristic_id uuid,
                                                          work_request_type_id uuid,
                                                          CONSTRAINT work_request_type_characteristics_pkey PRIMARY KEY (id),
                                                          CONSTRAINT fkm3k05kiwxcfx70ht0du83duov FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                                          CONSTRAINT fkrxjwxhjj6ce2rmak52q4pyore FOREIGN KEY (work_request_type_id) REFERENCES public.work_request_types(id)
);
CREATE TABLE public.work_request_type_templates (
                                                    id uuid NOT NULL DEFAULT gen_random_uuid(),
                                                    active boolean,
                                                    created_by uuid,
                                                    created_at timestamp with time zone,
                                                    row_id integer NOT NULL DEFAULT nextval('work_request_type_template_row_id_seq'::regclass),
                                                    updated_by uuid,
                                                    updated_at timestamp with time zone,
                                                    allowed_roles text,
                                                    code character varying NOT NULL UNIQUE,
                                                    default_value text,
                                                    grid_span integer,
                                                    is_required boolean,
                                                    is_visible_to_unauthorized boolean,
                                                    name character varying NOT NULL,
                                                    sort_order integer NOT NULL,
                                                    characteristic_id uuid DEFAULT gen_random_uuid(),
                                                    work_request_type_id uuid DEFAULT gen_random_uuid(),
                                                    CONSTRAINT work_request_type_templates_pkey PRIMARY KEY (id),
                                                    CONSTRAINT fk4s6fgaeyjv1wmy95pmkfcs6ig FOREIGN KEY (characteristic_id) REFERENCES public.characteristics(id),
                                                    CONSTRAINT fkl5axp9ww2r1fsu6rmno217mcc FOREIGN KEY (work_request_type_id) REFERENCES public.work_request_types(id)
);
CREATE TABLE public.work_request_types (
                                           id uuid NOT NULL,
                                           active boolean,
                                           created_by uuid,
                                           created_at timestamp with time zone,
                                           row_id integer NOT NULL DEFAULT nextval('work_request_type_row_id_seq'::regclass),
                                           updated_by uuid,
                                           updated_at timestamp with time zone,
                                           code character varying NOT NULL UNIQUE,
                                           description text,
                                           name character varying NOT NULL,
                                           tenant_id uuid,
                                           CONSTRAINT work_request_types_pkey PRIMARY KEY (id),
                                           CONSTRAINT fk9ns78yo0p7itg0dsai7wow5o5 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.work_requests (
                                      id uuid NOT NULL,
                                      active boolean,
                                      created_by uuid,
                                      created_at timestamp with time zone,
                                      row_id integer NOT NULL DEFAULT nextval('work_request_row_id_seq'::regclass),
                                      updated_by uuid,
                                      updated_at timestamp with time zone,
                                      address character varying,
                                      directions character varying,
                                      email character varying,
                                      fax character varying,
                                      first_name character varying,
                                      last_name character varying,
                                      phone character varying,
                                      town character varying,
                                      website character varying,
                                      description text,
                                      priority character varying CHECK (priority::text = ANY (ARRAY['LOW'::character varying::text, 'MEDIUM'::character varying::text, 'HIGH'::character varying::text, 'CRITICAL'::character varying::text, 'URGENT'::character varying::text, 'IMMEDIATE'::character varying::text, 'ASAP'::character varying::text, 'EMERGENCY'::character varying::text, 'STAT'::character varying::text, 'STANDARD'::character varying::text, 'ROUTINE'::character varying::text, 'REGULAR'::character varying::text])),
  reason character varying,
  status character varying CHECK (status::text = ANY (ARRAY['DRAFT'::character varying::text, 'PENDING_APPROVAL'::character varying::text, 'APPROVED'::character varying::text, 'IN_PROGRESS'::character varying::text, 'DONE'::character varying::text, 'REJECTED'::character varying::text])),
  subject character varying,
  tenant_id uuid,
  business_interaction_id uuid,
  organization_id uuid,
  contractor_id uuid,
  inventory_id uuid,
  location_id uuid,
  staff_id uuid,
  sub_contractor_id uuid,
  team_id uuid,
  unit_id uuid,
  work_request_type_id uuid,
  sprint_id uuid,
  city_id integer,
  country_id character varying,
  CONSTRAINT work_requests_pkey PRIMARY KEY (id),
  CONSTRAINT fk19ivlucuccw1i3i9po4mokyrm FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id),
  CONSTRAINT fk2r0srv04kfd5kscvak3eowkni FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
  CONSTRAINT fk3pugxo55h30usmco9rd80l056 FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
  CONSTRAINT fk5g3u65scb90o4clytafx1ddn5 FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id),
  CONSTRAINT fkbgp0aesb31eg92lhiahpkbg4p FOREIGN KEY (location_id) REFERENCES public.locations(id),
  CONSTRAINT fkfa7g2f6bqisf1kmxf8x3s3v0u FOREIGN KEY (inventory_id) REFERENCES public.inventories(id),
  CONSTRAINT fklhdvj6dqq25upld8numyqkqxk FOREIGN KEY (organization_id) REFERENCES public.organizations(id),
  CONSTRAINT fknf1nkwliykfwscx1miee0jut8 FOREIGN KEY (unit_id) REFERENCES public.units(id),
  CONSTRAINT fkqmj4oneac7tcxdsqe01llrbi4 FOREIGN KEY (team_id) REFERENCES public.teams(id),
  CONSTRAINT fkr69did3w0hms0n9y7ga26xeqd FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
  CONSTRAINT fke903h8w3oua6o1pmniugaip2e FOREIGN KEY (work_request_type_id) REFERENCES public.work_request_types(id),
  CONSTRAINT work_requests_city_id_fkey FOREIGN KEY (city_id) REFERENCES public.cities(id),
  CONSTRAINT work_requests_country_id_fkey FOREIGN KEY (country_id) REFERENCES public.countries(id)
);
CREATE TABLE public.workflow_contractors (
                                             id uuid NOT NULL,
                                             active boolean,
                                             created_by uuid,
                                             created_at timestamp with time zone,
                                             row_id integer NOT NULL DEFAULT nextval('workflow_contractor_row_id_seq'::regclass),
                                             updated_by uuid,
                                             updated_at timestamp with time zone,
                                             contractor_id uuid,
                                             workflow_work_request_id uuid,
                                             CONSTRAINT workflow_contractors_pkey PRIMARY KEY (id),
                                             CONSTRAINT fkal4nivmepsb0mrsxglcl6apvw FOREIGN KEY (contractor_id) REFERENCES public.contractors(id),
                                             CONSTRAINT fkm2qqy4iqhsu3im5dp4i3db0ie FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id)
);
CREATE TABLE public.workflow_executions (
                                            id uuid NOT NULL DEFAULT gen_random_uuid(),
                                            interaction_id uuid NOT NULL,
                                            status character varying NOT NULL CHECK (status::text = ANY (ARRAY['PENDING'::character varying, 'RUNNING'::character varying, 'COMPLETED'::character varying, 'FAILED'::character varying, 'CANCELLED'::character varying]::text[])),
  started_at timestamp with time zone NOT NULL DEFAULT now(),
  completed_at timestamp with time zone,
  duration_ms integer,
  started_by character varying NOT NULL,
  cancelled_by character varying,
  input_data jsonb,
  output_data jsonb,
  error_message text,
  error_stack text,
  tenant_id uuid NOT NULL,
  active boolean DEFAULT true,
  created_by uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_by uuid,
  updated_at timestamp with time zone DEFAULT now(),
  row_id integer NOT NULL DEFAULT nextval('workflow_execution_row_id_seq'::regclass),
  CONSTRAINT workflow_executions_pkey PRIMARY KEY (id),
  CONSTRAINT workflow_execution_interaction_fkey FOREIGN KEY (interaction_id) REFERENCES public.business_interactions(id),
  CONSTRAINT workflow_execution_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.workflow_histories (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           work_request_id uuid NOT NULL,
                                           from_status character varying,
                                           to_status character varying NOT NULL,
                                           changed_by uuid NOT NULL,
                                           change_reason text,
                                           metadata jsonb,
                                           created_at timestamp with time zone DEFAULT now(),
                                           tenant_id uuid,
                                           CONSTRAINT workflow_histories_pkey PRIMARY KEY (id),
                                           CONSTRAINT workflow_history_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.workflow_staffs (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('workflow_staff_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        staff_id uuid,
                                        workflow_work_request_id uuid,
                                        CONSTRAINT workflow_staffs_pkey PRIMARY KEY (id),
                                        CONSTRAINT fkhqm3wpnknjs99pj8qtuu8kqms FOREIGN KEY (staff_id) REFERENCES public.staffs(id),
                                        CONSTRAINT fkn9a2djwaedoi2p0yjkvl6ccps FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id)
);
CREATE TABLE public.workflow_stages (
                                        id uuid NOT NULL,
                                        active boolean,
                                        created_by uuid,
                                        created_at timestamp with time zone,
                                        row_id integer NOT NULL DEFAULT nextval('workflow_stage_row_id_seq'::regclass),
                                        updated_by uuid,
                                        updated_at timestamp with time zone,
                                        code character varying,
                                        description character varying,
                                        name character varying,
                                        tenant_id uuid,
                                        business_interaction_id uuid,
                                        workflow_work_request_id uuid,
                                        CONSTRAINT workflow_stages_pkey PRIMARY KEY (id),
                                        CONSTRAINT fkchqeqr3obxukpninoenhnfhjf FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
                                        CONSTRAINT fkirpd4c6s60wsp6jwf02f7nm45 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                        CONSTRAINT fknu0yu2c8gxsukpq740whdme5i FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id)
);
CREATE TABLE public.workflow_steps (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('workflow_step_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       code character varying,
                                       description character varying,
                                       done boolean,
                                       name character varying,
                                       order_code character varying,
                                       tenant_id uuid,
                                       business_step_id uuid,
                                       confirmation_id uuid,
                                       next_step_id uuid,
                                       payment_id uuid,
                                       workflow_stage_id uuid,
                                       CONSTRAINT workflow_steps_pkey PRIMARY KEY (id),
                                       CONSTRAINT fk93klj027mbwawmdgcupi2fy57 FOREIGN KEY (workflow_stage_id) REFERENCES public.workflow_stages(id),
                                       CONSTRAINT fk9eoiroqq8ltg7r1qaeu37mpnq FOREIGN KEY (payment_id) REFERENCES public.payments(id),
                                       CONSTRAINT fkhb7an06au10wi0dccemer7hak FOREIGN KEY (confirmation_id) REFERENCES public.confirmations(id),
                                       CONSTRAINT fkj0mnmyje7eqfpse8fwsvy6m5u FOREIGN KEY (next_step_id) REFERENCES public.workflow_steps(id),
                                       CONSTRAINT fkn4e42928qqqv96gesfr8yom6l FOREIGN KEY (business_step_id) REFERENCES public.business_steps(id),
                                       CONSTRAINT fkqrh4m7m4x9i9jxml9p3oydsd4 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.workflow_sub_contractors (
                                                 id uuid NOT NULL,
                                                 active boolean,
                                                 created_by uuid,
                                                 created_at timestamp with time zone,
                                                 row_id integer NOT NULL DEFAULT nextval('workflow_sub_contractor_row_id_seq'::regclass),
                                                 updated_by uuid,
                                                 updated_at timestamp with time zone,
                                                 sub_contractor_id uuid,
                                                 workflow_work_request_id uuid,
                                                 CONSTRAINT workflow_sub_contractors_pkey PRIMARY KEY (id),
                                                 CONSTRAINT fk4drr7g4yaifp05dq1c40chh23 FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
                                                 CONSTRAINT fke346n0mlaiti0jubm6isjfs67 FOREIGN KEY (sub_contractor_id) REFERENCES public.sub_contractors(id)
);
CREATE TABLE public.workflow_teams (
                                       id uuid NOT NULL,
                                       active boolean,
                                       created_by uuid,
                                       created_at timestamp with time zone,
                                       row_id integer NOT NULL DEFAULT nextval('workflow_team_row_id_seq'::regclass),
                                       updated_by uuid,
                                       updated_at timestamp with time zone,
                                       team_id uuid,
                                       workflow_work_request_id uuid,
                                       unit_id uuid,
                                       CONSTRAINT workflow_teams_pkey PRIMARY KEY (id),
                                       CONSTRAINT fk2gom4t3fosoyail7s38fyt3l9 FOREIGN KEY (team_id) REFERENCES public.teams(id),
                                       CONSTRAINT fk6d46mfnn1rq2nmofmtimo8h0v FOREIGN KEY (workflow_work_request_id) REFERENCES public.workflows(work_request_id),
                                       CONSTRAINT fkr9cgqqgbq31hxw82tf3i25hyd FOREIGN KEY (unit_id) REFERENCES public.units(id)
);
CREATE TABLE public.workflow_templates (
                                           id uuid NOT NULL DEFAULT gen_random_uuid(),
                                           name character varying NOT NULL,
                                           code character varying UNIQUE,
                                           description text,
                                           category character varying,
                                           snapshot jsonb NOT NULL,
                                           is_global boolean DEFAULT false,
                                           is_featured boolean DEFAULT false,
                                           usage_count integer DEFAULT 0,
                                           preview_image_url text,
                                           tags ARRAY,
                                           tenant_id uuid,
                                           created_by uuid NOT NULL,
                                           active boolean DEFAULT true,
                                           created_at timestamp with time zone DEFAULT now(),
                                           updated_by uuid,
                                           updated_at timestamp with time zone DEFAULT now(),
                                           row_id integer NOT NULL DEFAULT nextval('workflow_template_row_id_seq'::regclass),
                                           CONSTRAINT workflow_templates_pkey PRIMARY KEY (id),
                                           CONSTRAINT workflow_template_tenant_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);
CREATE TABLE public.workflow_versions (
                                          id uuid NOT NULL DEFAULT gen_random_uuid(),
                                          interaction_id uuid NOT NULL,
                                          version_number integer NOT NULL,
                                          version_name character varying,
                                          snapshot jsonb NOT NULL,
                                          is_active boolean DEFAULT false,
                                          is_published boolean DEFAULT false,
                                          change_summary text,
                                          created_by uuid NOT NULL,
                                          active boolean DEFAULT true,
                                          created_at timestamp with time zone DEFAULT now(),
                                          updated_by uuid,
                                          updated_at timestamp with time zone DEFAULT now(),
                                          row_id integer NOT NULL DEFAULT nextval('workflow_version_row_id_seq'::regclass),
                                          CONSTRAINT workflow_versions_pkey PRIMARY KEY (id),
                                          CONSTRAINT workflow_version_interaction_fkey FOREIGN KEY (interaction_id) REFERENCES public.business_interactions(id)
);
CREATE TABLE public.workflows (
                                  active boolean,
                                  created_by uuid,
                                  created_at timestamp with time zone,
                                  row_id integer NOT NULL DEFAULT nextval('workflow_row_id_seq'::regclass),
                                  updated_by uuid,
                                  updated_at timestamp with time zone,
                                  code character varying,
                                  description character varying,
                                  name character varying,
                                  title character varying,
                                  work_request_id uuid NOT NULL,
                                  tenant_id uuid,
                                  business_interaction_id uuid,
                                  project_work_request_id uuid,
                                  CONSTRAINT workflows_pkey PRIMARY KEY (work_request_id),
                                  CONSTRAINT fk1rnkrlu6tr8v89g9g6et6l489 FOREIGN KEY (tenant_id) REFERENCES public.tenants(id),
                                  CONSTRAINT fk4lwjjtcujxffr9a61j296vr8y FOREIGN KEY (project_work_request_id) REFERENCES public.projects(work_request_id),
                                  CONSTRAINT fkckwy2iohjbeiam9wxgxoogs60 FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
                                  CONSTRAINT fkm39a1jwiy2e2mgca43mxiq2ht FOREIGN KEY (business_interaction_id) REFERENCES public.business_interactions(id)
);
CREATE TABLE public.worklogs (
                                 id uuid NOT NULL DEFAULT gen_random_uuid(),
                                 description text NOT NULL,
                                 time_spent integer NOT NULL,
                                 work_request_id uuid NOT NULL,
                                 work_date date NOT NULL DEFAULT CURRENT_DATE,
                                 created_at timestamp with time zone DEFAULT now(),
                                 updated_at timestamp with time zone DEFAULT now(),
                                 created_by uuid,
                                 updated_by uuid,
                                 tenant_id uuid,
                                 CONSTRAINT worklogs_pkey PRIMARY KEY (id),
                                 CONSTRAINT worklog_work_request_id_fkey FOREIGN KEY (work_request_id) REFERENCES public.work_requests(id),
                                 CONSTRAINT worklogs_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id)
);